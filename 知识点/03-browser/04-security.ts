/**
 * ============================================================
 * ğŸ“š æµè§ˆå™¨å®‰å…¨
 * ============================================================
 *
 * é¢è¯•è€ƒå¯Ÿé‡ç‚¹ï¼š
 * 1. åŒæºç­–ç•¥
 * 2. XSS æ”»å‡»ä¸é˜²å¾¡
 * 3. CSRF æ”»å‡»ä¸é˜²å¾¡
 * 4. å…¶ä»–å®‰å…¨é—®é¢˜
 */

// ============================================================
// 1. åŒæºç­–ç•¥ï¼ˆSame-Origin Policyï¼‰
// ============================================================

/**
 * ğŸ“– ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥ï¼Ÿ
 *
 * åŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„å®‰å…¨åŸºçŸ³ï¼Œé™åˆ¶ä¸åŒæºçš„æ–‡æ¡£/è„šæœ¬ä¹‹é—´çš„äº¤äº’ã€‚
 *
 * åŒæºï¼šåè®® + åŸŸå + ç«¯å£ å®Œå…¨ç›¸åŒ
 *
 * https://www.example.com:443/path
 *   â”‚          â”‚           â”‚
 * åè®®       åŸŸå        ç«¯å£
 *
 * ğŸ“Š åŒæºåˆ¤æ–­ç¤ºä¾‹ï¼ˆç›¸å¯¹äº https://www.example.com/pageï¼‰
 *
 * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 * â”‚ URL                                 â”‚ æ˜¯å¦åŒæº  â”‚ åŸå›      â”‚
 * â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 * â”‚ https://www.example.com/other       â”‚ âœ… åŒæº  â”‚          â”‚
 * â”‚ http://www.example.com/page         â”‚ âŒ ä¸åŒæº â”‚ åè®®ä¸åŒ â”‚
 * â”‚ https://api.example.com/page        â”‚ âŒ ä¸åŒæº â”‚ åŸŸåä¸åŒ â”‚
 * â”‚ https://www.example.com:8080/page   â”‚ âŒ ä¸åŒæº â”‚ ç«¯å£ä¸åŒ â”‚
 * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 */

/**
 * ğŸ“Š åŒæºç­–ç•¥çš„é™åˆ¶
 *
 * 1. DOM è®¿é—®é™åˆ¶ï¼š
 *    - ä¸èƒ½è¯»å–è·¨åŸŸ iframe çš„ DOM
 *
 * 2. Cookie/Storage é™åˆ¶ï¼š
 *    - ä¸èƒ½è¯»å–è·¨åŸŸçš„ Cookieã€LocalStorage
 *
 * 3. AJAX é™åˆ¶ï¼š
 *    - ä¸èƒ½å‘è·¨åŸŸåœ°å€å‘é€ AJAX è¯·æ±‚ï¼ˆæˆ–è¯·æ±‚è¢«é˜»æ­¢å“åº”ï¼‰
 *
 * 4. ä¾‹å¤–ï¼ˆå¯è·¨åŸŸï¼‰ï¼š
 *    - <script src>
 *    - <link href>
 *    - <img src>
 *    - <video> / <audio>
 *    - <iframe>ï¼ˆå¯åŠ è½½ï¼Œä½†ä¸èƒ½æ“ä½œ DOMï¼‰
 *    - @font-face
 */

/**
 * ğŸ“Š è·¨åŸŸè§£å†³æ–¹æ¡ˆ
 *
 * 1. CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰- æ¨è
 * 2. JSONP
 * 3. ä»£ç†æœåŠ¡å™¨
 * 4. postMessage
 * 5. WebSocket
 * 6. document.domainï¼ˆå·²åºŸå¼ƒï¼‰
 */

// ============================================================
// 2. CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰
// ============================================================

/**
 * ğŸ“– CORS å·¥ä½œåŸç†
 *
 * CORS é€šè¿‡ HTTP å“åº”å¤´å‘Šè¯‰æµè§ˆå™¨æ˜¯å¦å…è®¸è·¨åŸŸè¯·æ±‚ã€‚
 *
 * ğŸ“Š ç®€å•è¯·æ±‚ vs é¢„æ£€è¯·æ±‚
 *
 * ç®€å•è¯·æ±‚æ¡ä»¶ï¼ˆåŒæ—¶æ»¡è¶³ï¼‰ï¼š
 * - æ–¹æ³•ï¼šGETã€POSTã€HEAD
 * - å¤´éƒ¨ï¼šAcceptã€Accept-Languageã€Content-Languageã€Content-Type
 * - Content-Typeï¼štext/plainã€multipart/form-dataã€application/x-www-form-urlencoded
 *
 * ä¸æ»¡è¶³æ¡ä»¶çš„æ˜¯é¢„æ£€è¯·æ±‚ï¼ˆPreflightï¼‰
 */

/**
 * ğŸ“Š ç®€å•è¯·æ±‚æµç¨‹
 *
 * æµè§ˆå™¨                              æœåŠ¡å™¨
 *   â”‚                                   â”‚
 *   â”‚  GET /api/data                    â”‚
 *   â”‚  Origin: https://example.com      â”‚
 *   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 *   â”‚                                   â”‚
 *   â”‚  200 OK                           â”‚
 *   â”‚  Access-Control-Allow-Origin: *   â”‚
 *   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
 *   â”‚                                   â”‚
 */

/**
 * ğŸ“Š é¢„æ£€è¯·æ±‚æµç¨‹
 *
 * æµè§ˆå™¨                              æœåŠ¡å™¨
 *   â”‚                                   â”‚
 *   â”‚  OPTIONS /api/data                â”‚ â† é¢„æ£€è¯·æ±‚
 *   â”‚  Origin: https://example.com      â”‚
 *   â”‚  Access-Control-Request-Method: PUTâ”‚
 *   â”‚  Access-Control-Request-Headers: X-Customâ”‚
 *   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 *   â”‚                                   â”‚
 *   â”‚  200 OK                           â”‚ â† é¢„æ£€å“åº”
 *   â”‚  Access-Control-Allow-Origin: https://example.com
 *   â”‚  Access-Control-Allow-Methods: PUT, POST, GET
 *   â”‚  Access-Control-Allow-Headers: X-Custom
 *   â”‚  Access-Control-Max-Age: 86400    â”‚ â† é¢„æ£€ç»“æœç¼“å­˜
 *   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
 *   â”‚                                   â”‚
 *   â”‚  PUT /api/data                    â”‚ â† å®é™…è¯·æ±‚
 *   â”‚  Origin: https://example.com      â”‚
 *   â”‚  X-Custom: value                  â”‚
 *   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 *   â”‚                                   â”‚
 *   â”‚  200 OK                           â”‚
 *   â”‚  Access-Control-Allow-Origin: https://example.com
 *   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
 */

/**
 * ğŸ“Š CORS å“åº”å¤´
 *
 * - Access-Control-Allow-Origin: * | <origin>
 * - Access-Control-Allow-Methods: GET, POST, PUT, DELETE
 * - Access-Control-Allow-Headers: X-Custom, Content-Type
 * - Access-Control-Allow-Credentials: trueï¼ˆå…è®¸æºå¸¦ Cookieï¼‰
 * - Access-Control-Expose-Headers: X-Customï¼ˆæš´éœ²è‡ªå®šä¹‰å“åº”å¤´ï¼‰
 * - Access-Control-Max-Age: 86400ï¼ˆé¢„æ£€ç»“æœç¼“å­˜æ—¶é—´ï¼‰
 *
 * æ³¨æ„ï¼š
 * - Allow-Origin ä¸º * æ—¶ï¼Œä¸èƒ½æºå¸¦ Cookie
 * - éœ€è¦æºå¸¦ Cookie æ—¶ï¼Œå¿…é¡»æŒ‡å®šå…·ä½“çš„ Origin
 */

// ============================================================
// 3. XSSï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰
// ============================================================

/**
 * ğŸ“– ä»€ä¹ˆæ˜¯ XSSï¼Ÿ
 *
 * XSSï¼ˆCross-Site Scriptingï¼‰ï¼šæ”»å‡»è€…åœ¨ç½‘é¡µä¸­æ³¨å…¥æ¶æ„è„šæœ¬ï¼Œ
 * å½“ç”¨æˆ·è®¿é—®æ—¶æ‰§è¡Œï¼Œçªƒå–ç”¨æˆ·ä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œã€‚
 *
 * ğŸ“Š XSS ç±»å‹
 *
 * 1. å­˜å‚¨å‹ XSSï¼ˆæœ€å±é™©ï¼‰
 *    - æ¶æ„è„šæœ¬å­˜å‚¨åœ¨æœåŠ¡å™¨ï¼ˆæ•°æ®åº“ï¼‰
 *    - ç”¨æˆ·è®¿é—®é¡µé¢æ—¶ä»æœåŠ¡å™¨è·å–å¹¶æ‰§è¡Œ
 *    - åœºæ™¯ï¼šè¯„è®ºã€æ–‡ç« ã€ç”¨æˆ·èµ„æ–™
 *
 * 2. åå°„å‹ XSS
 *    - æ¶æ„è„šæœ¬åœ¨ URL å‚æ•°ä¸­
 *    - æœåŠ¡å™¨å°†å‚æ•°ç›´æ¥è¿”å›é¡µé¢
 *    - åœºæ™¯ï¼šæœç´¢ç»“æœã€é”™è¯¯æ¶ˆæ¯
 *
 * 3. DOM å‹ XSS
 *    - å‰ç«¯ JS ç›´æ¥å°†ä¸å¯ä¿¡æ•°æ®æ’å…¥ DOM
 *    - ä¸ç»è¿‡æœåŠ¡å™¨
 *    - åœºæ™¯ï¼šinnerHTMLã€document.writeã€eval
 */

/**
 * ğŸ“Š XSS æ”»å‡»ç¤ºä¾‹
 */

// å­˜å‚¨å‹ XSS
// æ”»å‡»è€…æäº¤è¯„è®ºï¼š<script>steal(document.cookie)</script>
// å…¶ä»–ç”¨æˆ·æŸ¥çœ‹è¯„è®ºæ—¶ï¼Œè„šæœ¬æ‰§è¡Œ

// åå°„å‹ XSS
// æ”»å‡»è€…æ„é€ é“¾æ¥ï¼šhttps://example.com/search?q=<script>alert(1)</script>
// æœåŠ¡å™¨è¿”å›ï¼šæœç´¢ç»“æœï¼š<script>alert(1)</script>

// DOM å‹ XSS
// const query = new URLSearchParams(location.search).get('q');
// document.getElementById('result').innerHTML = query;
// æ”»å‡»è€…æ„é€ ï¼š?q=<img src=x onerror=alert(1)>

/**
 * ğŸ“Š XSS é˜²å¾¡æ–¹æ¡ˆ
 */

// 1. è¾“å…¥éªŒè¯å’Œè¿‡æ»¤
function sanitizeInput(input: string): string {
  // ç™½åå•éªŒè¯
  return input.replace(/[^a-zA-Z0-9\s]/g, '');
}

// 2. è¾“å‡ºç¼–ç ï¼ˆHTML å®ä½“ç¼–ç ï¼‰
function escapeHtml(str: string): string {
  const escapeMap: Record<string, string> = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#x27;',
    '/': '&#x2F;',
  };
  return str.replace(/[&<>"'/]/g, (char) => escapeMap[char]);
}

// 3. ä½¿ç”¨å®‰å…¨çš„ API
// âŒ å±é™©
// element.innerHTML = userInput;
// document.write(userInput);
// eval(userInput);

// âœ… å®‰å…¨
// element.textContent = userInput;
// element.setAttribute('value', userInput);

// 4. CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰
const cspExample = `
  <!-- HTTP å“åº”å¤´ -->
  Content-Security-Policy: 
    default-src 'self';                    // åªå…è®¸åŒæºèµ„æº
    script-src 'self' 'nonce-abc123';      // è„šæœ¬éœ€è¦ nonce
    style-src 'self' 'unsafe-inline';       // å…è®¸å†…è”æ ·å¼
    img-src *;                              // å›¾ç‰‡å¯ä»ä»»æ„æ¥æº
    connect-src 'self' https://api.example.com;  // AJAX é™åˆ¶
  
  <!-- HTML æ ‡ç­¾ -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'">
  
  <!-- å¸¦ nonce çš„è„šæœ¬ -->
  <script nonce="abc123">
    // è¿™ä¸ªè„šæœ¬å¯ä»¥æ‰§è¡Œ
  </script>
`;

// 5. HttpOnly Cookie
// è®¾ç½® HttpOnly çš„ Cookie ä¸èƒ½è¢« JavaScript è®¿é—®
// Set-Cookie: session=xxx; HttpOnly; Secure; SameSite=Strict

// ============================================================
// 4. CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰
// ============================================================

/**
 * ğŸ“– ä»€ä¹ˆæ˜¯ CSRFï¼Ÿ
 *
 * CSRFï¼ˆCross-Site Request Forgeryï¼‰ï¼šæ”»å‡»è€…è¯±å¯¼ç”¨æˆ·åœ¨å·²ç™»å½•çš„ç½‘ç«™ä¸Š
 * æ‰§è¡Œéé¢„æœŸçš„æ“ä½œã€‚
 *
 * ğŸ“Š CSRF æ”»å‡»æµç¨‹
 *
 * 1. ç”¨æˆ·ç™»å½•äº† bank.comï¼Œæµè§ˆå™¨ä¿å­˜äº† Cookie
 * 2. ç”¨æˆ·è®¿é—®æ¶æ„ç½‘ç«™ evil.com
 * 3. evil.com å‘ bank.com/transfer å‘èµ·è¯·æ±‚
 * 4. æµè§ˆå™¨è‡ªåŠ¨æºå¸¦ bank.com çš„ Cookie
 * 5. bank.com è®¤ä¸ºæ˜¯ç”¨æˆ·æ“ä½œï¼Œæ‰§è¡Œè½¬è´¦
 *
 *    ç”¨æˆ·æµè§ˆå™¨
 *        â”‚
 *   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
 *   â–¼         â–¼
 * bank.com  evil.com
 *   â”‚         â”‚
 *   â”‚         â”‚ <img src="bank.com/transfer?to=hacker&amount=1000">
 *   â”‚         â”‚
 *   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜ è‡ªåŠ¨å‘èµ·è¯·æ±‚ï¼Œæºå¸¦ Cookie
 *   â”‚
 *   â–¼
 * æ‰§è¡Œè½¬è´¦ ğŸ˜±
 */

/**
 * ğŸ“Š CSRF é˜²å¾¡æ–¹æ¡ˆ
 */

// 1. SameSite Cookie
const sameSiteCookie = `
  Set-Cookie: session=xxx; SameSite=Strict
  // Strict: å®Œå…¨ç¦æ­¢ç¬¬ä¸‰æ–¹ç½‘ç«™å‘é€
  // Lax: å…è®¸éƒ¨åˆ†å®‰å…¨è¯·æ±‚ï¼ˆGET é“¾æ¥ï¼‰
  // None: ä¸é™åˆ¶ï¼ˆéœ€è¦ Secureï¼‰
`;

// 2. CSRF Token
const csrfToken = `
  <!-- æœåŠ¡å™¨ç”Ÿæˆ tokenï¼ŒåµŒå…¥è¡¨å• -->
  <form action="/transfer" method="POST">
    <input type="hidden" name="csrf_token" value="random-token-123">
    <input type="text" name="amount">
    <button type="submit">è½¬è´¦</button>
  </form>
  
  // æœåŠ¡å™¨éªŒè¯ token æ˜¯å¦æœ‰æ•ˆ
  // æ”»å‡»è€…æ— æ³•è·å– tokenï¼Œè¯·æ±‚ä¼šå¤±è´¥
`;

// 3. éªŒè¯ Referer/Origin
const refererCheck = `
  // æœåŠ¡å™¨æ£€æŸ¥è¯·æ±‚æ¥æº
  const referer = req.headers.referer;
  const origin = req.headers.origin;
  
  if (!referer?.startsWith('https://bank.com') &&
      !origin?.startsWith('https://bank.com')) {
    return res.status(403).send('CSRF detected');
  }
`;

// 4. åŒé‡ Cookie éªŒè¯
const doubleCookie = `
  // æœåŠ¡å™¨è®¾ç½® Cookie
  Set-Cookie: csrf=random-value
  
  // å‰ç«¯è¯·æ±‚æ—¶ï¼Œå°† Cookie å€¼æ”¾å…¥è¯·æ±‚å¤´
  fetch('/api', {
    headers: {
      'X-CSRF-Token': getCookie('csrf')
    }
  })
  
  // æœåŠ¡å™¨éªŒè¯ Cookie å’Œ Header æ˜¯å¦åŒ¹é…
  // æ”»å‡»è€…æ— æ³•è¯»å– Cookieï¼Œæ— æ³•è®¾ç½®æ­£ç¡®çš„ Header
`;

// ============================================================
// 5. å…¶ä»–å®‰å…¨é—®é¢˜
// ============================================================

/**
 * ğŸ“Š ç‚¹å‡»åŠ«æŒï¼ˆClickjackingï¼‰
 *
 * æ”»å‡»æ–¹å¼ï¼š
 * - å°†ç›®æ ‡ç½‘ç«™åµŒå…¥é€æ˜ iframe
 * - è¯±å¯¼ç”¨æˆ·ç‚¹å‡»ï¼Œå®é™…ç‚¹å‡»çš„æ˜¯ iframe ä¸­çš„æŒ‰é’®
 *
 * é˜²å¾¡ï¼š
 * - X-Frame-Options: DENY / SAMEORIGIN
 * - CSP: frame-ancestors 'none'
 */

/**
 * ğŸ“Š ä¸­é—´äººæ”»å‡»ï¼ˆMITMï¼‰
 *
 * æ”»å‡»æ–¹å¼ï¼š
 * - æ”»å‡»è€…åœ¨ç”¨æˆ·å’ŒæœåŠ¡å™¨ä¹‹é—´æ‹¦æˆª/ç¯¡æ”¹æ•°æ®
 *
 * é˜²å¾¡ï¼š
 * - ä½¿ç”¨ HTTPS
 * - HSTSï¼ˆå¼ºåˆ¶ HTTPSï¼‰
 * - è¯ä¹¦é”å®š
 */

/**
 * ğŸ“Š å®‰å…¨å“åº”å¤´
 */
const securityHeaders = `
  // é˜²æ­¢ç‚¹å‡»åŠ«æŒ
  X-Frame-Options: DENY
  
  // ç¦æ­¢ MIME ç±»å‹å—…æ¢
  X-Content-Type-Options: nosniff
  
  // å¯ç”¨ XSS è¿‡æ»¤å™¨ï¼ˆå·²åºŸå¼ƒï¼Œç”¨ CSP æ›¿ä»£ï¼‰
  X-XSS-Protection: 1; mode=block
  
  // å¼ºåˆ¶ HTTPS
  Strict-Transport-Security: max-age=31536000; includeSubDomains
  
  // æ§åˆ¶ Referer
  Referrer-Policy: strict-origin-when-cross-origin
  
  // æƒé™ç­–ç•¥
  Permissions-Policy: geolocation=(), microphone=()
`;

// ============================================================
// 6. é«˜é¢‘é¢è¯•é¢˜
// ============================================================

/**
 * é¢˜ç›® 1ï¼šä»€ä¹ˆæ˜¯åŒæºç­–ç•¥ï¼Ÿå¦‚ä½•è·¨åŸŸï¼Ÿ
 *
 * åŒæºç­–ç•¥ï¼šé™åˆ¶ä¸åŒæºçš„æ–‡æ¡£/è„šæœ¬äº¤äº’ã€‚
 * åŒæº = åè®® + åŸŸå + ç«¯å£ ç›¸åŒ
 *
 * è·¨åŸŸæ–¹æ¡ˆï¼š
 * 1. CORSï¼šæœåŠ¡å™¨è®¾ç½® Access-Control-Allow-Origin
 * 2. JSONPï¼šåˆ©ç”¨ script æ ‡ç­¾ï¼ˆåªæ”¯æŒ GETï¼‰
 * 3. ä»£ç†æœåŠ¡å™¨ï¼šåŒæºæœåŠ¡å™¨è½¬å‘è¯·æ±‚
 * 4. postMessageï¼šçª—å£é—´é€šä¿¡
 * 5. WebSocketï¼šæ²¡æœ‰åŒæºé™åˆ¶
 */

/**
 * é¢˜ç›® 2ï¼šXSS å’Œ CSRF çš„åŒºåˆ«ï¼Ÿ
 *
 * XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰ï¼š
 * - æ³¨å…¥æ¶æ„è„šæœ¬åˆ°é¡µé¢
 * - è„šæœ¬åœ¨ç”¨æˆ·æµè§ˆå™¨æ‰§è¡Œ
 * - çªƒå–ä¿¡æ¯ã€åŠ«æŒä¼šè¯
 * - é˜²å¾¡ï¼šè¾“å…¥éªŒè¯ã€è¾“å‡ºç¼–ç ã€CSP
 *
 * CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰ï¼š
 * - è¯±å¯¼ç”¨æˆ·å‘èµ·éé¢„æœŸè¯·æ±‚
 * - åˆ©ç”¨ç”¨æˆ·å·²ç™»å½•çš„èº«ä»½
 * - æ‰§è¡Œéé¢„æœŸæ“ä½œ
 * - é˜²å¾¡ï¼šCSRF Tokenã€SameSite Cookieã€éªŒè¯æ¥æº
 */

/**
 * é¢˜ç›® 3ï¼šå¦‚ä½•é˜²èŒƒ XSS æ”»å‡»ï¼Ÿ
 *
 * 1. è¾“å…¥éªŒè¯ï¼šç™½åå•è¿‡æ»¤
 * 2. è¾“å‡ºç¼–ç ï¼šHTML å®ä½“ç¼–ç 
 * 3. å®‰å…¨ APIï¼štextContent ä»£æ›¿ innerHTML
 * 4. CSPï¼šé™åˆ¶è„šæœ¬æ¥æº
 * 5. HttpOnly Cookieï¼šé˜²æ­¢ JS è®¿é—®
 * 6. æ¡†æ¶è‡ªåŠ¨è½¬ä¹‰ï¼šReactã€Vue ç­‰
 */

/**
 * é¢˜ç›® 4ï¼šCORS ç®€å•è¯·æ±‚å’Œé¢„æ£€è¯·æ±‚çš„åŒºåˆ«ï¼Ÿ
 *
 * ç®€å•è¯·æ±‚ï¼š
 * - GET/POST/HEAD
 * - åªæœ‰ç®€å•å¤´éƒ¨
 * - ç›´æ¥å‘é€è¯·æ±‚
 *
 * é¢„æ£€è¯·æ±‚ï¼š
 * - å…¶ä»–æ–¹æ³•ï¼ˆPUTã€DELETEï¼‰
 * - è‡ªå®šä¹‰å¤´éƒ¨
 * - å…ˆå‘ OPTIONS è¯·æ±‚
 * - æœåŠ¡å™¨å…è®¸åå†å‘å®é™…è¯·æ±‚
 */

export {
  escapeHtml,
  sanitizeInput,
  cspExample,
  sameSiteCookie,
  securityHeaders,
};

