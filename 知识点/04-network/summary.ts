/**
 * ============================================================
 * 📚 网络协议 - 高频面试题汇总
 * ============================================================
 *
 * 按照面试频率和难度进行分类
 * 包含常见追问和易错点
 */

// ============================================================
// 🔥🔥🔥 高频必考题
// ============================================================

/**
 * 1. TCP 三次握手、四次挥手？为什么？
 *
 * 三次握手：
 * 1. 客户端 → SYN → 服务端
 * 2. 服务端 → SYN+ACK → 客户端
 * 3. 客户端 → ACK → 服务端
 *
 * 为什么三次：
 * - 确认双方收发能力正常
 * - 防止失效的连接请求被接受
 *
 * 四次挥手：
 * 1. 客户端 → FIN → 服务端（我要关了）
 * 2. 服务端 → ACK → 客户端（收到，等我发完）
 * 3. 服务端 → FIN → 客户端（我也关了）
 * 4. 客户端 → ACK → 服务端（好的）
 *
 * 为什么四次：
 * - TCP 是全双工，需要双方都同意关闭
 * - 服务端可能还有数据要发
 *
 * ⚠️ 易错点：
 * - 三次握手中第三次 ACK 可以携带数据
 * - TIME_WAIT 状态是在主动关闭方
 *
 * 💡 追问：为什么 TIME_WAIT 要等 2MSL？
 * - 确保最后一个 ACK 能到达服务端
 * - 确保旧连接的包都消失
 */

/**
 * 2. HTTP/1.1、HTTP/2、HTTP/3 的区别？
 *
 * HTTP/1.1：
 * - 持久连接（Keep-Alive）
 * - 管道化（但有队头阻塞）
 * - Host 头部，支持虚拟主机
 *
 * HTTP/2：
 * - 二进制分帧
 * - 多路复用（解决 HTTP 层队头阻塞）
 * - 头部压缩（HPACK）
 * - 服务器推送
 *
 * HTTP/3：
 * - 基于 QUIC（UDP）
 * - 彻底解决队头阻塞
 * - 0-RTT 连接建立
 * - 连接迁移
 *
 * ⚠️ 易错点：
 * - HTTP/2 多路复用不是并行执行，是交替传输
 * - HTTP/2 仍有 TCP 层队头阻塞
 * - HTTP/3 的可靠性在 QUIC 层实现
 *
 * 💡 追问：为什么 HTTP/2 还有队头阻塞？
 * - TCP 是有序可靠传输
 * - 一个包丢失，后续包都要等待重传
 */

/**
 * 3. HTTPS 加密原理？TLS 握手过程？
 *
 * 加密方式：混合加密
 * - 非对称加密交换密钥
 * - 对称加密传输数据
 *
 * TLS 1.2 握手（2-RTT）：
 * 1. ClientHello（支持的协议、加密套件）
 * 2. ServerHello + Certificate
 * 3. ClientKeyExchange（加密的预主密钥）
 * 4. ChangeCipherSpec + Finished
 *
 * TLS 1.3 握手（1-RTT）：
 * 1. ClientHello + 密钥共享
 * 2. ServerHello + 加密的证书
 * 3. Finished
 *
 * ⚠️ 易错点：
 * - HTTPS 不是加密整个 URL，域名是明文（SNI）
 * - 证书只验证服务器身份，不加密数据
 *
 * 💡 追问：什么是前向保密？
 * - 即使私钥泄露，也无法解密历史通信
 * - 使用临时密钥交换（ECDHE）
 */

/**
 * 4. 强缓存和协商缓存的区别？
 *
 * 强缓存：
 * - 不发请求，直接用缓存
 * - Expires（绝对时间，HTTP/1.0）
 * - Cache-Control: max-age（相对时间）
 * - 返回 200 (from cache)
 *
 * 协商缓存：
 * - 发请求问服务器是否可用
 * - Last-Modified / If-Modified-Since
 * - ETag / If-None-Match
 * - 返回 304 或 200
 *
 * ⚠️ 易错点：
 * - no-cache 不是不缓存，是强制协商
 * - no-store 才是不缓存
 * - ETag 优先级高于 Last-Modified
 *
 * 💡 追问：如何实现强制刷新？
 * - Ctrl+F5 会跳过缓存
 * - Cache-Control: no-cache, max-age=0
 */

/**
 * 5. 跨域问题？CORS 如何解决？
 *
 * 同源策略：协议 + 域名 + 端口 相同
 *
 * CORS 简单请求：
 * - GET/HEAD/POST
 * - 无自定义头
 * - Content-Type 限于三种
 *
 * CORS 预检请求：
 * - 不满足简单请求条件
 * - 先发 OPTIONS 请求
 * - 服务端返回允许的方法/头部
 *
 * ⚠️ 易错点：
 * - withCredentials 时 Allow-Origin 不能是 *
 * - 预检请求可以被缓存（Max-Age）
 * - CORS 是浏览器行为，服务器之间无跨域
 *
 * 💡 追问：如何减少预检请求？
 * - 使用简单请求
 * - 设置 Access-Control-Max-Age 缓存
 */

// ============================================================
// 🔥🔥 进阶深入题
// ============================================================

/**
 * 6. GET 和 POST 的区别？
 *
 * 语义区别：
 * - GET：获取资源，幂等，可缓存
 * - POST：提交数据，非幂等，不缓存
 *
 * 实现区别：
 * - GET 参数在 URL，POST 在请求体
 * - GET 有长度限制（URL 限制）
 * - GET 可书签/回退，POST 会重新提交
 *
 * ⚠️ 易错点：
 * - 技术上 GET 也可以有请求体
 * - POST 也可以把参数放 URL
 * - 安全性不是本质区别（都是明文）
 *
 * 💡 追问：POST 发两个 TCP 包的说法对吗？
 * - 某些浏览器确实会先发 header 再发 body
 * - 但这不是 HTTP 规范，是实现差异
 */

/**
 * 7. HTTP 状态码有哪些？
 *
 * 1xx 信息：100 Continue, 101 Switching Protocols
 * 2xx 成功：200 OK, 201 Created, 204 No Content
 * 3xx 重定向：301 永久, 302 临时, 304 未修改, 307/308
 * 4xx 客户端错误：400 Bad Request, 401, 403, 404, 429
 * 5xx 服务器错误：500, 502 Bad Gateway, 503, 504 Timeout
 *
 * ⚠️ 易错点：
 * - 301 会改变请求方法（POST→GET），308 不会
 * - 401 是未认证，403 是已认证但无权限
 * - 502 是网关错误，504 是网关超时
 *
 * 💡 追问：301 和 302 的区别？
 * - 301 永久重定向，浏览器会缓存
 * - 302 临时重定向，每次都要请求原地址
 */

/**
 * 8. WebSocket 原理？和 HTTP 的区别？
 *
 * 原理：
 * - 通过 HTTP Upgrade 升级协议
 * - 建立 TCP 长连接
 * - 双向通信
 *
 * 区别：
 * - HTTP：请求-响应，单向
 * - WebSocket：持久连接，双向
 *
 * ⚠️ 易错点：
 * - WebSocket 是独立协议，不是 HTTP
 * - WebSocket 没有同源限制
 * - 需要心跳保持连接
 *
 * 💡 追问：WebSocket 断线如何处理？
 * - 监听 close/error 事件
 * - 指数退避重连
 * - 心跳检测连接状态
 */

/**
 * 9. DNS 解析过程？
 *
 * 1. 浏览器缓存
 * 2. 系统缓存（hosts 文件）
 * 3. 路由器缓存
 * 4. ISP DNS 服务器
 * 5. 根 DNS → 顶级 DNS → 权威 DNS
 *
 * ⚠️ 易错点：
 * - DNS 查询可能是递归或迭代
 * - TTL 控制缓存时间
 * - DNS 默认用 UDP，大数据用 TCP
 *
 * 💡 追问：如何优化 DNS？
 * - DNS 预解析：<link rel="dns-prefetch">
 * - 减少域名数量
 * - 使用 CDN
 */

/**
 * 10. CDN 工作原理？
 *
 * 1. 用户请求域名
 * 2. DNS 返回最近的 CDN 节点 IP
 * 3. CDN 节点有缓存直接返回
 * 4. 没有缓存则回源拉取
 *
 * ⚠️ 易错点：
 * - CDN 只适合静态资源
 * - 动态内容用动态加速（优化链路）
 * - 缓存刷新有延迟
 *
 * 💡 追问：CDN 缓存和浏览器缓存的关系？
 * - s-maxage 控制 CDN 缓存
 * - max-age 控制浏览器缓存
 * - 可以设置不同的时间
 */

// ============================================================
// 📝 场景题
// ============================================================

/**
 * 题目 1：设计一个接口缓存策略
 *
 * HTML 文件：
 * Cache-Control: no-cache（协商缓存）
 * 原因：入口文件需要保持最新
 *
 * CSS/JS（带哈希）：
 * Cache-Control: max-age=31536000, immutable
 * 原因：文件名变了就是新文件
 *
 * 图片：
 * Cache-Control: max-age=86400（一天）
 * 或带哈希用长期缓存
 *
 * API：
 * - 实时数据：no-store
 * - 列表数据：max-age=60（短期缓存）
 * - 配置数据：max-age=3600（较长缓存）
 */

/**
 * 题目 2：如何优化接口性能？
 *
 * 减少请求：
 * - 合并请求
 * - 使用缓存
 * - 预加载/懒加载
 *
 * 减少传输：
 * - 开启 Gzip/Brotli
 * - 按需返回字段
 * - 分页加载
 *
 * 加快响应：
 * - 使用 CDN
 * - 升级 HTTP/2
 * - 服务端优化
 *
 * 用户体验：
 * - 乐观更新
 * - 骨架屏
 * - 错误重试
 */

/**
 * 题目 3：如何保证接口安全？
 *
 * 传输安全：
 * - 使用 HTTPS
 * - 敏感数据加密
 *
 * 认证授权：
 * - Token 认证
 * - 权限校验
 * - 接口签名
 *
 * 防攻击：
 * - 防 XSS：输入过滤
 * - 防 CSRF：Token + SameSite
 * - 防重放：时间戳 + nonce
 * - 限流：令牌桶/漏桶
 */

// ============================================================
// 🎯 资深面试追问清单
// ============================================================

/**
 * 追问 1：HTTP/2 的 Server Push 为什么用得少？
 *
 * - 难以判断客户端是否已有缓存
 * - 可能推送用户不需要的资源
 * - 配置复杂
 * - 已有替代方案（preload、prefetch）
 * - Chrome 已移除 Server Push 支持
 */

/**
 * 追问 2：QUIC 为什么基于 UDP？
 *
 * - TCP 在内核实现，难以修改
 * - UDP 灵活，可以在用户空间实现可靠性
 * - 避免 TCP 的队头阻塞
 * - 可以快速迭代协议
 */

/**
 * 追问 3：如何防止重放攻击？
 *
 * - 时间戳：请求有效期
 * - Nonce：一次性随机数
 * - 服务端记录已使用的 nonce
 * - 签名：timestamp + nonce + params
 */

/**
 * 追问 4：接口幂等性如何保证？
 *
 * 天然幂等：GET、PUT、DELETE
 *
 * POST 保证幂等：
 * - 唯一标识（clientId）
 * - 数据库唯一约束
 * - 分布式锁
 * - Token 机制（获取 Token → 使用 Token）
 */

// ============================================================
// 📋 面试准备 Checklist
// ============================================================

/**
 * ✅ TCP/IP
 *    - [ ] 三次握手四次挥手
 *    - [ ] 为什么是三次/四次
 *    - [ ] TIME_WAIT 作用
 *
 * ✅ HTTP
 *    - [ ] 请求/响应报文结构
 *    - [ ] 常见状态码及含义
 *    - [ ] HTTP/1.1 → HTTP/2 → HTTP/3 演进
 *    - [ ] 队头阻塞问题
 *
 * ✅ HTTPS
 *    - [ ] 加密原理（混合加密）
 *    - [ ] TLS 握手过程
 *    - [ ] 证书验证
 *    - [ ] 前向保密
 *
 * ✅ 缓存
 *    - [ ] 强缓存 vs 协商缓存
 *    - [ ] Cache-Control 指令
 *    - [ ] ETag vs Last-Modified
 *    - [ ] 缓存策略设计
 *
 * ✅ 跨域
 *    - [ ] 同源策略
 *    - [ ] CORS 原理
 *    - [ ] 简单请求 vs 预检请求
 *    - [ ] 跨域解决方案
 *
 * ✅ 实时通信
 *    - [ ] WebSocket 原理
 *    - [ ] SSE vs WebSocket
 *    - [ ] 心跳重连机制
 */

export {};

