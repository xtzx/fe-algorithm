/**
 * ============================================================
 * 📚 HTTP 协议演进
 * ============================================================
 *
 * 面试考察重点：
 * 1. HTTP/1.0 → HTTP/1.1 → HTTP/2 → HTTP/3 的演进
 * 2. 各版本解决的问题和新特性
 * 3. TCP 三次握手四次挥手
 * 4. HTTP 报文结构
 */

// ============================================================
// 1. TCP 基础
// ============================================================

/**
 * 📊 TCP 三次握手（建立连接）
 *
 * 客户端                              服务端
 *    │                                   │
 *    │ ──── SYN (seq=x) ───────────────► │ 第一次：客户端发起连接请求
 *    │                                   │
 *    │ ◄─── SYN-ACK (seq=y, ack=x+1) ─── │ 第二次：服务端确认并请求连接
 *    │                                   │
 *    │ ──── ACK (ack=y+1) ─────────────► │ 第三次：客户端确认
 *    │                                   │
 *    │         连接建立完成               │
 *
 * 💡 为什么是三次握手？
 * - 确认双方的发送和接收能力都正常
 * - 防止已失效的连接请求被服务端接受
 */

/**
 * 📊 TCP 四次挥手（断开连接）
 *
 * 客户端                              服务端
 *    │                                   │
 *    │ ──── FIN (seq=u) ───────────────► │ 第一次：客户端请求断开
 *    │                                   │
 *    │ ◄─── ACK (ack=u+1) ───────────── │ 第二次：服务端确认（此时服务端可能还有数据要发）
 *    │                                   │
 *    │         半关闭状态                 │
 *    │                                   │
 *    │ ◄─── FIN (seq=v) ───────────────  │ 第三次：服务端也请求断开
 *    │                                   │
 *    │ ──── ACK (ack=v+1) ─────────────► │ 第四次：客户端确认
 *    │                                   │
 *    │         连接完全断开               │
 *
 * 💡 为什么是四次挥手？
 * - TCP 是全双工通信，需要双方都同意关闭
 * - 服务端可能还有数据要发送，需要分两步
 */

// ============================================================
// 2. HTTP/1.0
// ============================================================

/**
 * 📊 HTTP/1.0 特点
 *
 * - 无状态协议
 * - 每次请求都需要建立新的 TCP 连接
 * - 不支持 Host 头部（一个 IP 只能对应一个网站）
 * - 支持 GET、POST、HEAD 方法
 *
 * 📊 问题
 *
 * ┌─────────────────────────────────────────────────────────────┐
 * │ 请求 1                                                      │
 * │ 建立 TCP ─► 发送请求 ─► 接收响应 ─► 关闭 TCP                │
 * │                                                             │
 * │ 请求 2                                                      │
 * │ 建立 TCP ─► 发送请求 ─► 接收响应 ─► 关闭 TCP                │
 * │                                                             │
 * │ 每个请求都要重新建立连接，开销大！                           │
 * └─────────────────────────────────────────────────────────────┘
 */

// ============================================================
// 3. HTTP/1.1
// ============================================================

/**
 * 📊 HTTP/1.1 新特性
 *
 * 1. 持久连接（Keep-Alive）
 *    - 默认开启，复用 TCP 连接
 *    - 减少连接建立开销
 *
 * 2. 管道化（Pipelining）
 *    - 可以同时发送多个请求
 *    - 但响应必须按顺序返回（队头阻塞）
 *
 * 3. Host 头部
 *    - 支持虚拟主机
 *    - 一个 IP 可以对应多个域名
 *
 * 4. 分块传输编码（Chunked Transfer Encoding）
 *    - 不需要提前知道内容长度
 *    - 支持流式传输
 *
 * 5. 更多请求方法
 *    - PUT、DELETE、OPTIONS、TRACE、CONNECT
 *
 * 6. 缓存控制
 *    - Cache-Control、ETag 等
 */

/**
 * 📊 HTTP/1.1 的问题：队头阻塞（Head-of-Line Blocking）
 *
 * ┌─────────────────────────────────────────────────────────────┐
 * │                      TCP 连接                               │
 * │                                                             │
 * │  请求 1 ─────────────────────────────────►                 │
 * │  请求 2 ─────────────────────────────────►                 │
 * │  请求 3 ─────────────────────────────────►                 │
 * │                                                             │
 * │  响应 1 ◄─────────────────────────────────  (处理中...)    │
 * │  响应 2          等待响应 1...                              │
 * │  响应 3          等待响应 1...                              │
 * │                                                             │
 * │  如果响应 1 很慢，响应 2、3 都要等待！                        │
 * └─────────────────────────────────────────────────────────────┘
 *
 * 解决方案（HTTP/1.1 时代）：
 * - 开启多个 TCP 连接（浏览器限制 6-8 个）
 * - 域名分片（多个域名分散请求）
 * - 资源合并（雪碧图、打包）
 * - 内联资源
 */

// ============================================================
// 4. HTTP/2
// ============================================================

/**
 * 📊 HTTP/2 新特性
 *
 * 1. 二进制分帧（Binary Framing）
 *    - HTTP/1.x 是文本协议
 *    - HTTP/2 是二进制协议，解析更高效
 *
 * 2. 多路复用（Multiplexing）
 *    - 一个连接上可以同时发送多个请求和响应
 *    - 彻底解决 HTTP 层的队头阻塞
 *
 * 3. 头部压缩（HPACK）
 *    - 使用静态表和动态表压缩头部
 *    - 显著减少头部大小
 *
 * 4. 服务器推送（Server Push）
 *    - 服务器可以主动推送资源
 *    - 无需等待客户端请求
 *
 * 5. 请求优先级
 *    - 可以为请求设置优先级
 *    - 优先传输重要资源
 */

/**
 * 📊 HTTP/2 多路复用详解
 *
 * ┌─────────────────────────────────────────────────────────────┐
 * │                      TCP 连接                               │
 * │                                                             │
 * │  ┌─────────────────────────────────────────────────────┐   │
 * │  │ Stream 1: 请求 A                                    │   │
 * │  │ Stream 2: 请求 B                                    │   │
 * │  │ Stream 3: 请求 C                                    │   │
 * │  └─────────────────────────────────────────────────────┘   │
 * │                          │                                  │
 * │                          ▼                                  │
 * │  ┌────┐┌────┐┌────┐┌────┐┌────┐┌────┐                      │
 * │  │ A1 ││ B1 ││ A2 ││ C1 ││ B2 ││ A3 │  ← 帧交织传输        │
 * │  └────┘└────┘└────┘└────┘└────┘└────┘                      │
 * │                          │                                  │
 * │                          ▼                                  │
 * │  Stream 1: A1 + A2 + A3 = 响应 A                           │
 * │  Stream 2: B1 + B2 = 响应 B                                │
 * │  Stream 3: C1 = 响应 C                                     │
 * │                                                             │
 * │  任意响应先完成都可以先返回，不用等待！                       │
 * └─────────────────────────────────────────────────────────────┘
 */

/**
 * 📊 HTTP/2 仍存在的问题：TCP 层的队头阻塞
 *
 * HTTP/2 解决了 HTTP 层的队头阻塞，但 TCP 层仍存在：
 *
 * - TCP 是有序可靠传输
 * - 如果一个 TCP 包丢失，后续包都要等待重传
 * - 这影响了所有 HTTP/2 流
 *
 * 这就是 HTTP/3 要解决的问题
 */

// ============================================================
// 5. HTTP/3 (QUIC)
// ============================================================

/**
 * 📊 HTTP/3 基于 QUIC 协议
 *
 * QUIC = Quick UDP Internet Connections
 *
 * 特点：
 * 1. 基于 UDP 而非 TCP
 *    - 在应用层实现可靠传输
 *    - 解决 TCP 队头阻塞
 *
 * 2. 0-RTT 连接建立
 *    - 首次连接：1-RTT
 *    - 重连：0-RTT（直接发送数据）
 *
 * 3. 独立的流
 *    - 每个流的丢包不影响其他流
 *    - 彻底解决队头阻塞
 *
 * 4. 连接迁移
 *    - 使用连接 ID 而非四元组
 *    - 切换网络时连接不断开
 *
 * 5. 内置 TLS 1.3
 *    - 加密是强制的
 *    - 减少握手延迟
 */

/**
 * 📊 HTTP 版本对比
 *
 * ┌─────────────┬───────────────┬───────────────┬───────────────┐
 * │   特性       │   HTTP/1.1    │   HTTP/2      │   HTTP/3      │
 * ├─────────────┼───────────────┼───────────────┼───────────────┤
 * │ 传输层       │ TCP           │ TCP           │ QUIC(UDP)     │
 * │ 多路复用     │ ❌            │ ✅            │ ✅            │
 * │ 头部压缩     │ ❌            │ HPACK         │ QPACK         │
 * │ 服务器推送   │ ❌            │ ✅            │ ✅            │
 * │ 队头阻塞     │ HTTP + TCP    │ TCP           │ ❌            │
 * │ 连接建立     │ 1-RTT + TLS   │ 1-RTT + TLS   │ 0/1-RTT       │
 * │ 连接迁移     │ ❌            │ ❌            │ ✅            │
 * │ 强制加密     │ ❌            │ ❌            │ ✅            │
 * └─────────────┴───────────────┴───────────────┴───────────────┘
 */

// ============================================================
// 6. HTTP 报文结构
// ============================================================

/**
 * 📊 请求报文
 *
 * ┌─────────────────────────────────────────────────────────────┐
 * │ 请求行：方法 + URL + 协议版本                                │
 * │ GET /api/users HTTP/1.1                                    │
 * ├─────────────────────────────────────────────────────────────┤
 * │ 请求头                                                      │
 * │ Host: api.example.com                                      │
 * │ User-Agent: Mozilla/5.0...                                 │
 * │ Accept: application/json                                   │
 * │ Content-Type: application/json                             │
 * │ Authorization: Bearer xxx                                  │
 * ├─────────────────────────────────────────────────────────────┤
 * │ 空行                                                        │
 * ├─────────────────────────────────────────────────────────────┤
 * │ 请求体（可选）                                               │
 * │ {"name": "Tom"}                                            │
 * └─────────────────────────────────────────────────────────────┘
 */

/**
 * 📊 响应报文
 *
 * ┌─────────────────────────────────────────────────────────────┐
 * │ 状态行：协议版本 + 状态码 + 状态描述                          │
 * │ HTTP/1.1 200 OK                                            │
 * ├─────────────────────────────────────────────────────────────┤
 * │ 响应头                                                      │
 * │ Content-Type: application/json                             │
 * │ Content-Length: 123                                        │
 * │ Cache-Control: max-age=3600                                │
 * │ Set-Cookie: session=xxx                                    │
 * ├─────────────────────────────────────────────────────────────┤
 * │ 空行                                                        │
 * ├─────────────────────────────────────────────────────────────┤
 * │ 响应体                                                      │
 * │ {"id": 1, "name": "Tom"}                                   │
 * └─────────────────────────────────────────────────────────────┘
 */

/**
 * 📊 常见 HTTP 状态码
 *
 * 1xx 信息响应
 * - 100 Continue：继续发送请求体
 * - 101 Switching Protocols：协议切换（WebSocket）
 *
 * 2xx 成功
 * - 200 OK：成功
 * - 201 Created：创建成功
 * - 204 No Content：成功，无响应体
 * - 206 Partial Content：部分内容（断点续传）
 *
 * 3xx 重定向
 * - 301 Moved Permanently：永久重定向（可缓存）
 * - 302 Found：临时重定向
 * - 304 Not Modified：使用缓存
 * - 307 Temporary Redirect：临时重定向（保持方法）
 * - 308 Permanent Redirect：永久重定向（保持方法）
 *
 * 4xx 客户端错误
 * - 400 Bad Request：请求错误
 * - 401 Unauthorized：未认证
 * - 403 Forbidden：无权限
 * - 404 Not Found：未找到
 * - 405 Method Not Allowed：方法不允许
 * - 429 Too Many Requests：请求过多
 *
 * 5xx 服务器错误
 * - 500 Internal Server Error：服务器内部错误
 * - 502 Bad Gateway：网关错误
 * - 503 Service Unavailable：服务不可用
 * - 504 Gateway Timeout：网关超时
 */

// ============================================================
// 7. 高频面试题
// ============================================================

/**
 * 题目 1：TCP 三次握手的过程？为什么是三次？
 *
 * 过程：
 * 1. 客户端发送 SYN
 * 2. 服务端返回 SYN + ACK
 * 3. 客户端发送 ACK
 *
 * 为什么三次：
 * - 确认双方收发能力正常
 * - 防止已失效的连接请求被接受
 * - 两次不够：服务端无法确认客户端接收能力
 * - 四次没必要：三次已足够
 */

/**
 * 题目 2：HTTP/1.1 的队头阻塞？HTTP/2 如何解决？
 *
 * HTTP/1.1 队头阻塞：
 * - 响应必须按请求顺序返回
 * - 前面的响应慢会阻塞后面的
 *
 * HTTP/2 解决方案：
 * - 多路复用：一个连接多个流
 * - 二进制分帧：请求/响应拆分为帧
 * - 帧交织传输：任意流的帧可以交织
 * - 先完成先返回：不用等待顺序
 *
 * 注意：HTTP/2 仍有 TCP 层队头阻塞
 */

/**
 * 题目 3：HTTP/2 和 HTTP/3 的主要区别？
 *
 * 传输层：
 * - HTTP/2：TCP
 * - HTTP/3：QUIC（基于 UDP）
 *
 * 队头阻塞：
 * - HTTP/2：TCP 层仍存在
 * - HTTP/3：彻底解决
 *
 * 连接建立：
 * - HTTP/2：TCP 握手 + TLS 握手
 * - HTTP/3：0-RTT 或 1-RTT
 *
 * 连接迁移：
 * - HTTP/2：切换网络需重连
 * - HTTP/3：支持连接迁移
 */

/**
 * 题目 4：GET 和 POST 的区别？
 *
 * 语义区别（规范）：
 * - GET：获取资源，幂等，可缓存
 * - POST：提交数据，非幂等，不可缓存
 *
 * 实现区别（实践）：
 * - GET 参数在 URL，POST 在请求体
 * - GET 有长度限制（URL 限制），POST 无
 * - GET 可以被书签保存，POST 不行
 * - GET 浏览器回退无副作用，POST 会重新提交
 *
 * 本质区别：
 * - 技术上没有本质区别，都是 HTTP 请求
 * - 区别主要是语义和使用约定
 */

export {};

