/**
 * ğŸ“ é¢˜ç›®ï¼šç¯å½¢é“¾è¡¨
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/linked-list-cycle/
 * ğŸ·ï¸ éš¾åº¦ï¼šEasy
 * ğŸ·ï¸ æ ‡ç­¾ï¼šå“ˆå¸Œè¡¨ã€é“¾è¡¨ã€åŒæŒ‡é’ˆ
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ headï¼Œåˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯ã€‚
 *
 * å¦‚æœé“¾è¡¨ä¸­å­˜åœ¨ç¯ï¼Œåˆ™è¿”å› trueï¼›å¦åˆ™ï¼Œè¿”å› falseã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šhead = [3,2,0,-4], pos = 1
 * è¾“å‡ºï¼štrue
 * è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹
 *
 *   3 -> 2 -> 0 -> -4
 *        â†‘         â†“
 *        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 */

class ListNode {
  val: number;
  next: ListNode | null;
  constructor(val?: number, next?: ListNode | null) {
    this.val = val === undefined ? 0 : val;
    this.next = next === undefined ? null : next;
  }
}

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯
//
// 1. å“ˆå¸Œè¡¨æ³•ï¼š
//    - éå†é“¾è¡¨ï¼Œç”¨ Set è®°å½•è®¿é—®è¿‡çš„èŠ‚ç‚¹
//    - å¦‚æœé‡åˆ°å·²è®¿é—®çš„èŠ‚ç‚¹ï¼Œè¯´æ˜æœ‰ç¯
//    - æ—¶é—´ O(n)ï¼Œç©ºé—´ O(n)
//
// 2. å¿«æ…¢æŒ‡é’ˆæ³•ï¼ˆæ¨èï¼‰ï¼š
//    - å¿«æŒ‡é’ˆæ¯æ¬¡èµ° 2 æ­¥ï¼Œæ…¢æŒ‡é’ˆæ¯æ¬¡èµ° 1 æ­¥
//    - å¦‚æœæœ‰ç¯ï¼Œå¿«æ…¢æŒ‡é’ˆä¸€å®šä¼šç›¸é‡
//    - å¦‚æœæ— ç¯ï¼Œå¿«æŒ‡é’ˆä¼šå…ˆåˆ°è¾¾ null
//    - æ—¶é—´ O(n)ï¼Œç©ºé—´ O(1)
//
// ğŸ“Š ä¸ºä»€ä¹ˆå¿«æ…¢æŒ‡é’ˆä¸€å®šä¼šç›¸é‡ï¼Ÿ
//
//    å‡è®¾ç¯çš„é•¿åº¦ä¸º L
//    å½“ slow è¿›å…¥ç¯æ—¶ï¼Œfast å·²ç»åœ¨ç¯å†…æŸå¤„
//    æ­¤æ—¶ fast å’Œ slow çš„è·ç¦»ä¸º dï¼ˆd < Lï¼‰
//
//    æ¯ä¸€æ­¥ï¼Œfast æ¯” slow å¤šèµ° 1 æ­¥
//    æ‰€ä»¥ d æ¯æ¬¡å‡ 1
//    æœ€ç»ˆ d ä¼šå˜æˆ 0ï¼Œå³ç›¸é‡

// ============================================================
// è§£æ³•ä¸€ï¼šå¿«æ…¢æŒ‡é’ˆï¼ˆæ¨èï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 *   3 -> 2 -> 0 -> -4
 *        â†‘         â†“
 *        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 *
 *   åˆå§‹: slow=3, fast=3
 *
 *   Step 1: slow=2, fast=0
 *   Step 2: slow=0, fast=2 (fast ç»•ç¯ä¸€åœˆå›æ¥)
 *   Step 3: slow=-4, fast=-4
 *
 *   slow == fastï¼Œæœ‰ç¯ï¼
 *
 * æ— ç¯çš„æƒ…å†µï¼š
 *
 *   1 -> 2 -> 3 -> null
 *
 *   åˆå§‹: slow=1, fast=1
 *   Step 1: slow=2, fast=3
 *   Step 2: slow=3, fast=null
 *
 *   fast == nullï¼Œæ— ç¯
 *
 * ğŸ”„ æµç¨‹å›¾ (Mermaid):
 * ```mermaid
 * flowchart TD
 *     A[slow=head, fast=head] --> B{fast && fast.next?}
 *     B -->|Yes| C[slow = slow.next]
 *     C --> D[fast = fast.next.next]
 *     D --> E{slow == fast?}
 *     E -->|Yes| F[è¿”å› true æœ‰ç¯]
 *     E -->|No| B
 *     B -->|No| G[è¿”å› false æ— ç¯]
 * ```
 */
function hasCycle_v1(head: ListNode | null): boolean {
  if (!head || !head.next) return false;

  let slow: ListNode | null = head;
  let fast: ListNode | null = head;

  while (fast && fast.next) {
    slow = slow!.next; // slow èµ°ä¸€æ­¥
    fast = fast.next.next; // fast èµ°ä¸¤æ­¥

    if (slow === fast) {
      return true; // ç›¸é‡ï¼Œæœ‰ç¯
    }
  }

  return false; // fast åˆ°è¾¾ nullï¼Œæ— ç¯
}

// ============================================================
// è§£æ³•äºŒï¼šå“ˆå¸Œè¡¨
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)
function hasCycle_v2(head: ListNode | null): boolean {
  const visited = new Set<ListNode>();

  let curr = head;
  while (curr) {
    if (visited.has(curr)) {
      return true; // å·²è®¿é—®è¿‡ï¼Œæœ‰ç¯
    }
    visited.add(curr);
    curr = curr.next;
  }

  return false;
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•       | æ—¶é—´  | ç©ºé—´  | ç‰¹ç‚¹                     |
 * |-----------|-------|-------|-------------------------|
 * | å¿«æ…¢æŒ‡é’ˆ   | O(n)  | O(1)  | æ¨èï¼Œç©ºé—´æœ€ä¼˜            |
 * | å“ˆå¸Œè¡¨    | O(n)  | O(n)  | ç®€å•ç›´è§‚                 |
 *
 * é¢è¯•å»ºè®®ï¼šå¿«æ…¢æŒ‡é’ˆæ˜¯æ ‡å‡†è§£æ³•
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. åˆå§‹æ¡ä»¶æ£€æŸ¥ï¼š
 *    - !head || !head.next ç›´æ¥è¿”å› false
 *
 * 2. while å¾ªç¯æ¡ä»¶ï¼š
 *    - fast && fast.next
 *    - å› ä¸º fast æ¯æ¬¡èµ°ä¸¤æ­¥ï¼Œéœ€è¦ä¿è¯ fast.next å­˜åœ¨
 *
 * 3. æ¯”è¾ƒçš„æ˜¯èŠ‚ç‚¹å¼•ç”¨ï¼Œä¸æ˜¯å€¼ï¼š
 *    - slow === fastï¼ˆæ¯”è¾ƒå¼•ç”¨ï¼‰
 *    - ä¸æ˜¯ slow.val === fast.val
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - ç¯å½¢é“¾è¡¨ IIï¼ˆæ‰¾ç¯çš„å…¥å£ï¼‰â†’ å¿«æ…¢æŒ‡é’ˆ + æ•°å­¦æ¨å¯¼
 * - å¿«ä¹æ•° â†’ å¿«æ…¢æŒ‡é’ˆï¼ˆæ•°å­—åºåˆ—å½¢æˆçš„"é“¾è¡¨"ï¼‰
 * - å¯»æ‰¾é‡å¤æ•° â†’ å¿«æ…¢æŒ‡é’ˆ
 *
 * å…±åŒæ¨¡å¼ï¼šå¿«æ…¢æŒ‡é’ˆæ£€æµ‹å¾ªç¯
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. ä¾èµ–æ£€æµ‹ï¼šæ£€æµ‹æ¨¡å—ä¹‹é—´æ˜¯å¦å­˜åœ¨å¾ªç¯ä¾èµ–
 * 2. å¼•ç”¨æ£€æµ‹ï¼šæ£€æµ‹å¯¹è±¡ä¹‹é—´æ˜¯å¦å­˜åœ¨å¾ªç¯å¼•ç”¨ï¼ˆJSONåºåˆ—åŒ–ï¼‰
 * 3. çŠ¶æ€æœºï¼šæ£€æµ‹çŠ¶æ€è½¬æ¢æ˜¯å¦ä¼šè¿›å…¥æ­»å¾ªç¯
 * 4. ä»»åŠ¡è°ƒåº¦ï¼šæ£€æµ‹ä»»åŠ¡ä¾èµ–æ˜¯å¦æœ‰å¾ªç¯
 */

export { ListNode, hasCycle_v1, hasCycle_v2 };
export default hasCycle_v1;

