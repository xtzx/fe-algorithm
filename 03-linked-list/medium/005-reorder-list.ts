/**
 * ğŸ“ é¢˜ç›®ï¼šé‡æ’é“¾è¡¨
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/reorder-list/
 * ğŸ·ï¸ éš¾åº¦ï¼šMedium
 * ğŸ·ï¸ æ ‡ç­¾ï¼šæ ˆã€é€’å½’ã€é“¾è¡¨ã€åŒæŒ‡é’ˆ
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™å®šä¸€ä¸ªå•é“¾è¡¨ L: L0 â†’ L1 â†’ â€¦ â†’ Ln-1 â†’ Ln
 * å°†å…¶é‡æ–°æ’åˆ—åå˜ä¸º: L0 â†’ Ln â†’ L1 â†’ Ln-1 â†’ L2 â†’ Ln-2 â†’ â€¦
 *
 * ä¸èƒ½åªæ˜¯å•çº¯çš„æ”¹å˜èŠ‚ç‚¹å†…éƒ¨çš„å€¼ï¼Œè€Œæ˜¯éœ€è¦å®é™…çš„è¿›è¡ŒèŠ‚ç‚¹äº¤æ¢ã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šhead = [1,2,3,4]
 * è¾“å‡ºï¼š[1,4,2,3]
 *
 * è¾“å…¥ï¼šhead = [1,2,3,4,5]
 * è¾“å‡ºï¼š[1,5,2,4,3]
 */

class ListNode {
  val: number;
  next: ListNode | null;
  constructor(val?: number, next?: ListNode | null) {
    this.val = val === undefined ? 0 : val;
    this.next = next === undefined ? null : next;
  }
}

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// è§‚å¯Ÿè§„å¾‹ï¼š
// - å‰åŠéƒ¨åˆ†æ­£åº
// - ååŠéƒ¨åˆ†å€’åº
// - äº¤æ›¿åˆå¹¶
//
// ä¸‰æ­¥æ³•ï¼š
// 1. æ‰¾åˆ°ä¸­ç‚¹ï¼Œåˆ†æˆä¸¤åŠ
// 2. åè½¬ååŠéƒ¨åˆ†
// 3. äº¤æ›¿åˆå¹¶ä¸¤ä¸ªé“¾è¡¨
//
// è¿™é“é¢˜ç»¼åˆäº†ï¼šæ‰¾ä¸­ç‚¹ + åè½¬é“¾è¡¨ + åˆå¹¶é“¾è¡¨

// ============================================================
// è§£æ³•ï¼šä¸‰æ­¥æ³•ï¼ˆæ¨èï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * åŸé“¾è¡¨: 1 -> 2 -> 3 -> 4 -> 5
 *
 * Step 1: æ‰¾ä¸­ç‚¹
 *
 *   1 -> 2 -> 3 -> 4 -> 5
 *             â†‘
 *            mid
 *
 * Step 2: åˆ†å‰²å¹¶åè½¬ååŠéƒ¨åˆ†
 *
 *   å‰åŠ: 1 -> 2 -> 3 -> null
 *   ååŠ: 4 -> 5 -> null
 *   åè½¬å: 5 -> 4 -> null
 *
 * Step 3: äº¤æ›¿åˆå¹¶
 *
 *   1 -> 5 -> 2 -> 4 -> 3 -> null
 *
 *   å…·ä½“è¿‡ç¨‹:
 *   l1: 1 -> 2 -> 3    l2: 5 -> 4
 *
 *   å– 1ï¼Œå– 5: 1 -> 5
 *   å– 2ï¼Œå– 4: 1 -> 5 -> 2 -> 4
 *   å– 3: 1 -> 5 -> 2 -> 4 -> 3
 */
function reorderList(head: ListNode | null): void {
  if (!head || !head.next) return;

  // Step 1: æ‰¾åˆ°ä¸­ç‚¹
  let slow: ListNode | null = head;
  let fast: ListNode | null = head;

  while (fast.next && fast.next.next) {
    slow = slow!.next;
    fast = fast.next.next;
  }

  // Step 2: åˆ†å‰²å¹¶åè½¬ååŠéƒ¨åˆ†
  let secondHalf = slow!.next;
  slow!.next = null; // æ–­å¼€è¿æ¥

  secondHalf = reverseList(secondHalf);

  // Step 3: äº¤æ›¿åˆå¹¶
  let first: ListNode | null = head;
  let second: ListNode | null = secondHalf;

  while (second) {
    const temp1 = first!.next;
    const temp2 = second.next;

    first!.next = second;
    second.next = temp1;

    first = temp1;
    second = temp2;
  }
}

// åè½¬é“¾è¡¨è¾…åŠ©å‡½æ•°
function reverseList(head: ListNode | null): ListNode | null {
  let prev: ListNode | null = null;
  let curr = head;

  while (curr) {
    const next = curr.next;
    curr.next = prev;
    prev = curr;
    curr = next;
  }

  return prev;
}

// ============================================================
// è§£æ³•äºŒï¼šç”¨æ•°ç»„å­˜å‚¨èŠ‚ç‚¹
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)
// ğŸ“ æ€è·¯ç®€å•ï¼Œä½†ä¸æ»¡è¶³ O(1) ç©ºé—´
function reorderList_v2(head: ListNode | null): void {
  if (!head || !head.next) return;

  // æŠŠèŠ‚ç‚¹å­˜å…¥æ•°ç»„
  const nodes: ListNode[] = [];
  let curr: ListNode | null = head;
  while (curr) {
    nodes.push(curr);
    curr = curr.next;
  }

  // ç”¨åŒæŒ‡é’ˆé‡æ’
  let left = 0;
  let right = nodes.length - 1;

  while (left < right) {
    nodes[left].next = nodes[right];
    left++;

    if (left === right) break;

    nodes[right].next = nodes[left];
    right--;
  }

  nodes[left].next = null;
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•       | æ—¶é—´  | ç©ºé—´  | ç‰¹ç‚¹                     |
 * |-----------|-------|-------|-------------------------|
 * | ä¸‰æ­¥æ³•    | O(n)  | O(1)  | æ¨èï¼Œç»¼åˆè¿ç”¨é“¾è¡¨æŠ€å·§    |
 * | æ•°ç»„å­˜å‚¨   | O(n)  | O(n)  | ç®€å•ç›´è§‚                 |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. æ–­å¼€å‰åä¸¤åŠï¼š
 *    - slow.next = null
 *    - å¦åˆ™ååŠéƒ¨åˆ†è¿˜è¿ç€å‰åŠéƒ¨åˆ†
 *
 * 2. äº¤æ›¿åˆå¹¶æ—¶ä¿å­˜ nextï¼š
 *    - å› ä¸ºä¼šä¿®æ”¹ next æŒ‡é’ˆï¼Œè¦å…ˆä¿å­˜
 *
 * 3. å¾ªç¯ç»“æŸæ¡ä»¶ï¼š
 *    - while (second)
 *    - ååŠéƒ¨åˆ†å¯èƒ½æ¯”å‰åŠéƒ¨åˆ†çŸ­ä¸€ä¸ª
 *
 * 4. åŸåœ°ä¿®æ”¹ï¼š
 *    - å‡½æ•°è¿”å› voidï¼Œä¸æ˜¯è¿”å›æ–°é“¾è¡¨
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - å›æ–‡é“¾è¡¨ â†’ æ‰¾ä¸­ç‚¹ + åè½¬ååŠéƒ¨åˆ†
 * - å¥‡å¶é“¾è¡¨ â†’ åˆ†å‰²å¹¶é‡æ–°è¿æ¥
 * - åˆ†éš”é“¾è¡¨ â†’ æŒ‰æ¡ä»¶åˆ†å‰²
 *
 * è¿™é“é¢˜æ˜¯é“¾è¡¨æ“ä½œçš„ç»¼åˆåº”ç”¨ï¼
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. UI å¸ƒå±€ï¼šäº¤æ›¿æ’åˆ—å…ƒç´ 
 * 2. æ•°æ®å±•ç¤ºï¼šé¦–å°¾äº¤æ›¿å±•ç¤º
 * 3. åŠ¨ç”»åºåˆ—ï¼šäº¤æ›¿æ‰§è¡ŒåŠ¨ç”»
 */

export { ListNode, reorderList, reorderList_v2 };
export default reorderList;

