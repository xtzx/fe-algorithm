/**
 * ğŸ“ é¢˜ç›®ï¼šå›æ–‡é“¾è¡¨
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/palindrome-linked-list/
 * ğŸ·ï¸ éš¾åº¦ï¼šEasy
 * ğŸ·ï¸ æ ‡ç­¾ï¼šæ ˆã€é€’å½’ã€é“¾è¡¨ã€åŒæŒ‡é’ˆ
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ ä¸€ä¸ªå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ headï¼Œè¯·ä½ åˆ¤æ–­è¯¥é“¾è¡¨æ˜¯å¦ä¸ºå›æ–‡é“¾è¡¨ã€‚
 * å¦‚æœæ˜¯ï¼Œè¿”å› trueï¼›å¦åˆ™ï¼Œè¿”å› falseã€‚
 *
 * è¿›é˜¶ï¼šä½ èƒ½å¦ç”¨ O(n) æ—¶é—´å¤æ‚åº¦å’Œ O(1) ç©ºé—´å¤æ‚åº¦è§£å†³æ­¤é¢˜ï¼Ÿ
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šhead = [1,2,2,1]
 * è¾“å‡ºï¼štrue
 *
 * è¾“å…¥ï¼šhead = [1,2]
 * è¾“å‡ºï¼šfalse
 */

class ListNode {
  val: number;
  next: ListNode | null;
  constructor(val?: number, next?: ListNode | null) {
    this.val = val === undefined ? 0 : val;
    this.next = next === undefined ? null : next;
  }
}

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// å›æ–‡ = æ­£ç€è¯»å’Œåç€è¯»ç›¸åŒ
//
// 1. è½¬æ•°ç»„æ³•ï¼š
//    - éå†é“¾è¡¨ï¼ŒæŠŠå€¼å­˜å…¥æ•°ç»„
//    - ç”¨åŒæŒ‡é’ˆåˆ¤æ–­æ•°ç»„æ˜¯å¦å›æ–‡
//    - æ—¶é—´ O(n)ï¼Œç©ºé—´ O(n)
//
// 2. å¿«æ…¢æŒ‡é’ˆ + åè½¬ååŠéƒ¨åˆ†ï¼ˆæ¨èï¼‰ï¼š
//    - å¿«æ…¢æŒ‡é’ˆæ‰¾åˆ°ä¸­ç‚¹
//    - åè½¬ååŠéƒ¨åˆ†
//    - æ¯”è¾ƒå‰åŠå’ŒååŠ
//    - æ—¶é—´ O(n)ï¼Œç©ºé—´ O(1)
//
// 3. é€’å½’æ³•ï¼š
//    - åˆ©ç”¨é€’å½’çš„å›æº¯ç‰¹æ€§
//    - æ—¶é—´ O(n)ï¼Œç©ºé—´ O(n)ï¼ˆé€’å½’æ ˆï¼‰

// ============================================================
// è§£æ³•ä¸€ï¼šå¿«æ…¢æŒ‡é’ˆ + åè½¬ï¼ˆæ¨èï¼ŒO(1) ç©ºé—´ï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * é“¾è¡¨: 1 -> 2 -> 2 -> 1 -> null
 *
 * Step 1: å¿«æ…¢æŒ‡é’ˆæ‰¾ä¸­ç‚¹
 *
 *   1 -> 2 -> 2 -> 1 -> null
 *        â†‘         â†‘
 *       slow      fast
 *
 *   slow åœåœ¨ä¸­ç‚¹ï¼ˆå¯¹äºå¶æ•°é•¿åº¦ï¼Œåœåœ¨å·¦åŠéƒ¨åˆ†çš„æœ€åä¸€ä¸ªï¼‰
 *
 * Step 2: åè½¬ååŠéƒ¨åˆ†
 *
 *   å‰åŠ: 1 -> 2 -> null
 *   ååŠ: 1 -> 2 -> nullï¼ˆåè½¬åï¼‰
 *
 * Step 3: æ¯”è¾ƒ
 *
 *   1 == 1, 2 == 2 â†’ æ˜¯å›æ–‡
 *
 * å¥‡æ•°é•¿åº¦çš„æƒ…å†µï¼š
 *
 *   1 -> 2 -> 3 -> 2 -> 1 -> null
 *             â†‘              â†‘
 *            slow          fast
 *
 *   ä¸­é—´å…ƒç´  3 å¯ä»¥å¿½ç•¥ï¼Œåªæ¯”è¾ƒä¸¤è¾¹
 */
function isPalindrome_v1(head: ListNode | null): boolean {
  if (!head || !head.next) return true;

  // Step 1: å¿«æ…¢æŒ‡é’ˆæ‰¾ä¸­ç‚¹
  let slow: ListNode | null = head;
  let fast: ListNode | null = head;

  while (fast.next && fast.next.next) {
    slow = slow!.next;
    fast = fast.next.next;
  }

  // Step 2: åè½¬ååŠéƒ¨åˆ†
  let secondHalf = reverseList(slow!.next);

  // Step 3: æ¯”è¾ƒå‰åŠå’ŒååŠ
  let p1: ListNode | null = head;
  let p2: ListNode | null = secondHalf;

  let result = true;
  while (p2) {
    if (p1!.val !== p2.val) {
      result = false;
      break;
    }
    p1 = p1!.next;
    p2 = p2.next;
  }

  // ï¼ˆå¯é€‰ï¼‰æ¢å¤é“¾è¡¨
  // slow!.next = reverseList(secondHalf);

  return result;
}

// åè½¬é“¾è¡¨è¾…åŠ©å‡½æ•°
function reverseList(head: ListNode | null): ListNode | null {
  let prev: ListNode | null = null;
  let curr = head;

  while (curr) {
    const next = curr.next;
    curr.next = prev;
    prev = curr;
    curr = next;
  }

  return prev;
}

// ============================================================
// è§£æ³•äºŒï¼šè½¬æ•°ç»„
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)
function isPalindrome_v2(head: ListNode | null): boolean {
  const values: number[] = [];

  // é“¾è¡¨è½¬æ•°ç»„
  let curr = head;
  while (curr) {
    values.push(curr.val);
    curr = curr.next;
  }

  // åŒæŒ‡é’ˆåˆ¤æ–­å›æ–‡
  let left = 0;
  let right = values.length - 1;

  while (left < right) {
    if (values[left] !== values[right]) {
      return false;
    }
    left++;
    right--;
  }

  return true;
}

// ============================================================
// è§£æ³•ä¸‰ï¼šé€’å½’ï¼ˆåˆ©ç”¨å›æº¯ï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(n) é€’å½’æ ˆ

/**
 * ğŸ“Š é€’å½’æ€è·¯ï¼š
 *
 * é€’å½’åˆ°é“¾è¡¨æœ«å°¾ï¼Œå›æº¯æ—¶ä¸å‰ç«¯æŒ‡é’ˆæ¯”è¾ƒ
 *
 * å…¨å±€å˜é‡ frontPointer ä»å¤´å¼€å§‹
 * é€’å½’åˆ°åº•åï¼ŒcurrentNode ä»å°¾éƒ¨å›æº¯
 *
 * æ¯”è¾ƒ frontPointer å’Œ currentNode
 */
function isPalindrome_v3(head: ListNode | null): boolean {
  let frontPointer = head;

  function recursivelyCheck(currentNode: ListNode | null): boolean {
    if (currentNode) {
      // å…ˆé€’å½’åˆ°åº•
      if (!recursivelyCheck(currentNode.next)) {
        return false;
      }
      // å›æº¯æ—¶æ¯”è¾ƒ
      if (currentNode.val !== frontPointer!.val) {
        return false;
      }
      // ç§»åŠ¨å‰ç«¯æŒ‡é’ˆ
      frontPointer = frontPointer!.next;
    }
    return true;
  }

  return recursivelyCheck(head);
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•           | æ—¶é—´  | ç©ºé—´  | ç‰¹ç‚¹                     |
 * |---------------|-------|-------|-------------------------|
 * | å¿«æ…¢æŒ‡é’ˆ+åè½¬  | O(n)  | O(1)  | æ¨èï¼Œæ»¡è¶³è¿›é˜¶è¦æ±‚        |
 * | è½¬æ•°ç»„        | O(n)  | O(n)  | ç®€å•ç›´è§‚                 |
 * | é€’å½’          | O(n)  | O(n)  | åˆ©ç”¨é€’å½’æ ˆ              |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. æ‰¾ä¸­ç‚¹æ—¶çš„è¾¹ç•Œï¼š
 *    - å¥‡æ•°é•¿åº¦ï¼šslow åœåœ¨æ­£ä¸­é—´
 *    - å¶æ•°é•¿åº¦ï¼šslow åœåœ¨å·¦åŠéƒ¨åˆ†çš„æœ€åä¸€ä¸ª
 *    - ååŠéƒ¨åˆ†ä» slow.next å¼€å§‹
 *
 * 2. æ¯”è¾ƒæ—¶ä»¥ååŠéƒ¨åˆ†ä¸ºå‡†ï¼š
 *    - while (p2) ä¸æ˜¯ while (p1)
 *    - å› ä¸ºååŠéƒ¨åˆ†å¯èƒ½æ›´çŸ­
 *
 * 3. é“¾è¡¨æ¢å¤ï¼š
 *    - å¦‚æœéœ€è¦ä¿æŒåŸé“¾è¡¨ç»“æ„ï¼Œè¦æ¢å¤ååŠéƒ¨åˆ†
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - éªŒè¯å›æ–‡ä¸² â†’ åŒæŒ‡é’ˆ
 * - åè½¬é“¾è¡¨ â†’ åŸºç¡€æ“ä½œ
 * - é“¾è¡¨ä¸­ç‚¹ â†’ å¿«æ…¢æŒ‡é’ˆ
 *
 * è¿™é“é¢˜ç»¼åˆäº†ï¼šå¿«æ…¢æŒ‡é’ˆ + é“¾è¡¨åè½¬ + å›æ–‡åˆ¤æ–­
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. æ•°æ®æ ¡éªŒï¼šéªŒè¯ç‰¹å®šæ ¼å¼çš„æ•°æ®æ˜¯å¦å¯¹ç§°
 * 2. ç¼–è¾‘å™¨ï¼šæ£€æµ‹ç”¨æˆ·è¾“å…¥æ˜¯å¦å›æ–‡
 * 3. æ¸¸æˆé€»è¾‘ï¼šåˆ¤æ–­æ“ä½œåºåˆ—æ˜¯å¦å¯¹ç§°
 */

export { ListNode, isPalindrome_v1, isPalindrome_v2, isPalindrome_v3 };
export default isPalindrome_v1;

