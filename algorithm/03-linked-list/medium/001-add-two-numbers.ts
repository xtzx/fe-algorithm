/**
 * ğŸ“ é¢˜ç›®ï¼šä¸¤æ•°ç›¸åŠ 
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/add-two-numbers/
 * ğŸ·ï¸ éš¾åº¦ï¼šMedium
 * ğŸ·ï¸ æ ‡ç­¾ï¼šé€’å½’ã€é“¾è¡¨ã€æ•°å­¦
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ ä¸¤ä¸ª éç©º çš„é“¾è¡¨ï¼Œè¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°ã€‚
 * å®ƒä»¬æ¯ä½æ•°å­—éƒ½æ˜¯æŒ‰ç…§ é€†åº çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨ ä¸€ä½ æ•°å­—ã€‚
 * è¯·ä½ å°†ä¸¤ä¸ªæ•°ç›¸åŠ ï¼Œå¹¶ä»¥ç›¸åŒå½¢å¼è¿”å›ä¸€ä¸ªè¡¨ç¤ºå’Œçš„é“¾è¡¨ã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šl1 = [2,4,3], l2 = [5,6,4]
 * è¾“å‡ºï¼š[7,0,8]
 * è§£é‡Šï¼š342 + 465 = 807
 *
 *   2 -> 4 -> 3   (342)
 * + 5 -> 6 -> 4   (465)
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 *   7 -> 0 -> 8   (807)
 */

class ListNode {
  val: number;
  next: ListNode | null;
  constructor(val?: number, next?: ListNode | null) {
    this.val = val === undefined ? 0 : val;
    this.next = next === undefined ? null : next;
  }
}

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// æ¨¡æ‹Ÿç«–å¼åŠ æ³•
//
// å…³é”®ç‚¹ï¼š
// - é“¾è¡¨æ˜¯é€†åºå­˜å‚¨ï¼Œåˆšå¥½ä»ä¸ªä½å¼€å§‹ï¼Œæ–¹ä¾¿è¿›ä½
// - éœ€è¦å¤„ç†è¿›ä½
// - ä¸¤ä¸ªé“¾è¡¨é•¿åº¦å¯èƒ½ä¸åŒ
// - æœ€åå¯èƒ½è¿˜æœ‰è¿›ä½

// ============================================================
// è§£æ³•ä¸€ï¼šæ¨¡æ‹ŸåŠ æ³•ï¼ˆæ¨èï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(max(m,n)) | ç©ºé—´å¤æ‚åº¦ï¼šO(1) ä¸ç®—è¾“å‡º

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * l1: 2 -> 4 -> 3
 * l2: 5 -> 6 -> 4
 *
 * Step 1: 2 + 5 = 7, carry = 0
 *         result: 7
 *
 * Step 2: 4 + 6 + 0 = 10, carry = 1
 *         result: 7 -> 0
 *
 * Step 3: 3 + 4 + 1 = 8, carry = 0
 *         result: 7 -> 0 -> 8
 *
 * ä¸¤ä¸ªé“¾è¡¨éƒ½éå†å®Œï¼Œcarry = 0ï¼Œç»“æŸ
 *
 * å¸¦è¿›ä½çš„ä¾‹å­ï¼š
 * l1: 9 -> 9
 * l2: 1
 *
 * Step 1: 9 + 1 = 10, carry = 1
 *         result: 0
 *
 * Step 2: 9 + 0 + 1 = 10, carry = 1
 *         result: 0 -> 0
 *
 * Step 3: 0 + 0 + 1 = 1, carry = 0
 *         result: 0 -> 0 -> 1
 */
function addTwoNumbers_v1(
  l1: ListNode | null,
  l2: ListNode | null
): ListNode | null {
  const dummy = new ListNode(0);
  let curr = dummy;
  let carry = 0;

  while (l1 || l2 || carry) {
    // è·å–å½“å‰ä½çš„å€¼ï¼Œå¦‚æœé“¾è¡¨å·²ç»éå†å®Œåˆ™ä¸º 0
    const val1 = l1 ? l1.val : 0;
    const val2 = l2 ? l2.val : 0;

    // è®¡ç®—å’Œä¸è¿›ä½
    const sum = val1 + val2 + carry;
    carry = Math.floor(sum / 10);

    // åˆ›å»ºæ–°èŠ‚ç‚¹
    curr.next = new ListNode(sum % 10);
    curr = curr.next;

    // ç§»åŠ¨æŒ‡é’ˆ
    if (l1) l1 = l1.next;
    if (l2) l2 = l2.next;
  }

  return dummy.next;
}

// ============================================================
// è§£æ³•äºŒï¼šé€’å½’
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(max(m,n)) | ç©ºé—´å¤æ‚åº¦ï¼šO(max(m,n)) é€’å½’æ ˆ
function addTwoNumbers_v2(
  l1: ListNode | null,
  l2: ListNode | null,
  carry: number = 0
): ListNode | null {
  // åŸºæœ¬æƒ…å†µï¼šéƒ½ä¸ºç©ºä¸”æ²¡æœ‰è¿›ä½
  if (!l1 && !l2 && carry === 0) {
    return null;
  }

  const val1 = l1 ? l1.val : 0;
  const val2 = l2 ? l2.val : 0;
  const sum = val1 + val2 + carry;

  const node = new ListNode(sum % 10);
  node.next = addTwoNumbers_v2(
    l1 ? l1.next : null,
    l2 ? l2.next : null,
    Math.floor(sum / 10)
  );

  return node;
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•     | æ—¶é—´        | ç©ºé—´        | ç‰¹ç‚¹              |
 * |---------|-------------|-------------|------------------|
 * | è¿­ä»£    | O(max(m,n)) | O(1)        | æ¨èï¼Œç©ºé—´æœ€ä¼˜     |
 * | é€’å½’    | O(max(m,n)) | O(max(m,n)) | ä»£ç ç®€æ´          |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. è¿›ä½å¤„ç†ï¼š
 *    - carry = Math.floor(sum / 10)
 *    - èŠ‚ç‚¹å€¼ = sum % 10
 *
 * 2. å¾ªç¯ç»“æŸæ¡ä»¶ï¼š
 *    - while (l1 || l2 || carry)
 *    - ä¸è¦å¿˜è®° carryï¼Œæœ€åå¯èƒ½è¿˜æœ‰è¿›ä½
 *
 * 3. ç©ºå€¼å¤„ç†ï¼š
 *    - l1 æˆ– l2 ä¸ºç©ºæ—¶å½“ä½œ 0 å¤„ç†
 *
 * 4. è™šæ‹Ÿå¤´èŠ‚ç‚¹ï¼š
 *    - ä½¿ç”¨ dummy ç®€åŒ–ä»£ç 
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - ä¸¤æ•°ç›¸åŠ  IIï¼ˆæ­£åºå­˜å‚¨ï¼‰â†’ åè½¬åç›¸åŠ  / ç”¨æ ˆ
 * - å­—ç¬¦ä¸²ç›¸åŠ  â†’ ç±»ä¼¼çš„æ¨¡æ‹ŸåŠ æ³•
 * - é“¾è¡¨æ±‚å’Œï¼ˆé«˜ç²¾åº¦ï¼‰â†’ åŒæ ·çš„æ€è·¯
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. å¤§æ•°è®¡ç®—ï¼šå¤„ç†è¶…å‡º Number èŒƒå›´çš„æ•°å€¼
 * 2. é‡‘èè®¡ç®—ï¼šç²¾ç¡®çš„é‡‘é¢è®¡ç®—
 * 3. ç‰ˆæœ¬å·å¤„ç†ï¼šç‰ˆæœ¬å·çš„æ•°å€¼æ¯”è¾ƒ
 */

export { ListNode, addTwoNumbers_v1, addTwoNumbers_v2 };
export default addTwoNumbers_v1;

