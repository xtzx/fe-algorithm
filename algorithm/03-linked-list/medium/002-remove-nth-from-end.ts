/**
 * ğŸ“ é¢˜ç›®ï¼šåˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªç»“ç‚¹
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/remove-nth-node-from-end-of-list/
 * ğŸ·ï¸ éš¾åº¦ï¼šMedium
 * ğŸ·ï¸ æ ‡ç­¾ï¼šé“¾è¡¨ã€åŒæŒ‡é’ˆ
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ ä¸€ä¸ªé“¾è¡¨ï¼Œåˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ n ä¸ªç»“ç‚¹ï¼Œå¹¶ä¸”è¿”å›é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚
 *
 * è¿›é˜¶ï¼šä½ èƒ½å°è¯•ä½¿ç”¨ä¸€è¶Ÿæ‰«æå®ç°å—ï¼Ÿ
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šhead = [1,2,3,4,5], n = 2
 * è¾“å‡ºï¼š[1,2,3,5]
 *
 * è¾“å…¥ï¼šhead = [1], n = 1
 * è¾“å‡ºï¼š[]
 */

class ListNode {
  val: number;
  next: ListNode | null;
  constructor(val?: number, next?: ListNode | null) {
    this.val = val === undefined ? 0 : val;
    this.next = next === undefined ? null : next;
  }
}

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// å€’æ•°ç¬¬ N ä¸ª â†’ å¿«æ…¢æŒ‡é’ˆï¼
//
// 1. ä¸¤éæ‰«æï¼š
//    - ç¬¬ä¸€éï¼šè®¡ç®—é“¾è¡¨é•¿åº¦ L
//    - ç¬¬äºŒéï¼šåˆ é™¤ç¬¬ L-N+1 ä¸ªèŠ‚ç‚¹
//
// 2. ä¸€éæ‰«æï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰ï¼š
//    - fast å…ˆèµ° N æ­¥
//    - ç„¶å fast å’Œ slow ä¸€èµ·èµ°
//    - fast åˆ°è¾¾æœ«å°¾æ—¶ï¼Œslow æ­£å¥½åœ¨å€’æ•°ç¬¬ N+1 ä¸ªä½ç½®
//    - åˆ é™¤ slow.next
//
// å…³é”®ï¼šè¦åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹ï¼Œéœ€è¦æ‰¾åˆ°å®ƒçš„å‰ä¸€ä¸ªèŠ‚ç‚¹

// ============================================================
// è§£æ³•ä¸€ï¼šå¿«æ…¢æŒ‡é’ˆï¼ˆä¸€éæ‰«æï¼Œæ¨èï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * é“¾è¡¨: 1 -> 2 -> 3 -> 4 -> 5, n = 2
 *
 * Step 1: ä½¿ç”¨è™šæ‹Ÿå¤´èŠ‚ç‚¹
 *
 *   dummy -> 1 -> 2 -> 3 -> 4 -> 5 -> null
 *     â†‘
 *   slow/fast
 *
 * Step 2: fast å…ˆèµ° n = 2 æ­¥
 *
 *   dummy -> 1 -> 2 -> 3 -> 4 -> 5 -> null
 *     â†‘           â†‘
 *    slow       fast
 *
 * Step 3: fast å’Œ slow ä¸€èµ·èµ°ï¼Œç›´åˆ° fast.next == null
 *
 *   dummy -> 1 -> 2 -> 3 -> 4 -> 5 -> null
 *                      â†‘              â†‘
 *                    slow           fast
 *
 * Step 4: åˆ é™¤ slow.nextï¼ˆå€’æ•°ç¬¬ 2 ä¸ªï¼‰
 *
 *   slow.next = slow.next.next
 *   dummy -> 1 -> 2 -> 3 -> 5 -> null
 *
 * è¿”å› dummy.next
 *
 * ğŸ”„ æµç¨‹å›¾ (Mermaid):
 * ```mermaid
 * flowchart TD
 *     A[dummy -> head, slow=dummy, fast=dummy] --> B[fast èµ° n æ­¥]
 *     B --> C{fast.next != null?}
 *     C -->|Yes| D[slow++, fast++]
 *     D --> C
 *     C -->|No| E[slow.next = slow.next.next]
 *     E --> F[è¿”å› dummy.next]
 * ```
 */
function removeNthFromEnd_v1(head: ListNode | null, n: number): ListNode | null {
  // è™šæ‹Ÿå¤´èŠ‚ç‚¹ï¼Œå¤„ç†åˆ é™¤å¤´èŠ‚ç‚¹çš„æƒ…å†µ
  const dummy = new ListNode(0);
  dummy.next = head;

  let slow: ListNode | null = dummy;
  let fast: ListNode | null = dummy;

  // fast å…ˆèµ° n æ­¥
  for (let i = 0; i < n; i++) {
    fast = fast!.next;
  }

  // fast å’Œ slow ä¸€èµ·èµ°ï¼Œç›´åˆ° fast åˆ°è¾¾æœ€åä¸€ä¸ªèŠ‚ç‚¹
  while (fast!.next) {
    slow = slow!.next;
    fast = fast!.next;
  }

  // åˆ é™¤ slow.next
  slow!.next = slow!.next!.next;

  return dummy.next;
}

// ============================================================
// è§£æ³•äºŒï¼šä¸¤éæ‰«æ
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)
function removeNthFromEnd_v2(head: ListNode | null, n: number): ListNode | null {
  // è®¡ç®—é“¾è¡¨é•¿åº¦
  let length = 0;
  let curr = head;
  while (curr) {
    length++;
    curr = curr.next;
  }

  // è™šæ‹Ÿå¤´èŠ‚ç‚¹
  const dummy = new ListNode(0);
  dummy.next = head;

  // æ‰¾åˆ°è¦åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹
  curr = dummy;
  for (let i = 0; i < length - n; i++) {
    curr = curr!.next;
  }

  // åˆ é™¤èŠ‚ç‚¹
  curr!.next = curr!.next!.next;

  return dummy.next;
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•       | æ—¶é—´  | ç©ºé—´  | æ‰«ææ¬¡æ•° | ç‰¹ç‚¹              |
 * |-----------|-------|-------|---------|------------------|
 * | å¿«æ…¢æŒ‡é’ˆ   | O(n)  | O(1)  | 1       | æ¨èï¼Œä¸€éæ‰«æ     |
 * | ä¸¤éæ‰«æ   | O(n)  | O(1)  | 2       | æ€è·¯ç›´è§‚          |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. è™šæ‹Ÿå¤´èŠ‚ç‚¹ï¼š
 *    - å¯èƒ½åˆ é™¤å¤´èŠ‚ç‚¹ï¼Œéœ€è¦ dummy
 *    - æœ€åè¿”å› dummy.next
 *
 * 2. fast èµ° n æ­¥çš„å«ä¹‰ï¼š
 *    - è®© fast å’Œ slow ä¹‹é—´é—´éš” n ä¸ªèŠ‚ç‚¹
 *
 * 3. å¾ªç¯ç»“æŸæ¡ä»¶ï¼š
 *    - while (fast.next)ï¼Œä¸æ˜¯ while (fast)
 *    - å› ä¸ºéœ€è¦ slow åœåœ¨å¾…åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ª
 *
 * 4. è¾¹ç•Œæƒ…å†µï¼š
 *    - åˆ é™¤å”¯ä¸€èŠ‚ç‚¹
 *    - åˆ é™¤å¤´èŠ‚ç‚¹
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - é“¾è¡¨ä¸­å€’æ•°ç¬¬ k ä¸ªèŠ‚ç‚¹ â†’ å¿«æ…¢æŒ‡é’ˆ
 * - åˆ é™¤é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ â†’ ç›´æ¥æ“ä½œ
 * - ç§»é™¤é“¾è¡¨å…ƒç´  â†’ éå†åˆ é™¤
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. å†å²è®°å½•ï¼šåˆ é™¤å€’æ•°ç¬¬ N æ¡å†å²
 * 2. æ’¤é”€æ“ä½œï¼šåˆ é™¤æœ€è¿‘çš„ç¬¬ N æ¬¡æ“ä½œ
 * 3. ç¼“å­˜ç®¡ç†ï¼šæ·˜æ±°ç‰¹å®šä½ç½®çš„ç¼“å­˜
 */

export { ListNode, removeNthFromEnd_v1, removeNthFromEnd_v2 };
export default removeNthFromEnd_v1;

