/**
 * ğŸ“ é¢˜ç›®ï¼šæœ€å¤§å­æ•°ç»„å’Œ
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/maximum-subarray/
 * ğŸ·ï¸ éš¾åº¦ï¼šEasyï¼ˆMedium éš¾åº¦çš„æ€ç»´ï¼‰
 * ğŸ·ï¸ æ ‡ç­¾ï¼šæ•°ç»„ã€åˆ†æ²»ã€åŠ¨æ€è§„åˆ’
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œè¯·ä½ æ‰¾å‡ºä¸€ä¸ªå…·æœ‰æœ€å¤§å’Œçš„è¿ç»­å­æ•°ç»„ï¼ˆå­æ•°ç»„æœ€å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œ
 * è¿”å›å…¶æœ€å¤§å’Œã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šnums = [-2,1,-3,4,-1,2,1,-5,4]
 * è¾“å‡ºï¼š6
 * è§£é‡Šï¼šè¿ç»­å­æ•°ç»„ [4,-1,2,1] çš„å’Œæœ€å¤§ï¼Œä¸º 6ã€‚
 */

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// å…³é”®æ´å¯Ÿï¼š
// - å¦‚æœå‰é¢çš„å’Œæ˜¯è´Ÿæ•°ï¼Œä¸å¦‚ä»å½“å‰å…ƒç´ é‡æ–°å¼€å§‹
// - å¦‚æœå‰é¢çš„å’Œæ˜¯æ­£æ•°ï¼ŒåŠ ä¸Šå®ƒä¼šè®©å½“å‰æ›´å¤§
//
// dp[i] = ä»¥ nums[i] ç»“å°¾çš„æœ€å¤§å­æ•°ç»„å’Œ
//
// çŠ¶æ€è½¬ç§»ï¼š
// - å‰é¢çš„å’Œæ˜¯æ­£æ•°ï¼šdp[i] = dp[i-1] + nums[i]
// - å‰é¢çš„å’Œæ˜¯è´Ÿæ•°ï¼šdp[i] = nums[i]
// â†’ dp[i] = max(dp[i-1] + nums[i], nums[i])
//    = max(dp[i-1], 0) + nums[i]

// ============================================================
// è§£æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * nums = [-2, 1, -3, 4, -1, 2, 1, -5, 4]
 *
 * â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”
 * â”‚ nums â”‚ -2 â”‚ 1 â”‚ -3 â”‚ 4 â”‚ -1 â”‚ 2 â”‚ 1 â”‚ -5 â”‚ 4 â”‚
 * â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚  dp  â”‚ -2 â”‚ 1 â”‚ -2 â”‚ 4 â”‚  3 â”‚ 5 â”‚ 6 â”‚  1 â”‚ 5 â”‚
 * â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”˜
 *
 * max(dp) = 6
 */
function maxSubArray(nums: number[]): number {
  const n = nums.length;
  const dp: number[] = [nums[0]];

  for (let i = 1; i < n; i++) {
    dp[i] = Math.max(dp[i - 1] + nums[i], nums[i]);
  }

  return Math.max(...dp);
}

// ============================================================
// è§£æ³•äºŒï¼šç©ºé—´ä¼˜åŒ–ï¼ˆKadane ç®—æ³•ï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)
function maxSubArray_kadane(nums: number[]): number {
  let currentSum = nums[0];
  let maxSum = nums[0];

  for (let i = 1; i < nums.length; i++) {
    // å½“å‰ä½ç½®çš„æœ€å¤§å­æ•°ç»„å’Œ
    currentSum = Math.max(currentSum + nums[i], nums[i]);
    // æ›´æ–°å…¨å±€æœ€å¤§
    maxSum = Math.max(maxSum, currentSum);
  }

  return maxSum;
}

// ============================================================
// è§£æ³•ä¸‰ï¼šåˆ†æ²»ï¼ˆäº†è§£å³å¯ï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n log n) | ç©ºé—´å¤æ‚åº¦ï¼šO(log n)
function maxSubArray_divideConquer(nums: number[]): number {
  function helper(left: number, right: number): number {
    if (left === right) return nums[left];

    const mid = Math.floor((left + right) / 2);

    // å·¦åŠè¾¹æœ€å¤§å­æ•°ç»„
    const leftMax = helper(left, mid);
    // å³åŠè¾¹æœ€å¤§å­æ•°ç»„
    const rightMax = helper(mid + 1, right);
    // è·¨è¶Šä¸­ç‚¹çš„æœ€å¤§å­æ•°ç»„
    const crossMax = maxCrossing(left, mid, right);

    return Math.max(leftMax, rightMax, crossMax);
  }

  function maxCrossing(left: number, mid: number, right: number): number {
    // ä»ä¸­ç‚¹å‘å·¦æ‰©å±•
    let leftSum = -Infinity;
    let sum = 0;
    for (let i = mid; i >= left; i--) {
      sum += nums[i];
      leftSum = Math.max(leftSum, sum);
    }

    // ä»ä¸­ç‚¹å‘å³æ‰©å±•
    let rightSum = -Infinity;
    sum = 0;
    for (let i = mid + 1; i <= right; i++) {
      sum += nums[i];
      rightSum = Math.max(rightSum, sum);
    }

    return leftSum + rightSum;
  }

  return helper(0, nums.length - 1);
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•   | æ—¶é—´      | ç©ºé—´      | ç‰¹ç‚¹              |
 * |--------|-----------|-----------|-------------------|
 * | DP     | O(n)      | O(n)      | å¥½ç†è§£            |
 * | Kadane | O(n)      | O(1)      | æ¨èï¼Œæœ€ä¼˜        |
 * | åˆ†æ²»   | O(n log n)| O(log n)  | ç»ƒä¹ åˆ†æ²»æ€æƒ³      |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. çŠ¶æ€å®šä¹‰ï¼šdp[i] æ˜¯ä»¥ nums[i] ç»“å°¾çš„æœ€å¤§å’Œï¼Œä¸æ˜¯å‰ i ä¸ª
 *
 * 2. åˆå§‹å€¼ï¼šdp[0] = nums[0]ï¼Œä¸æ˜¯ 0
 *
 * 3. è¿”å›å€¼ï¼šmax(dp)ï¼Œä¸æ˜¯ dp[n-1]
 *
 * 4. å…¨è´Ÿæ•°æƒ…å†µï¼šç®—æ³•è‡ªåŠ¨å¤„ç†ï¼Œä¼šé€‰æ‹©æœ€å¤§çš„è´Ÿæ•°
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - æœ€å¤§å­æ•°ç»„å’Œï¼ˆç¯å½¢ï¼‰â†’ åˆ†ä¸¤ç§æƒ…å†µè®¨è®º
 * - ä¹˜ç§¯æœ€å¤§å­æ•°ç»„ â†’ éœ€è¦åŒæ—¶è®°å½•æœ€å°å€¼
 * - æœ€å¤§å­çŸ©é˜µ â†’ äºŒç»´æ‰©å±•
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. æ€§èƒ½åˆ†æï¼šæ‰¾æœ€å¤§è¿ç»­å¢é•¿/ä¸‹é™åŒºé—´
 * 2. æ•°æ®å¤„ç†ï¼šæ‰¾æœ€å¤§ç›ˆåˆ©/äºæŸåŒºé—´
 */

export { maxSubArray, maxSubArray_kadane, maxSubArray_divideConquer };
export default maxSubArray;

