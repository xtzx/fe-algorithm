/**
 * ðŸ“ é¢˜ç›®ï¼šæœ€é•¿å…¬å…±å­åºåˆ—
 * ðŸ”— é“¾æŽ¥ï¼šhttps://leetcode.cn/problems/longest-common-subsequence/
 * ðŸ·ï¸ éš¾åº¦ï¼šMedium
 * ðŸ·ï¸ æ ‡ç­¾ï¼šå­—ç¬¦ä¸²ã€åŠ¨æ€è§„åˆ’
 *
 * ðŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² text1 å’Œ text2ï¼Œè¿”å›žè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦ã€‚
 * å¦‚æžœä¸å­˜åœ¨å…¬å…±å­åºåˆ—ï¼Œè¿”å›ž 0ã€‚
 *
 * å­åºåˆ—æ˜¯æŒ‡è¿™æ ·ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼šå®ƒæ˜¯ç”±åŽŸå­—ç¬¦ä¸²åœ¨ä¸æ”¹å˜å­—ç¬¦çš„ç›¸å¯¹é¡ºåºçš„æƒ…å†µä¸‹åˆ é™¤æŸäº›å­—ç¬¦
 * ï¼ˆä¹Ÿå¯ä»¥ä¸åˆ é™¤ä»»ä½•å­—ç¬¦ï¼‰åŽç»„æˆçš„æ–°å­—ç¬¦ä¸²ã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼štext1 = "abcde", text2 = "ace"
 * è¾“å‡ºï¼š3
 * è§£é‡Šï¼šæœ€é•¿å…¬å…±å­åºåˆ—æ˜¯ "ace"
 */

// ============================================================
// ðŸ’¡ æ€è·¯åˆ†æžï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€Žä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// ç»å…¸çš„äºŒç»´ DP é—®é¢˜ï¼
//
// dp[i][j] = text1[0..i-1] å’Œ text2[0..j-1] çš„ LCS é•¿åº¦
//
// çŠ¶æ€è½¬ç§»ï¼š
// å¦‚æžœ text1[i-1] === text2[j-1]ï¼š
//   dp[i][j] = dp[i-1][j-1] + 1
// å¦åˆ™ï¼š
//   dp[i][j] = max(dp[i-1][j], dp[i][j-1])

// ============================================================
// è§£æ³•ä¸€ï¼šäºŒç»´ DP
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(mÃ—n) | ç©ºé—´å¤æ‚åº¦ï¼šO(mÃ—n)

/**
 * ðŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * text1 = "abcde", text2 = "ace"
 *
 * â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
 * â”‚   â”‚ "" â”‚ a â”‚ c â”‚ e â”‚
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚"" â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚ a â”‚ 0 â”‚ 1 â”‚ 1 â”‚ 1 â”‚  a === a, dp[1][1] = dp[0][0] + 1 = 1
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚ b â”‚ 0 â”‚ 1 â”‚ 1 â”‚ 1 â”‚
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚ c â”‚ 0 â”‚ 1 â”‚ 2 â”‚ 2 â”‚  c === c, dp[3][2] = dp[2][1] + 1 = 2
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚ d â”‚ 0 â”‚ 1 â”‚ 2 â”‚ 2 â”‚
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚ e â”‚ 0 â”‚ 1 â”‚ 2 â”‚ 3 â”‚  e === e, dp[5][3] = dp[4][2] + 1 = 3
 * â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
 *
 * ç­”æ¡ˆï¼šdp[5][3] = 3
 */
function longestCommonSubsequence(text1: string, text2: string): number {
  const m = text1.length;
  const n = text2.length;

  // dp[i][j] = text1[0..i-1] å’Œ text2[0..j-1] çš„ LCS é•¿åº¦
  const dp: number[][] = Array.from({ length: m + 1 }, () =>
    Array(n + 1).fill(0)
  );

  for (let i = 1; i <= m; i++) {
    for (let j = 1; j <= n; j++) {
      if (text1[i - 1] === text2[j - 1]) {
        // å­—ç¬¦ç›¸ç­‰ï¼ŒLCS é•¿åº¦ +1
        dp[i][j] = dp[i - 1][j - 1] + 1;
      } else {
        // å­—ç¬¦ä¸ç­‰ï¼Œå–æœ€å¤§å€¼
        dp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]);
      }
    }
  }

  return dp[m][n];
}

// ============================================================
// è§£æ³•äºŒï¼šç©ºé—´ä¼˜åŒ–
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(mÃ—n) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)
function longestCommonSubsequence_optimized(text1: string, text2: string): number {
  const m = text1.length;
  const n = text2.length;

  // åªéœ€è¦ä¸¤è¡Œ
  let prev: number[] = Array(n + 1).fill(0);
  let curr: number[] = Array(n + 1).fill(0);

  for (let i = 1; i <= m; i++) {
    for (let j = 1; j <= n; j++) {
      if (text1[i - 1] === text2[j - 1]) {
        curr[j] = prev[j - 1] + 1;
      } else {
        curr[j] = Math.max(prev[j], curr[j - 1]);
      }
    }
    // äº¤æ¢
    [prev, curr] = [curr, prev];
  }

  return prev[n];
}

// ============================================================
// ðŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•     | æ—¶é—´    | ç©ºé—´    | ç‰¹ç‚¹          |
 * |----------|---------|---------|---------------|
 * | äºŒç»´DP   | O(mÃ—n)  | O(mÃ—n)  | å¥½ç†è§£        |
 * | ç©ºé—´ä¼˜åŒ– | O(mÃ—n)  | O(n)    | æŽ¨è          |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. çŠ¶æ€å®šä¹‰ï¼š
 *    - dp[i][j] æ˜¯å‰ i ä¸ªå’Œå‰ j ä¸ª
 *    - æ‰€ä»¥è®¿é—®å­—ç¬¦ç”¨ text1[i-1]
 *
 * 2. åˆå§‹åŒ–ï¼š
 *    - dp[0][j] = 0ï¼ˆç©ºå­—ç¬¦ä¸²çš„ LCS æ˜¯ 0ï¼‰
 *    - dp[i][0] = 0
 *
 * 3. å­—ç¬¦ç›¸ç­‰æ—¶ï¼š
 *    - dp[i][j] = dp[i-1][j-1] + 1
 *    - ä¸æ˜¯ max(dp[i-1][j], dp[i][j-1]) + 1
 */

// ============================================================
// ðŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - ç¼–è¾‘è·ç¦» â†’ å…è®¸å¢žåˆ æ”¹
 * - æœ€é•¿å›žæ–‡å­åºåˆ— â†’ å’Œè‡ªèº«é€†åºçš„ LCS
 * - æœ€é•¿é‡å¤å­æ•°ç»„ â†’ è¿žç»­çš„
 */

// ============================================================
// ðŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. Diff ç®—æ³•ï¼šè®¡ç®—æ–‡æœ¬å·®å¼‚
 * 2. ç‰ˆæœ¬æ¯”è¾ƒï¼šæ‰¾å…¬å…±ä»£ç 
 * 3. æ‹¼å†™æ£€æŸ¥ï¼šç›¸ä¼¼åº¦è®¡ç®—
 */

export { longestCommonSubsequence, longestCommonSubsequence_optimized };
export default longestCommonSubsequence;

