/**
 * 📝 题目：解码方法
 * 🔗 链接：https://leetcode.cn/problems/decode-ways/
 * 🏷️ 难度：Medium
 * 🏷️ 标签：字符串、动态规划
 *
 * 📋 题目描述：
 * 一条包含字母 A-Z 的消息通过以下映射进行了 编码：
 * 'A' -> "1"
 * 'B' -> "2"
 * ...
 * 'Z' -> "26"
 *
 * 给你一个只含数字的 非空 字符串 s，请计算并返回 解码 方法的 总数。
 *
 * 示例：
 * 输入：s = "12"
 * 输出：2
 * 解释："12" 可以解码为 "AB"（1 2）或者 "L"（12）
 *
 * 输入：s = "226"
 * 输出：3
 * 解释："226" 可以解码为 "BZ", "VF", "BBF"
 */

// ============================================================
// 💡 思路分析：这道题的解法是怎么想出来的？
// ============================================================
//
// 类似爬楼梯，每次可以解码 1 位或 2 位
//
// dp[i] = s[0..i-1] 的解码方法数
//
// 状态转移：
// - 如果 s[i-1] != '0'，可以单独解码：dp[i] += dp[i-1]
// - 如果 s[i-2..i-1] 在 [10, 26] 范围内，可以两位一起解码：dp[i] += dp[i-2]

// ============================================================
// 解法一：动态规划
// ============================================================
// ⏱️ 时间复杂度：O(n) | 空间复杂度：O(n)

/**
 * 📊 执行过程图解：
 *
 * s = "226"
 *
 * dp[0] = 1（空字符串有一种解码方式）
 * dp[1] = 1（"2" → "B"）
 * dp[2]: "2" 有效 → dp[1] = 1
 *        "22" 在 [10,26] → dp[0] = 1
 *        dp[2] = 2
 * dp[3]: "6" 有效 → dp[2] = 2
 *        "26" 在 [10,26] → dp[1] = 1
 *        dp[3] = 3
 *
 * 答案：3
 */
function numDecodings(s: string): number {
  const n = s.length;
  if (n === 0 || s[0] === '0') return 0;

  // dp[i] = s[0..i-1] 的解码方法数
  const dp: number[] = Array(n + 1).fill(0);
  dp[0] = 1; // 空字符串
  dp[1] = 1; // 第一个字符（已判断不为 '0'）

  for (let i = 2; i <= n; i++) {
    // 单独解码当前字符
    if (s[i - 1] !== '0') {
      dp[i] += dp[i - 1];
    }

    // 与前一个字符组合解码
    const twoDigit = parseInt(s.slice(i - 2, i));
    if (twoDigit >= 10 && twoDigit <= 26) {
      dp[i] += dp[i - 2];
    }
  }

  return dp[n];
}

// ============================================================
// 解法二：空间优化
// ============================================================
// ⏱️ 时间复杂度：O(n) | 空间复杂度：O(1)
function numDecodings_optimized(s: string): number {
  const n = s.length;
  if (n === 0 || s[0] === '0') return 0;

  let prev2 = 1; // dp[i-2]
  let prev1 = 1; // dp[i-1]

  for (let i = 2; i <= n; i++) {
    let curr = 0;

    // 单独解码
    if (s[i - 1] !== '0') {
      curr += prev1;
    }

    // 组合解码
    const twoDigit = parseInt(s.slice(i - 2, i));
    if (twoDigit >= 10 && twoDigit <= 26) {
      curr += prev2;
    }

    prev2 = prev1;
    prev1 = curr;
  }

  return prev1;
}

// ============================================================
// ⚠️ 易错点
// ============================================================
/**
 * 1. '0' 的处理：
 *    - '0' 不能单独解码
 *    - 只有 "10" 和 "20" 是有效的
 *
 * 2. 两位数的范围：
 *    - [10, 26] 才有效
 *    - "06" 不能解码为 "F"
 *
 * 3. 初始值：
 *    - dp[0] = 1（空字符串有一种方式）
 *    - 如果 s[0] === '0'，直接返回 0
 */

// ============================================================
// 🔗 举一反三：相似题目
// ============================================================
/**
 * - 解码方法 II → 有 '*' 通配符
 * - 爬楼梯 → 类似思路
 */

export { numDecodings, numDecodings_optimized };
export default numDecodings;

