/**
 * ğŸ“ é¢˜ç›®ï¼šç¼–è¾‘è·ç¦»
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/edit-distance/
 * ğŸ·ï¸ éš¾åº¦ï¼šHard
 * ğŸ·ï¸ æ ‡ç­¾ï¼šå­—ç¬¦ä¸²ã€åŠ¨æ€è§„åˆ’
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ ä¸¤ä¸ªå•è¯ word1 å’Œ word2ï¼Œè¯·è¿”å›å°† word1 è½¬æ¢æˆ word2 æ‰€ä½¿ç”¨çš„æœ€å°‘æ“ä½œæ•°ã€‚
 *
 * ä½ å¯ä»¥å¯¹ä¸€ä¸ªå•è¯è¿›è¡Œå¦‚ä¸‹ä¸‰ç§æ“ä½œï¼š
 * - æ’å…¥ä¸€ä¸ªå­—ç¬¦
 * - åˆ é™¤ä¸€ä¸ªå­—ç¬¦
 * - æ›¿æ¢ä¸€ä¸ªå­—ç¬¦
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šword1 = "horse", word2 = "ros"
 * è¾“å‡ºï¼š3
 * è§£é‡Šï¼š
 * horse -> rorse (å°† 'h' æ›¿æ¢ä¸º 'r')
 * rorse -> rose (åˆ é™¤ 'r')
 * rose -> ros (åˆ é™¤ 'e')
 */

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// ç»å…¸çš„äºŒç»´ DP é—®é¢˜ï¼
//
// dp[i][j] = word1[0..i-1] è½¬æ¢ä¸º word2[0..j-1] çš„æœ€å°‘æ“ä½œæ•°
//
// çŠ¶æ€è½¬ç§»ï¼š
// å¦‚æœ word1[i-1] === word2[j-1]ï¼š
//   dp[i][j] = dp[i-1][j-1]ï¼ˆä¸éœ€è¦æ“ä½œï¼‰
// å¦åˆ™ï¼š
//   dp[i][j] = 1 + min(
//     dp[i-1][j],    // åˆ é™¤ word1[i-1]
//     dp[i][j-1],    // æ’å…¥ word2[j-1]
//     dp[i-1][j-1]   // æ›¿æ¢
//   )

// ============================================================
// è§£æ³•ï¼šäºŒç»´ DP
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(mÃ—n) | ç©ºé—´å¤æ‚åº¦ï¼šO(mÃ—n)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * word1 = "horse", word2 = "ros"
 *
 * â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
 * â”‚   â”‚ ""â”‚ r â”‚ o â”‚ s â”‚
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚"" â”‚ 0 â”‚ 1 â”‚ 2 â”‚ 3 â”‚  åˆå§‹åŒ–
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚ h â”‚ 1 â”‚ 1 â”‚ 2 â”‚ 3 â”‚
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚ o â”‚ 2 â”‚ 2 â”‚ 1 â”‚ 2 â”‚  o === o, dp[2][2] = dp[1][1] = 1
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚ r â”‚ 3 â”‚ 2 â”‚ 2 â”‚ 2 â”‚  r === r, dp[3][1] = dp[2][0] = 2
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚ s â”‚ 4 â”‚ 3 â”‚ 3 â”‚ 2 â”‚  s === s, dp[5][3] = dp[4][2] = 2
 * â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
 * â”‚ e â”‚ 5 â”‚ 4 â”‚ 4 â”‚ 3 â”‚
 * â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
 *
 * ç­”æ¡ˆï¼šdp[5][3] = 3
 *
 * ğŸ”„ ä¸‰ç§æ“ä½œå›¾è§£ï¼š
 *
 * word1 = "ab", word2 = "a"
 *
 *  dp[i-1][j-1]  dp[i-1][j]
 *       â†˜           â†“
 *        dp[i][j] â† dp[i][j-1]
 *
 * dp[i-1][j-1] + 1: æ›¿æ¢ï¼ˆæŠŠ word1[i-1] æ›¿æ¢æˆ word2[j-1]ï¼‰
 * dp[i-1][j] + 1: åˆ é™¤ï¼ˆåˆ é™¤ word1[i-1]ï¼‰
 * dp[i][j-1] + 1: æ’å…¥ï¼ˆåœ¨ word1 æ’å…¥ word2[j-1]ï¼‰
 */
function minDistance(word1: string, word2: string): number {
  const m = word1.length;
  const n = word2.length;

  // dp[i][j] = word1[0..i-1] åˆ° word2[0..j-1] çš„ç¼–è¾‘è·ç¦»
  const dp: number[][] = Array.from({ length: m + 1 }, () =>
    Array(n + 1).fill(0)
  );

  // åˆå§‹åŒ–ï¼šç©ºå­—ç¬¦ä¸²çš„ç¼–è¾‘è·ç¦»
  for (let i = 0; i <= m; i++) dp[i][0] = i; // åˆ é™¤ i ä¸ªå­—ç¬¦
  for (let j = 0; j <= n; j++) dp[0][j] = j; // æ’å…¥ j ä¸ªå­—ç¬¦

  // å¡«è¡¨
  for (let i = 1; i <= m; i++) {
    for (let j = 1; j <= n; j++) {
      if (word1[i - 1] === word2[j - 1]) {
        // å­—ç¬¦ç›¸ç­‰ï¼Œä¸éœ€è¦æ“ä½œ
        dp[i][j] = dp[i - 1][j - 1];
      } else {
        // å–ä¸‰ç§æ“ä½œçš„æœ€å°å€¼
        dp[i][j] =
          1 +
          Math.min(
            dp[i - 1][j], // åˆ é™¤
            dp[i][j - 1], // æ’å…¥
            dp[i - 1][j - 1] // æ›¿æ¢
          );
      }
    }
  }

  return dp[m][n];
}

// ============================================================
// è§£æ³•äºŒï¼šç©ºé—´ä¼˜åŒ–
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(mÃ—n) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)
function minDistance_optimized(word1: string, word2: string): number {
  const m = word1.length;
  const n = word2.length;

  let prev: number[] = Array.from({ length: n + 1 }, (_, j) => j);
  let curr: number[] = Array(n + 1).fill(0);

  for (let i = 1; i <= m; i++) {
    curr[0] = i;
    for (let j = 1; j <= n; j++) {
      if (word1[i - 1] === word2[j - 1]) {
        curr[j] = prev[j - 1];
      } else {
        curr[j] = 1 + Math.min(prev[j], curr[j - 1], prev[j - 1]);
      }
    }
    [prev, curr] = [curr, prev];
  }

  return prev[n];
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•     | æ—¶é—´    | ç©ºé—´    | ç‰¹ç‚¹          |
 * |----------|---------|---------|---------------|
 * | äºŒç»´DP   | O(mÃ—n)  | O(mÃ—n)  | å¥½ç†è§£        |
 * | ç©ºé—´ä¼˜åŒ– | O(mÃ—n)  | O(n)    | æ¨è          |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. åˆå§‹åŒ–ï¼š
 *    - dp[i][0] = iï¼ˆword1 åˆ é™¤ i ä¸ªå­—ç¬¦å˜æˆç©ºä¸²ï¼‰
 *    - dp[0][j] = jï¼ˆç©ºä¸²æ’å…¥ j ä¸ªå­—ç¬¦å˜æˆ word2ï¼‰
 *
 * 2. ä¸‰ç§æ“ä½œçš„ç†è§£ï¼š
 *    - åˆ é™¤ï¼šdp[i-1][j] + 1
 *    - æ’å…¥ï¼šdp[i][j-1] + 1
 *    - æ›¿æ¢ï¼šdp[i-1][j-1] + 1
 *
 * 3. å­—ç¬¦ç›¸ç­‰æ—¶ä¸éœ€è¦æ“ä½œ
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - æœ€é•¿å…¬å…±å­åºåˆ— â†’ åªæœ‰ä¸æ“ä½œå’Œè·³è¿‡
 * - ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ â†’ åªæœ‰åˆ é™¤
 * - ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€å° ASCII åˆ é™¤å’Œ â†’ å¸¦æƒé‡åˆ é™¤
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. Diff ç®—æ³•ï¼šè®¡ç®—æ–‡æœ¬å·®å¼‚ï¼ŒGit diff
 * 2. æ‹¼å†™æ£€æŸ¥ï¼šæ‰¾æœ€ç›¸è¿‘çš„æ­£ç¡®å•è¯
 * 3. æœç´¢å»ºè®®ï¼šè¾“å…¥çº é”™
 * 4. DNA åºåˆ—æ¯”å¯¹ï¼šç”Ÿç‰©ä¿¡æ¯å­¦
 */

export { minDistance, minDistance_optimized };
export default minDistance;

