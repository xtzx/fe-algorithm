/**
 * ğŸ“ é¢˜ç›®ï¼šå­é›† II
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/subsets-ii/
 * ğŸ·ï¸ éš¾åº¦ï¼šMedium
 * ğŸ·ï¸ æ ‡ç­¾ï¼šæ•°ç»„ã€å›æº¯ã€ä½è¿ç®—
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œå…¶ä¸­å¯èƒ½åŒ…å«é‡å¤å…ƒç´ ï¼Œè¯·ä½ è¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰ã€‚
 * è§£é›† ä¸èƒ½ åŒ…å«é‡å¤çš„å­é›†ã€‚è¿”å›çš„è§£é›†ä¸­ï¼Œå­é›†å¯ä»¥æŒ‰ ä»»æ„é¡ºåº æ’åˆ—ã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šnums = [1,2,2]
 * è¾“å‡ºï¼š[[],[1],[1,2],[1,2,2],[2],[2,2]]
 */

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// ä¸"å­é›†"çš„åŒºåˆ«ï¼šæ•°ç»„ä¸­æœ‰é‡å¤å…ƒç´ 
//
// å»é‡ç­–ç•¥ï¼š
// 1. å…ˆæ’åºï¼Œè®©ç›¸åŒå…ƒç´ ç›¸é‚»
// 2. åŒä¸€å±‚ä¸­ï¼Œè·³è¿‡é‡å¤å…ƒç´ 
//
// å…³é”®åˆ¤æ–­ï¼š
// if (i > start && nums[i] === nums[i-1]) continue;

// ============================================================
// è§£æ³•ï¼šå›æº¯ + å»é‡
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n Ã— 2^n) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * nums = [1, 2, 2]ï¼ˆæ’åºåï¼‰
 *
 *                    []
 *          /         |         \
 *        [1]        [2]       [2] â† è·³è¿‡ï¼ˆåŒä¸€å±‚é‡å¤ï¼‰
 *       /   \        |
 *    [1,2] [1,2]â†   [2,2]
 *      |    è·³è¿‡
 *   [1,2,2]
 *
 * ç»“æœï¼š[[], [1], [1,2], [1,2,2], [2], [2,2]]
 */
function subsetsWithDup(nums: number[]): number[][] {
  const result: number[][] = [];
  const path: number[] = [];

  // 1. å…ˆæ’åºï¼Œè®©ç›¸åŒå…ƒç´ ç›¸é‚»
  nums.sort((a, b) => a - b);

  function backtrack(start: number) {
    result.push([...path]);

    for (let i = start; i < nums.length; i++) {
      // 2. åŒä¸€å±‚ä¸­ï¼Œè·³è¿‡é‡å¤å…ƒç´ 
      // i > start ä¿è¯æ˜¯åŒä¸€å±‚ï¼ˆä¸æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰
      if (i > start && nums[i] === nums[i - 1]) {
        continue;
      }

      path.push(nums[i]);
      backtrack(i + 1);
      path.pop();
    }
  }

  backtrack(0);
  return result;
}

// ============================================================
// ğŸ”‘ å»é‡åŸç†è¯¦è§£
// ============================================================

/**
 * ä¸ºä»€ä¹ˆæ˜¯ i > start è€Œä¸æ˜¯ i > 0ï¼Ÿ
 *
 * è€ƒè™‘ nums = [1, 2, 2]
 *
 * å½“éå†åˆ°ç¬¬äºŒä¸ª 2 æ—¶ï¼š
 *
 * æƒ…å†µ1ï¼šåœ¨ç¬¬ä¸€å±‚ï¼ˆstart=0, i=2ï¼‰
 *   - æ­¤æ—¶ i > startï¼Œè·³è¿‡
 *   - å› ä¸ºåœ¨åŒä¸€å±‚å·²ç»é€‰è¿‡ç¬¬ä¸€ä¸ª 2 äº†
 *
 * æƒ…å†µ2ï¼šåœ¨ [1] çš„ä¸‹ä¸€å±‚ï¼ˆstart=1, i=2ï¼‰
 *   - æ­¤æ—¶ i > startï¼Œè·³è¿‡
 *   - å› ä¸ºåœ¨åŒä¸€å±‚å·²ç»é€‰è¿‡ç¬¬ä¸€ä¸ª 2 äº†
 *
 * æƒ…å†µ3ï¼šåœ¨ [1,2] çš„ä¸‹ä¸€å±‚ï¼ˆstart=2, i=2ï¼‰
 *   - æ­¤æ—¶ i == startï¼Œä¸è·³è¿‡
 *   - è¿™æ˜¯è¿™ä¸€å±‚çš„ç¬¬ä¸€ä¸ªé€‰æ‹©ï¼Œå¯ä»¥é€‰
 *
 * æ€»ç»“ï¼š
 * - i > start è¯´æ˜ä¸æ˜¯è¿™ä¸€å±‚çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
 * - å¦‚æœä¸æ˜¯ç¬¬ä¸€ä¸ªï¼Œä¸”å’Œå‰ä¸€ä¸ªç›¸åŒï¼Œè¯´æ˜å·²ç»å¤„ç†è¿‡äº†
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. å¿…é¡»å…ˆæ’åºï¼š
 *    - å¦åˆ™æ— æ³•é€šè¿‡æ¯”è¾ƒç›¸é‚»å…ƒç´ å»é‡
 *
 * 2. å»é‡æ¡ä»¶ï¼š
 *    - i > startï¼ˆåŒä¸€å±‚ï¼‰
 *    - nums[i] === nums[i-1]ï¼ˆç›¸åŒå…ƒç´ ï¼‰
 *    - ä¸¤ä¸ªæ¡ä»¶ç¼ºä¸€ä¸å¯
 *
 * 3. ä¸æ’åˆ—å»é‡çš„åŒºåˆ«ï¼š
 *    - æ’åˆ—ï¼ši > 0 && nums[i] === nums[i-1] && !used[i-1]
 *    - å­é›†ï¼ši > start && nums[i] === nums[i-1]
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - å­é›† â†’ æ— é‡å¤å…ƒç´ 
 * - å…¨æ’åˆ— II â†’ æœ‰é‡å¤å…ƒç´ çš„æ’åˆ—
 * - ç»„åˆæ€»å’Œ II â†’ æœ‰é‡å¤å…ƒç´ çš„ç»„åˆ
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. æ ‡ç­¾å»é‡ï¼šç”¨æˆ·æ ‡ç­¾å¯èƒ½é‡å¤ï¼Œç”Ÿæˆä¸é‡å¤çš„æ ‡ç­¾ç»„åˆ
 * 2. å•†å“åˆ†ç±»ï¼šå•†å“å¯èƒ½å±äºå¤šä¸ªç›¸åŒåˆ†ç±»ï¼Œå»é‡å±•ç¤º
 */

export { subsetsWithDup };
export default subsetsWithDup;

