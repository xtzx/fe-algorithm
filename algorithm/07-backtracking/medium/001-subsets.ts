/**
 * ğŸ“ é¢˜ç›®ï¼šå­é›†
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/subsets/
 * ğŸ·ï¸ éš¾åº¦ï¼šMedium
 * ğŸ·ï¸ æ ‡ç­¾ï¼šæ•°ç»„ã€å›æº¯ã€ä½è¿ç®—
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œæ•°ç»„ä¸­çš„å…ƒç´  äº’ä¸ç›¸åŒã€‚è¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰ã€‚
 * è§£é›† ä¸èƒ½ åŒ…å«é‡å¤çš„å­é›†ã€‚ä½ å¯ä»¥æŒ‰ ä»»æ„é¡ºåº è¿”å›è§£é›†ã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šnums = [1,2,3]
 * è¾“å‡ºï¼š[[],[1],[2],[1,2],[3],[1,3],[2,3],[1,2,3]]
 */

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// å­é›†é—®é¢˜çš„æœ¬è´¨ï¼šå¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œéƒ½æœ‰"é€‰"æˆ–"ä¸é€‰"ä¸¤ç§æƒ…å†µ
//
// æ–¹æ³•ä¸€ï¼šå›æº¯
// - éå†å†³ç­–æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹
// - æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªæœ‰æ•ˆå­é›†
//
// æ–¹æ³•äºŒï¼šè¿­ä»£
// - æ¯é‡åˆ°ä¸€ä¸ªæ–°å…ƒç´ ï¼Œå°±åœ¨ç°æœ‰å­é›†çš„åŸºç¡€ä¸ŠåŠ å…¥è¿™ä¸ªå…ƒç´ 
//
// æ–¹æ³•ä¸‰ï¼šä½è¿ç®—
// - n ä¸ªå…ƒç´ æœ‰ 2^n ä¸ªå­é›†
// - ç”¨ 0 åˆ° 2^n-1 çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ¯ä¸ªå­é›†

// ============================================================
// è§£æ³•ä¸€ï¼šå›æº¯
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n Ã— 2^n) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * nums = [1, 2, 3]
 *
 *                    [] â† æ”¶é›†
 *          /         |         \
 *        [1] â†      [2] â†      [3] â† æ”¶é›†
 *       /   \        |
 *    [1,2]â† [1,3]â† [2,3] â† æ”¶é›†
 *      |
 *   [1,2,3] â† æ”¶é›†
 *
 * å…³é”®ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½è¦æ”¶é›†ï¼Œä¸åªæ˜¯å¶å­èŠ‚ç‚¹
 */
function subsets(nums: number[]): number[][] {
  const result: number[][] = [];
  const path: number[] = [];

  function backtrack(start: number) {
    // æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªæœ‰æ•ˆå­é›†
    result.push([...path]);

    // ä» start å¼€å§‹ï¼Œé¿å…é‡å¤
    for (let i = start; i < nums.length; i++) {
      path.push(nums[i]);
      backtrack(i + 1);
      path.pop();
    }
  }

  backtrack(0);
  return result;
}

// ============================================================
// è§£æ³•äºŒï¼šè¿­ä»£
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n Ã— 2^n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼ˆä¸ç®—ç»“æœï¼‰

/**
 * ğŸ“Š è¿­ä»£è¿‡ç¨‹å›¾è§£ï¼š
 *
 * åˆå§‹ï¼š[[]]
 *
 * é‡åˆ° 1ï¼š
 *   ç°æœ‰å­é›†ï¼š[[]]
 *   åŠ å…¥ 1ï¼š[[1]]
 *   åˆå¹¶ï¼š[[], [1]]
 *
 * é‡åˆ° 2ï¼š
 *   ç°æœ‰å­é›†ï¼š[[], [1]]
 *   åŠ å…¥ 2ï¼š[[2], [1,2]]
 *   åˆå¹¶ï¼š[[], [1], [2], [1,2]]
 *
 * é‡åˆ° 3ï¼š
 *   ç°æœ‰å­é›†ï¼š[[], [1], [2], [1,2]]
 *   åŠ å…¥ 3ï¼š[[3], [1,3], [2,3], [1,2,3]]
 *   åˆå¹¶ï¼š[[], [1], [2], [1,2], [3], [1,3], [2,3], [1,2,3]]
 */
function subsets_iterative(nums: number[]): number[][] {
  const result: number[][] = [[]];

  for (const num of nums) {
    const newSubsets = result.map((subset) => [...subset, num]);
    result.push(...newSubsets);
  }

  return result;
}

// ============================================================
// è§£æ³•ä¸‰ï¼šä½è¿ç®—
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n Ã— 2^n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼ˆä¸ç®—ç»“æœï¼‰

/**
 * ğŸ“Š ä½è¿ç®—å›¾è§£ï¼š
 *
 * nums = [1, 2, 3]ï¼Œå…± 2^3 = 8 ä¸ªå­é›†
 *
 * 000 â†’ []
 * 001 â†’ [1]
 * 010 â†’ [2]
 * 011 â†’ [1,2]
 * 100 â†’ [3]
 * 101 â†’ [1,3]
 * 110 â†’ [2,3]
 * 111 â†’ [1,2,3]
 */
function subsets_bit(nums: number[]): number[][] {
  const n = nums.length;
  const result: number[][] = [];

  // æšä¸¾ 0 åˆ° 2^n - 1
  for (let mask = 0; mask < 1 << n; mask++) {
    const subset: number[] = [];
    for (let i = 0; i < n; i++) {
      // æ£€æŸ¥ç¬¬ i ä½æ˜¯å¦ä¸º 1
      if ((mask >> i) & 1) {
        subset.push(nums[i]);
      }
    }
    result.push(subset);
  }

  return result;
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•   | æ—¶é—´       | ç©ºé—´  | ç‰¹ç‚¹                |
 * |--------|------------|-------|---------------------|
 * | å›æº¯   | O(n Ã— 2^n) | O(n)  | æ¨èï¼Œé€šç”¨æ¨¡æ¿       |
 * | è¿­ä»£   | O(n Ã— 2^n) | O(1)  | ç®€æ´ï¼Œç›´è§‚          |
 * | ä½è¿ç®— | O(n Ã— 2^n) | O(1)  | å·§å¦™ï¼Œéœ€è¦ç†è§£ä½è¿ç®— |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. æ”¶é›†æ—¶æœºï¼š
 *    - å­é›†é—®é¢˜ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½æ”¶é›†
 *    - ç»„åˆé—®é¢˜ï¼šåªæœ‰æ»¡è¶³æ¡ä»¶æ—¶æ”¶é›†
 *
 * 2. start å‚æ•°ï¼š
 *    - å¿…é¡»æœ‰ï¼Œå¦åˆ™ä¼šæœ‰é‡å¤
 *    - ä¸‹ä¸€æ¬¡ä» i+1 å¼€å§‹ï¼Œä¸æ˜¯ start+1
 *
 * 3. ç»“æœæ‹·è´ï¼š
 *    - result.push([...path])ï¼Œè¦æ‹·è´
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - å­é›† II â†’ æœ‰é‡å¤å…ƒç´ 
 * - ç»„åˆ â†’ é€‰ k ä¸ªå…ƒç´ 
 * - ç»„åˆæ€»å’Œ â†’ é€‰å…ƒç´ ä½¿å’Œä¸º target
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. ç­›é€‰æ¡ä»¶ï¼šç”¨æˆ·å¯ä»¥é€‰æ‹©ä»»æ„ç»„åˆçš„ç­›é€‰é¡¹
 * 2. æƒé™ç»„åˆï¼šè§’è‰²å¯ä»¥æ‹¥æœ‰çš„æƒé™å­é›†
 * 3. åŠŸèƒ½å¼€å…³ï¼šA/B æµ‹è¯•çš„åŠŸèƒ½ç»„åˆ
 */

export { subsets, subsets_iterative, subsets_bit };
export default subsets;

