/**
 * ğŸ“ é¢˜ç›®ï¼šå…¨æ’åˆ—
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/permutations/
 * ğŸ·ï¸ éš¾åº¦ï¼šMedium
 * ğŸ·ï¸ æ ‡ç­¾ï¼šæ•°ç»„ã€å›æº¯
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™å®šä¸€ä¸ªä¸å«é‡å¤æ•°å­—çš„æ•°ç»„ numsï¼Œè¿”å›å…¶ æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—ã€‚ä½ å¯ä»¥ æŒ‰ä»»æ„é¡ºåº è¿”å›ç­”æ¡ˆã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šnums = [1,2,3]
 * è¾“å‡ºï¼š[[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]
 */

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// æ’åˆ— vs ç»„åˆ/å­é›†ï¼š
// - ç»„åˆ/å­é›†ï¼š[1,2] å’Œ [2,1] æ˜¯åŒä¸€ä¸ª
// - æ’åˆ—ï¼š[1,2] å’Œ [2,1] æ˜¯ä¸åŒçš„
//
// å› æ­¤æ’åˆ—é—®é¢˜ï¼š
// - æ¯æ¬¡éƒ½ä»å¤´éå†æ‰€æœ‰å…ƒç´ 
// - ç”¨ used æ•°ç»„æ ‡è®°å·²é€‰å…ƒç´ ï¼Œé¿å…é‡å¤ä½¿ç”¨

// ============================================================
// è§£æ³•ï¼šå›æº¯
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n Ã— n!) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * nums = [1, 2, 3]
 *
 *                        []
 *             /          |          \
 *           [1]         [2]         [3]
 *          /   \       /   \       /   \
 *       [1,2] [1,3] [2,1] [2,3] [3,1] [3,2]
 *         |     |     |     |     |     |
 *      [1,2,3][1,3,2][2,1,3][2,3,1][3,1,2][3,2,1]
 *
 * å…± 3! = 6 ç§æ’åˆ—
 */
function permute(nums: number[]): number[][] {
  const result: number[][] = [];
  const path: number[] = [];
  const used: boolean[] = new Array(nums.length).fill(false);

  function backtrack() {
    // ç»“æŸæ¡ä»¶ï¼šé€‰æ»¡äº† n ä¸ªå…ƒç´ 
    if (path.length === nums.length) {
      result.push([...path]);
      return;
    }

    // æ¯æ¬¡éƒ½ä» 0 å¼€å§‹éå†
    for (let i = 0; i < nums.length; i++) {
      // è·³è¿‡å·²ä½¿ç”¨çš„å…ƒç´ 
      if (used[i]) continue;

      // åšé€‰æ‹©
      path.push(nums[i]);
      used[i] = true;

      // é€’å½’
      backtrack();

      // æ’¤é”€é€‰æ‹©
      path.pop();
      used[i] = false;
    }
  }

  backtrack();
  return result;
}

// ============================================================
// è§£æ³•äºŒï¼šäº¤æ¢æ³•
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n Ã— n!) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)

/**
 * æ€è·¯ï¼šé€šè¿‡äº¤æ¢å…ƒç´ ä½ç½®æ¥ç”Ÿæˆæ’åˆ—
 * - å›ºå®šç¬¬ä¸€ä¸ªä½ç½®ï¼Œé€’å½’å¤„ç†å‰©ä½™ä½ç½®
 * - æ¯ä¸ªä½ç½®éƒ½å¯ä»¥å’Œåé¢çš„ä½ç½®äº¤æ¢
 */
function permute_swap(nums: number[]): number[][] {
  const result: number[][] = [];

  function backtrack(start: number) {
    if (start === nums.length) {
      result.push([...nums]);
      return;
    }

    for (let i = start; i < nums.length; i++) {
      // å°† nums[i] äº¤æ¢åˆ° start ä½ç½®
      [nums[start], nums[i]] = [nums[i], nums[start]];

      backtrack(start + 1);

      // æ¢å¤
      [nums[start], nums[i]] = [nums[i], nums[start]];
    }
  }

  backtrack(0);
  return result;
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•       | æ—¶é—´       | ç©ºé—´  | ç‰¹ç‚¹                    |
 * |------------|------------|-------|-------------------------|
 * | used æ•°ç»„  | O(n Ã— n!)  | O(n)  | æ¨èï¼Œå®¹æ˜“ç†è§£å’Œæ‰©å±•     |
 * | äº¤æ¢æ³•     | O(n Ã— n!)  | O(n)  | ç©ºé—´æ›´ä¼˜ï¼ˆä¸éœ€è¦ usedï¼‰  |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. ä¸ç»„åˆçš„åŒºåˆ«ï¼š
 *    - ç»„åˆç”¨ startï¼Œæ’åˆ—ç”¨ used
 *
 * 2. used çš„ç»´æŠ¤ï¼š
 *    - åšé€‰æ‹©æ—¶ used[i] = true
 *    - æ’¤é”€æ—¶ used[i] = false
 *    - ä¸¤è€…å¿…é¡»é…å¯¹
 *
 * 3. äº¤æ¢æ³•çš„æ¢å¤ï¼š
 *    - äº¤æ¢åé€’å½’
 *    - é€’å½’è¿”å›åè¦äº¤æ¢å›æ¥
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - å…¨æ’åˆ— II â†’ æœ‰é‡å¤å…ƒç´ 
 * - å­—ç¬¦ä¸²çš„æ’åˆ— â†’ å­—ç¬¦ç‰ˆæœ¬
 * - ä¸‹ä¸€ä¸ªæ’åˆ— â†’ æ‰¾ä¸‹ä¸€ä¸ªå­—å…¸åºæ›´å¤§çš„æ’åˆ—
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. æ’åºæ–¹æ¡ˆï¼šå¤šä¸ªç­›é€‰æ¡ä»¶çš„æ’åºç»„åˆ
 * 2. é¡µé¢å¸ƒå±€ï¼šç»„ä»¶çš„ä¸åŒæ’åˆ—æ–¹å¼
 * 3. å¯†ç ç”Ÿæˆï¼šæŒ‡å®šå­—ç¬¦çš„æ‰€æœ‰æ’åˆ—
 */

export { permute, permute_swap };
export default permute;

