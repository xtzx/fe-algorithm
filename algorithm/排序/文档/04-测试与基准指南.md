# æµ‹è¯•ä¸åŸºå‡†æŒ‡å—

> å¦‚ä½•éªŒè¯æ’åºç®—æ³•çš„æ­£ç¡®æ€§ï¼Œå¦‚ä½•è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•ã€‚

---

## ğŸ“š ç›®å½•

1. [æ­£ç¡®æ€§æµ‹è¯•](#1-æ­£ç¡®æ€§æµ‹è¯•)
2. [ç¨³å®šæ€§æµ‹è¯•](#2-ç¨³å®šæ€§æµ‹è¯•)
3. [è¾¹ç•Œæƒ…å†µè¦†ç›–](#3-è¾¹ç•Œæƒ…å†µè¦†ç›–)
4. [æ€§èƒ½åŸºå‡†æµ‹è¯•](#4-æ€§èƒ½åŸºå‡†æµ‹è¯•)
5. [æµ‹è¯•ç”¨ä¾‹è®¾è®¡](#5-æµ‹è¯•ç”¨ä¾‹è®¾è®¡)
6. [å¦‚ä½•ä½¿ç”¨åŸºå‡†æµ‹è¯•æ¡†æ¶](#6-å¦‚ä½•ä½¿ç”¨åŸºå‡†æµ‹è¯•æ¡†æ¶)

---

## 1. æ­£ç¡®æ€§æµ‹è¯•

æ’åºç®—æ³•çš„æ­£ç¡®æ€§éœ€è¦éªŒè¯ä¸¤ç‚¹ï¼š

### 1.1 æœ‰åºæ€§ (Sortedness)

æ’åºåçš„æ•°ç»„å¿…é¡»æ»¡è¶³ï¼š`arr[i] <= arr[i+1]`ï¼ˆå‡åºï¼‰

```typescript
function isSorted<T>(arr: T[], cmp: (a: T, b: T) => number): boolean {
  for (let i = 1; i < arr.length; i++) {
    if (cmp(arr[i - 1], arr[i]) > 0) return false;
  }
  return true;
}
```

### 1.2 ç½®æ¢æ€§ (Permutation)

æ’åºåçš„æ•°ç»„å¿…é¡»æ˜¯åŸæ•°ç»„çš„é‡æ’ï¼Œä¸èƒ½ä¸¢å¤±æˆ–æ–°å¢å…ƒç´ ã€‚

```typescript
function isPermutation<T>(original: T[], sorted: T[]): boolean {
  if (original.length !== sorted.length) return false;

  const countMap = new Map<T, number>();

  for (const item of original) {
    countMap.set(item, (countMap.get(item) || 0) + 1);
  }

  for (const item of sorted) {
    const count = countMap.get(item);
    if (!count) return false;
    countMap.set(item, count - 1);
  }

  return true;
}
```

### Mermaidï¼šæ­£ç¡®æ€§æ£€éªŒæµç¨‹

```mermaid
flowchart TD
    A[æ’åºåæ•°ç»„] --> B{æœ‰åºæ€§æ£€éªŒ}
    B -->|é€šè¿‡| C{ç½®æ¢æ€§æ£€éªŒ}
    B -->|å¤±è´¥| D[âŒ æ’åºé”™è¯¯]
    C -->|é€šè¿‡| E[âœ… æ­£ç¡®]
    C -->|å¤±è´¥| F[âŒ å…ƒç´ ä¸¢å¤±/é‡å¤]
```

---

## 2. ç¨³å®šæ€§æµ‹è¯•

å¯¹äºå£°ç§°ç¨³å®šçš„æ’åºç®—æ³•ï¼Œè¿˜éœ€è¦é¢å¤–éªŒè¯ã€‚

### 2.1 ç¨³å®šæ€§å®šä¹‰

ç›¸ç­‰å…ƒç´ åœ¨æ’åºåä¿æŒåŸå§‹ç›¸å¯¹é¡ºåºã€‚

### 2.2 æµ‹è¯•æ–¹æ³•

```typescript
interface IndexedItem<T> {
  value: T;
  originalIndex: number;
}

function isStable<T>(
  original: T[],
  sorted: T[],
  cmp: (a: T, b: T) => number
): boolean {
  // ç»™åŸå§‹æ•°ç»„é™„åŠ ç´¢å¼•
  const indexed: IndexedItem<T>[] = original.map((value, index) => ({
    value,
    originalIndex: index,
  }));

  // æ‰¾å‡º sorted ä¸­æ¯ä¸ªå…ƒç´ å¯¹åº”çš„åŸå§‹ç´¢å¼•
  const sortedIndexes: number[] = [];
  const used = new Set<number>();

  for (const item of sorted) {
    for (const { value, originalIndex } of indexed) {
      if (!used.has(originalIndex) && cmp(value, item) === 0) {
        sortedIndexes.push(originalIndex);
        used.add(originalIndex);
        break;
      }
    }
  }

  // æ£€æŸ¥ç›¸ç­‰å…ƒç´ çš„åŸå§‹ç´¢å¼•æ˜¯å¦é€’å¢
  for (let i = 1; i < sorted.length; i++) {
    if (cmp(sorted[i - 1], sorted[i]) === 0) {
      if (sortedIndexes[i - 1] > sortedIndexes[i]) {
        return false;
      }
    }
  }

  return true;
}
```

### 2.3 æµ‹è¯•ç”¨ä¾‹ç¤ºä¾‹

```typescript
// æµ‹è¯•ç¨³å®šæ€§çš„å…¸å‹ç”¨ä¾‹ï¼šå¤šä¸ªç›¸ç­‰å…ƒç´ 
const testCase = [
  { key: 1, id: 'a' },
  { key: 2, id: 'b' },
  { key: 1, id: 'c' },
  { key: 2, id: 'd' },
  { key: 1, id: 'e' },
];

// æŒ‰ key æ’åºåï¼Œç›¸åŒ key çš„å…ƒç´ åº”ä¿æŒ a < c < e, b < d
```

---

## 3. è¾¹ç•Œæƒ…å†µè¦†ç›–

### 3.1 å¿…é¡»è¦†ç›–çš„è¾¹ç•Œ

| ç”¨ä¾‹ | æè¿° | é¢„æœŸè¡Œä¸º |
|------|------|----------|
| ç©ºæ•°ç»„ | `[]` | è¿”å› `[]` |
| å•å…ƒç´  | `[1]` | è¿”å› `[1]` |
| ä¸¤å…ƒç´ ï¼ˆå·²åºï¼‰ | `[1, 2]` | è¿”å› `[1, 2]` |
| ä¸¤å…ƒç´ ï¼ˆé€†åºï¼‰ | `[2, 1]` | è¿”å› `[1, 2]` |
| å…¨ç›¸åŒ | `[5, 5, 5, 5]` | è¿”å› `[5, 5, 5, 5]` |
| å·²æ’åº | `[1, 2, 3, 4, 5]` | è¿”å›åŸåº |
| å®Œå…¨é€†åº | `[5, 4, 3, 2, 1]` | è¿”å› `[1, 2, 3, 4, 5]` |
| å«è´Ÿæ•° | `[-3, 1, -1, 2, 0]` | æ­£ç¡®æ’åº |
| å«æµ®ç‚¹ | `[1.5, 1.1, 1.9]` | æ­£ç¡®æ’åº |

### 3.2 æ•°æ®åˆ†å¸ƒæµ‹è¯•

| åˆ†å¸ƒç±»å‹ | æè¿° | ç”¨é€” |
|----------|------|------|
| éšæœº | å®Œå…¨éšæœº | å¹³å‡æƒ…å†µ |
| è¿‘ä¹æœ‰åº | 90%+ å·²æ’åº | æµ‹è¯•æœ€å¥½æƒ…å†µ |
| é€†åº | å®Œå…¨é€†åº | æµ‹è¯•æœ€åæƒ…å†µ |
| é‡å¤å¤š | å¤§é‡é‡å¤å€¼ | æµ‹è¯•ç›¸ç­‰å¤„ç† |
| é”¯é½¿å½¢ | å‡é™äº¤æ›¿ | æµ‹è¯•è¾¹ç•Œå¤„ç† |

---

## 4. æ€§èƒ½åŸºå‡†æµ‹è¯•

### 4.1 æµ‹è¯•æŒ‡æ ‡

| æŒ‡æ ‡ | å•ä½ | è¯´æ˜ |
|------|------|------|
| æ‰§è¡Œæ—¶é—´ | ms | æ’åºè€—æ—¶ |
| æ¯”è¾ƒæ¬¡æ•° | æ¬¡ | è°ƒç”¨ comparator æ¬¡æ•° |
| äº¤æ¢æ¬¡æ•° | æ¬¡ | å…ƒç´ äº¤æ¢æ¬¡æ•° |
| å†…å­˜å³°å€¼ | MB | é¢å¤–å†…å­˜ä½¿ç”¨ï¼ˆå¦‚æœå¯æµ‹ï¼‰ |

### 4.2 æµ‹è¯•è§„æ¨¡

```typescript
const SCALES = [
  100,      // å°è§„æ¨¡
  1_000,    // ä¸­å°è§„æ¨¡
  10_000,   // ä¸­ç­‰è§„æ¨¡
  100_000,  // å¤§è§„æ¨¡
  1_000_000 // è¶…å¤§è§„æ¨¡ï¼ˆO(nÂ²) ç®—æ³•æ…ç”¨ï¼‰
];
```

### 4.3 é¢„çƒ­ä¸å¤šæ¬¡è¿è¡Œ

```typescript
function benchmark(fn: () => void, runs: number = 10): number {
  // é¢„çƒ­ï¼šè®© JIT ä¼˜åŒ–
  for (let i = 0; i < 3; i++) fn();

  const times: number[] = [];
  for (let i = 0; i < runs; i++) {
    const start = performance.now();
    fn();
    times.push(performance.now() - start);
  }

  // å»æ‰æœ€é«˜æœ€ä½ï¼Œå–å¹³å‡
  times.sort((a, b) => a - b);
  const trimmed = times.slice(1, -1);
  return trimmed.reduce((a, b) => a + b, 0) / trimmed.length;
}
```

### Mermaidï¼šåŸºå‡†æµ‹è¯•æµç¨‹

```mermaid
flowchart TD
    A[ç”Ÿæˆæµ‹è¯•æ•°æ®] --> B[é¢„çƒ­è¿è¡Œ 3 æ¬¡]
    B --> C[æ­£å¼è¿è¡Œ N æ¬¡]
    C --> D[è®°å½•æ¯æ¬¡è€—æ—¶]
    D --> E[å»æ‰æœ€é«˜æœ€ä½]
    E --> F[è®¡ç®—å¹³å‡å€¼]
    F --> G[è¾“å‡ºæŠ¥å‘Š]
```

---

## 5. æµ‹è¯•ç”¨ä¾‹è®¾è®¡

### 5.1 æ•°æ®ç”Ÿæˆå™¨ç±»å‹

```typescript
// è§ ç®—æ³•åŒ…/å…¬å…±åº“/src/æ•°æ®ç”Ÿæˆå™¨.ts

type DataDistribution =
  | 'random'        // å®Œå…¨éšæœº
  | 'sorted'        // å·²æ’åº
  | 'reversed'      // å®Œå…¨é€†åº
  | 'nearlySorted'  // è¿‘ä¹æœ‰åº
  | 'fewUnique'     // å°‘é‡å”¯ä¸€å€¼ï¼ˆé‡å¤å¤šï¼‰
  | 'sawtooth';     // é”¯é½¿å½¢
```

### 5.2 è¡¨æ ¼æ•°æ®æµ‹è¯•

```typescript
interface TableRow {
  id: number;
  name: string;
  score: number;
  timestamp: number;
}

// æµ‹è¯•åœºæ™¯ï¼šæŒ‰ score é™åºï¼ŒåŒåˆ†æŒ‰ name å‡åº
const tableData: TableRow[] = generateTableData(1000);
```

### 5.3 æœç´¢ç»“æœæµ‹è¯•

```typescript
interface SearchResult {
  id: string;
  title: string;
  relevance: number;
  publishTime: Date;
}

// æµ‹è¯•åœºæ™¯ï¼šæŒ‰ relevance é™åºï¼ŒåŒåˆ†æŒ‰ publishTime é™åº
const searchResults: SearchResult[] = generateSearchResults(100);
```

---

## 6. å¦‚ä½•ä½¿ç”¨åŸºå‡†æµ‹è¯•æ¡†æ¶

### 6.1 è¿è¡ŒåŸºå‡†æµ‹è¯•

```bash
# ä½¿ç”¨ ts-node è¿è¡Œ
npx ts-node åŸºå‡†æµ‹è¯•/src/è¿è¡ŒåŸºå‡†.ts

# æˆ–ç¼–è¯‘åè¿è¡Œ
npx tsc && node åŸºå‡†æµ‹è¯•/dist/è¿è¡ŒåŸºå‡†.js
```

### 6.2 åŸºå‡†æµ‹è¯•æŠ¥å‘Šç¤ºä¾‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç®—æ³•         â”‚ n=1000 â”‚ n=10000 â”‚ n=100000 â”‚ ç¨³å®šæ€§   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å†’æ³¡æ’åº     â”‚ 5ms    â”‚ 450ms   â”‚ è¶…æ—¶     â”‚ âœ…       â”‚
â”‚ é€‰æ‹©æ’åº     â”‚ 3ms    â”‚ 280ms   â”‚ è¶…æ—¶     â”‚ âŒ       â”‚
â”‚ æ’å…¥æ’åº     â”‚ 2ms    â”‚ 180ms   â”‚ è¶…æ—¶     â”‚ âœ…       â”‚
â”‚ å¸Œå°”æ’åº     â”‚ 1ms    â”‚ 15ms    â”‚ 250ms    â”‚ âŒ       â”‚
â”‚ å½’å¹¶æ’åº     â”‚ 1ms    â”‚ 12ms    â”‚ 150ms    â”‚ âœ…       â”‚
â”‚ å¿«é€Ÿæ’åº     â”‚ 0.5ms  â”‚ 8ms     â”‚ 100ms    â”‚ âŒ       â”‚
â”‚ å †æ’åº       â”‚ 1ms    â”‚ 15ms    â”‚ 180ms    â”‚ âŒ       â”‚
â”‚ TimSort      â”‚ 0.8ms  â”‚ 10ms    â”‚ 120ms    â”‚ âœ…       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 æ·»åŠ æ–°ç®—æ³•åˆ°åŸºå‡†

```typescript
// åœ¨ åŸºå‡†æµ‹è¯•/src/è¿è¡ŒåŸºå‡†.ts ä¸­æ³¨å†Œ

import { sort as bubbleSort, meta as bubbleMeta } from '../../ç®—æ³•åŒ…/å†’æ³¡æ’åº/src';

const algorithms = [
  { name: bubbleMeta.name, sort: bubbleSort, meta: bubbleMeta },
  // ... å…¶ä»–ç®—æ³•
];
```

---

## ğŸ“‹ æµ‹è¯•æ¸…å•

åœ¨å‘å¸ƒæ’åºç®—æ³•å‰ï¼Œç¡®ä¿é€šè¿‡ä»¥ä¸‹æµ‹è¯•ï¼š

- [ ] ç©ºæ•°ç»„
- [ ] å•å…ƒç´ 
- [ ] ä¸¤å…ƒç´ ï¼ˆå·²åº/é€†åºï¼‰
- [ ] å…¨ç›¸åŒå…ƒç´ 
- [ ] å·²æ’åºæ•°æ®
- [ ] å®Œå…¨é€†åºæ•°æ®
- [ ] éšæœºæ•°æ®ï¼ˆå¤šç§è§„æ¨¡ï¼‰
- [ ] é‡å¤å¤šçš„æ•°æ®
- [ ] ç¨³å®šæ€§æµ‹è¯•ï¼ˆå¦‚å£°ç§°ç¨³å®šï¼‰
- [ ] æ€§èƒ½åŸºå‡†ï¼ˆä¸é¢„æœŸå¤æ‚åº¦å»åˆï¼‰

