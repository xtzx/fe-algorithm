/**
 * ðŸ“ é¢˜ç›®ï¼šè½®è½¬æ•°ç»„
 * ðŸ”— é“¾æŽ¥ï¼šhttps://leetcode.cn/problems/rotate-array/
 * ðŸ·ï¸ éš¾åº¦ï¼šEasy
 * ðŸ·ï¸ æ ‡ç­¾ï¼šæ•°ç»„ã€æ•°å­¦ã€åŒæŒ‡é’ˆ
 *
 * ðŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œå°†æ•°ç»„ä¸­çš„å…ƒç´ å‘å³è½®è½¬ k ä¸ªä½ç½®ï¼Œå…¶ä¸­ k æ˜¯éžè´Ÿæ•°ã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šnums = [1,2,3,4,5,6,7], k = 3
 * è¾“å‡ºï¼š[5,6,7,1,2,3,4]
 *
 * è§£é‡Šï¼š
 * å‘å³è½®è½¬ 1 æ­¥: [7,1,2,3,4,5,6]
 * å‘å³è½®è½¬ 2 æ­¥: [6,7,1,2,3,4,5]
 * å‘å³è½®è½¬ 3 æ­¥: [5,6,7,1,2,3,4]
 */

// ============================================================
// ðŸ’¡ æ€è·¯åˆ†æž
// ============================================================
//
// æ–¹æ³•ä¸€ï¼šä½¿ç”¨é¢å¤–æ•°ç»„ - O(n) æ—¶é—´ï¼ŒO(n) ç©ºé—´
// æ–¹æ³•äºŒï¼šä¸‰æ¬¡åè½¬ - O(n) æ—¶é—´ï¼ŒO(1) ç©ºé—´ â† æŽ¨è
// æ–¹æ³•ä¸‰ï¼šçŽ¯çŠ¶æ›¿æ¢ - O(n) æ—¶é—´ï¼ŒO(1) ç©ºé—´
//
// å…³é”®æ´žå¯Ÿï¼š
// åŽŸæ•°ç»„ï¼š    [1, 2, 3, 4, 5, 6, 7], k = 3
// ç›®æ ‡æ•°ç»„ï¼š  [5, 6, 7, 1, 2, 3, 4]
//
// è§‚å¯Ÿï¼šåŽ k ä¸ªå…ƒç´ ç§»åˆ°äº†å‰é¢ï¼Œå‰ n-k ä¸ªå…ƒç´ ç§»åˆ°äº†åŽé¢
//
// ä¸‰æ¬¡åè½¬çš„é­”æ³•ï¼š
// 1. å…¨éƒ¨åè½¬ï¼š[7, 6, 5, 4, 3, 2, 1]
// 2. åè½¬å‰ k ä¸ªï¼š[5, 6, 7, 4, 3, 2, 1]
// 3. åè½¬åŽ n-k ä¸ªï¼š[5, 6, 7, 1, 2, 3, 4] âœ“

// ============================================================
// è§£æ³•ä¸€ï¼šé¢å¤–æ•°ç»„
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)
function rotate_v1(nums: number[], k: number): void {
  const n = nums.length;
  k = k % n; // å¤„ç† k >= n çš„æƒ…å†µ

  const result = new Array(n);
  for (let i = 0; i < n; i++) {
    result[(i + k) % n] = nums[i];
  }

  for (let i = 0; i < n; i++) {
    nums[i] = result[i];
  }
}

// ============================================================
// è§£æ³•äºŒï¼šä¸‰æ¬¡åè½¬ï¼ˆæŽ¨èï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)

/**
 * ðŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * nums = [1, 2, 3, 4, 5, 6, 7], k = 3
 *
 * Step 1: å…¨éƒ¨åè½¬
 *         [1, 2, 3, 4, 5, 6, 7]
 *                  â†“
 *         [7, 6, 5, 4, 3, 2, 1]
 *
 * Step 2: åè½¬å‰ k=3 ä¸ª
 *         [7, 6, 5 | 4, 3, 2, 1]
 *              â†“
 *         [5, 6, 7 | 4, 3, 2, 1]
 *
 * Step 3: åè½¬åŽ n-k=4 ä¸ª
 *         [5, 6, 7 | 4, 3, 2, 1]
 *                        â†“
 *         [5, 6, 7 | 1, 2, 3, 4]
 *
 * ç»“æžœ: [5, 6, 7, 1, 2, 3, 4] âœ“
 */
function rotate_v2(nums: number[], k: number): void {
  const n = nums.length;
  k = k % n; // å¤„ç† k >= n çš„æƒ…å†µ

  if (k === 0) return;

  // è¾…åŠ©å‡½æ•°ï¼šåè½¬æ•°ç»„çš„ [start, end] åŒºé—´
  const reverse = (start: number, end: number): void => {
    while (start < end) {
      [nums[start], nums[end]] = [nums[end], nums[start]];
      start++;
      end--;
    }
  };

  // ä¸‰æ¬¡åè½¬
  reverse(0, n - 1); // å…¨éƒ¨åè½¬
  reverse(0, k - 1); // åè½¬å‰ k ä¸ª
  reverse(k, n - 1); // åè½¬åŽ n-k ä¸ª
}

// ============================================================
// è§£æ³•ä¸‰ï¼šçŽ¯çŠ¶æ›¿æ¢
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)
// ðŸ“ æ€è·¯ï¼šæ¯ä¸ªå…ƒç´ æœ€ç»ˆä¼šåˆ°è¾¾ (i + k) % n çš„ä½ç½®

/**
 * ðŸ“Š çŽ¯çŠ¶æ›¿æ¢è¿‡ç¨‹å›¾è§£ï¼š
 *
 * nums = [1, 2, 3, 4, 5, 6], k = 2
 *
 * ä»Žä½ç½® 0 å¼€å§‹ï¼š
 * 0 â†’ 2 â†’ 4 â†’ 0 (å½¢æˆä¸€ä¸ªçŽ¯)
 *
 * ä»Žä½ç½® 1 å¼€å§‹ï¼š
 * 1 â†’ 3 â†’ 5 â†’ 1 (å½¢æˆå¦ä¸€ä¸ªçŽ¯)
 *
 * éœ€è¦éåŽ† gcd(n, k) ä¸ªçŽ¯
 */
function rotate_v3(nums: number[], k: number): void {
  const n = nums.length;
  k = k % n;

  if (k === 0) return;

  // æ±‚æœ€å¤§å…¬çº¦æ•°
  const gcd = (a: number, b: number): number => (b === 0 ? a : gcd(b, a % b));

  const cycles = gcd(n, k);

  for (let start = 0; start < cycles; start++) {
    let current = start;
    let prev = nums[start];

    do {
      const next = (current + k) % n;
      [nums[next], prev] = [prev, nums[next]];
      current = next;
    } while (current !== start);
  }
}

// ============================================================
// ðŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•      | æ—¶é—´  | ç©ºé—´  | ç‰¹ç‚¹                     |
 * |----------|-------|-------|--------------------------|
 * | é¢å¤–æ•°ç»„  | O(n)  | O(n)  | æœ€ç›´è§‚ï¼Œä½†ç©ºé—´ä¸æ˜¯ O(1)   |
 * | ä¸‰æ¬¡åè½¬  | O(n)  | O(1)  | æŽ¨èï¼Œä»£ç ç®€æ´            |
 * | çŽ¯çŠ¶æ›¿æ¢  | O(n)  | O(1)  | è¾ƒå¤æ‚ï¼Œä½†å¾ˆå·§å¦™          |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. k å¯èƒ½å¤§äºŽ nï¼š
 *    k = k % n; // å¿…é¡»å…ˆå–æ¨¡ï¼
 *
 * 2. k = 0 æ—¶ï¼š
 *    å¯ä»¥ç›´æŽ¥è¿”å›žï¼Œä¸éœ€è¦æ“ä½œ
 *
 * 3. ä¸‰æ¬¡åè½¬çš„è¾¹ç•Œï¼š
 *    - å…¨éƒ¨åè½¬ï¼š[0, n-1]
 *    - å‰ k ä¸ªï¼š[0, k-1]
 *    - åŽ n-k ä¸ªï¼š[k, n-1]
 *
 * 4. çŽ¯çŠ¶æ›¿æ¢ï¼š
 *    - éœ€è¦çŸ¥é“ä½•æ—¶ä¸€ä¸ªçŽ¯ç»“æŸï¼ˆå›žåˆ°èµ·ç‚¹ï¼‰
 *    - éœ€è¦çŸ¥é“æœ‰å¤šå°‘ä¸ªç‹¬ç«‹çš„çŽ¯ï¼ˆgcd(n, k) ä¸ªï¼‰
 */

// ============================================================
// ðŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - åè½¬å­—ç¬¦ä¸²ä¸­çš„å•è¯ â†’ ç±»ä¼¼ä¸‰æ¬¡åè½¬
 * - æ—‹è½¬å›¾åƒ â†’ çŸ©é˜µçš„åŽŸåœ°æ—‹è½¬
 * - æ—‹è½¬é“¾è¡¨ â†’ æ‰¾åˆ°å€’æ•°ç¬¬ k ä¸ªèŠ‚ç‚¹
 */

// ============================================================
// ðŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. è½®æ’­å›¾ï¼šå›¾ç‰‡æ•°ç»„çš„å¾ªçŽ¯è½®è½¬
 * 2. å¾ªçŽ¯é˜Ÿåˆ—ï¼šå®žçŽ°å›ºå®šå¤§å°çš„å¾ªçŽ¯ç¼“å†²åŒº
 * 3. æ—¥åŽ†è§†å›¾ï¼šå‘¨è§†å›¾çš„æ—¥æœŸè½®è½¬æ˜¾ç¤º
 */

export { rotate_v1, rotate_v2, rotate_v3 };
export default rotate_v2;

