/**
 * ğŸ“ é¢˜ç›®ï¼šæœ€é•¿å›æ–‡å­ä¸²
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/longest-palindromic-substring/
 * ğŸ·ï¸ éš¾åº¦ï¼šMedium
 * ğŸ·ï¸ æ ‡ç­¾ï¼šå­—ç¬¦ä¸²ã€åŠ¨æ€è§„åˆ’
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œæ‰¾åˆ° s ä¸­æœ€é•¿çš„å›æ–‡å­ä¸²ã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šs = "babad"
 * è¾“å‡ºï¼š"bab" æˆ– "aba"
 *
 * è¾“å…¥ï¼šs = "cbbd"
 * è¾“å‡ºï¼š"bb"
 */

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// å›æ–‡ä¸²çš„ç‰¹ç‚¹ï¼šå¯¹ç§°
//
// 1. æš´åŠ›æ€è·¯ï¼šæšä¸¾æ‰€æœ‰å­ä¸²ï¼Œåˆ¤æ–­æ˜¯å¦å›æ–‡ â†’ O(nÂ³)
//
// 2. ä¸­å¿ƒæ‰©å±•æ³•ï¼ˆæ¨èï¼‰ï¼š
//    - å›æ–‡ä¸²ä¸€å®šæœ‰ä¸€ä¸ªã€Œä¸­å¿ƒã€
//    - ä»ä¸­å¿ƒå‘ä¸¤è¾¹æ‰©å±•ï¼Œæ‰¾åˆ°æœ€é•¿å›æ–‡
//    - ä¸­å¿ƒå¯èƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼ˆå¥‡æ•°é•¿åº¦ï¼‰æˆ–ä¸¤ä¸ªå­—ç¬¦ï¼ˆå¶æ•°é•¿åº¦ï¼‰
//    - æ—¶é—´ O(nÂ²)ï¼Œç©ºé—´ O(1)
//
// 3. åŠ¨æ€è§„åˆ’ï¼š
//    - dp[i][j] = s[i..j] æ˜¯å¦æ˜¯å›æ–‡
//    - æ—¶é—´ O(nÂ²)ï¼Œç©ºé—´ O(nÂ²)
//
// 4. Manacher ç®—æ³•ï¼š
//    - æ—¶é—´ O(n)ï¼Œä½†å®ç°å¤æ‚ï¼Œé¢è¯•ä¸å¸¸è€ƒ

// ============================================================
// è§£æ³•ä¸€ï¼šä¸­å¿ƒæ‰©å±•æ³•ï¼ˆæ¨èï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ²) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)

/**
 * ğŸ“Š ä¸­å¿ƒæ‰©å±•æ³•å›¾è§£ï¼š
 *
 * s = "babad"
 *
 * ä»¥æ¯ä¸ªä½ç½®ä¸ºä¸­å¿ƒï¼Œå‘ä¸¤è¾¹æ‰©å±•ï¼š
 *
 *   ä¸­å¿ƒ 0 ('b'):
 *     å¥‡æ•°: "b" â†’ é•¿åº¦ 1
 *     å¶æ•°: "ba" â†’ ä¸æ˜¯å›æ–‡
 *
 *   ä¸­å¿ƒ 1 ('a'):
 *     å¥‡æ•°: "a" â†’ "bab" â†’ é•¿åº¦ 3 âœ“
 *     å¶æ•°: "ab" â†’ ä¸æ˜¯å›æ–‡
 *
 *   ä¸­å¿ƒ 2 ('b'):
 *     å¥‡æ•°: "b" â†’ "aba" â†’ é•¿åº¦ 3 âœ“
 *     å¶æ•°: "ba" â†’ ä¸æ˜¯å›æ–‡
 *
 *   ä¸­å¿ƒ 3 ('a'):
 *     å¥‡æ•°: "a" â†’ é•¿åº¦ 1
 *     å¶æ•°: "ad" â†’ ä¸æ˜¯å›æ–‡
 *
 *   ä¸­å¿ƒ 4 ('d'):
 *     å¥‡æ•°: "d" â†’ é•¿åº¦ 1
 *     å¶æ•°: æ— 
 *
 * æœ€é•¿: "bab" æˆ– "aba"
 *
 * ğŸ”„ æµç¨‹å›¾ (Mermaid):
 * ```mermaid
 * flowchart TD
 *     A[éå†æ¯ä¸ªä½ç½® i] --> B[ä»¥ i ä¸ºä¸­å¿ƒæ‰©å±• å¥‡æ•°é•¿åº¦]
 *     A --> C[ä»¥ i,i+1 ä¸ºä¸­å¿ƒæ‰©å±• å¶æ•°é•¿åº¦]
 *     B --> D[æ›´æ–°æœ€é•¿å›æ–‡]
 *     C --> D
 *     D --> A
 * ```
 */
function longestPalindrome_v1(s: string): string {
  if (s.length < 2) return s;

  let start = 0;
  let maxLen = 1;

  // ä»ä¸­å¿ƒå‘ä¸¤è¾¹æ‰©å±•ï¼Œè¿”å›å›æ–‡ä¸²çš„é•¿åº¦
  function expandAroundCenter(left: number, right: number): number {
    while (left >= 0 && right < s.length && s[left] === s[right]) {
      left--;
      right++;
    }
    // è¿”å›å›æ–‡ä¸²çš„é•¿åº¦
    return right - left - 1;
  }

  for (let i = 0; i < s.length; i++) {
    // å¥‡æ•°é•¿åº¦ï¼šä»¥ i ä¸ºä¸­å¿ƒ
    const len1 = expandAroundCenter(i, i);
    // å¶æ•°é•¿åº¦ï¼šä»¥ i å’Œ i+1 ä¸ºä¸­å¿ƒ
    const len2 = expandAroundCenter(i, i + 1);

    const len = Math.max(len1, len2);

    if (len > maxLen) {
      maxLen = len;
      // è®¡ç®—èµ·å§‹ä½ç½®
      start = i - Math.floor((len - 1) / 2);
    }
  }

  return s.substring(start, start + maxLen);
}

// ============================================================
// è§£æ³•äºŒï¼šåŠ¨æ€è§„åˆ’
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ²) | ç©ºé—´å¤æ‚åº¦ï¼šO(nÂ²)

/**
 * ğŸ“Š åŠ¨æ€è§„åˆ’å›¾è§£ï¼š
 *
 * dp[i][j] = true è¡¨ç¤º s[i..j] æ˜¯å›æ–‡ä¸²
 *
 * çŠ¶æ€è½¬ç§»ï¼š
 * dp[i][j] = (s[i] == s[j]) && dp[i+1][j-1]
 *
 * è¾¹ç•Œæ¡ä»¶ï¼š
 * - dp[i][i] = trueï¼ˆå•ä¸ªå­—ç¬¦æ˜¯å›æ–‡ï¼‰
 * - dp[i][i+1] = (s[i] == s[i+1])ï¼ˆä¸¤ä¸ªå­—ç¬¦ï¼‰
 *
 * éå†é¡ºåºï¼šæŒ‰é•¿åº¦ä»å°åˆ°å¤§
 *
 * s = "babad"
 *
 *     b   a   b   a   d
 * b   T   F   T   F   F
 * a       T   F   T   F
 * b           T   F   F
 * a               T   F
 * d                   T
 */
function longestPalindrome_v2(s: string): string {
  const n = s.length;
  if (n < 2) return s;

  // dp[i][j] è¡¨ç¤º s[i..j] æ˜¯å¦æ˜¯å›æ–‡
  const dp: boolean[][] = Array.from({ length: n }, () =>
    new Array(n).fill(false)
  );

  let start = 0;
  let maxLen = 1;

  // æ‰€æœ‰é•¿åº¦ä¸º 1 çš„å­ä¸²éƒ½æ˜¯å›æ–‡
  for (let i = 0; i < n; i++) {
    dp[i][i] = true;
  }

  // æŒ‰é•¿åº¦ä»å°åˆ°å¤§éå†
  for (let len = 2; len <= n; len++) {
    for (let i = 0; i <= n - len; i++) {
      const j = i + len - 1;

      if (s[i] !== s[j]) {
        dp[i][j] = false;
      } else {
        if (len <= 3) {
          // é•¿åº¦ <= 3 æ—¶ï¼Œåªè¦ä¸¤ç«¯ç›¸ç­‰å°±æ˜¯å›æ–‡
          dp[i][j] = true;
        } else {
          // é•¿åº¦ > 3 æ—¶ï¼Œéœ€è¦æ£€æŸ¥å†…éƒ¨
          dp[i][j] = dp[i + 1][j - 1];
        }
      }

      // æ›´æ–°æœ€é•¿å›æ–‡
      if (dp[i][j] && len > maxLen) {
        start = i;
        maxLen = len;
      }
    }
  }

  return s.substring(start, start + maxLen);
}

// ============================================================
// è§£æ³•ä¸‰ï¼šæš´åŠ›æšä¸¾ï¼ˆä¸æ¨èï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ³) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)
function longestPalindrome_v3(s: string): string {
  const n = s.length;
  if (n < 2) return s;

  // åˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡
  function isPalindrome(str: string): boolean {
    let left = 0;
    let right = str.length - 1;
    while (left < right) {
      if (str[left] !== str[right]) return false;
      left++;
      right--;
    }
    return true;
  }

  let result = s[0];

  // æšä¸¾æ‰€æœ‰å­ä¸²
  for (let i = 0; i < n; i++) {
    for (let j = i + 1; j <= n; j++) {
      const sub = s.substring(i, j);
      if (sub.length > result.length && isPalindrome(sub)) {
        result = sub;
      }
    }
  }

  return result;
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•       | æ—¶é—´   | ç©ºé—´   | ç‰¹ç‚¹                     |
 * |-----------|--------|--------|-------------------------|
 * | ä¸­å¿ƒæ‰©å±•   | O(nÂ²)  | O(1)   | æ¨èï¼Œç©ºé—´æœ€ä¼˜            |
 * | åŠ¨æ€è§„åˆ’   | O(nÂ²)  | O(nÂ²)  | ç»å…¸ DPï¼Œä¾¿äºç†è§£         |
 * | æš´åŠ›      | O(nÂ³)  | O(1)   | ç®€å•ä½†å¤ªæ…¢               |
 * | Manacher  | O(n)   | O(n)   | æœ€ä¼˜ï¼Œä½†å®ç°å¤æ‚          |
 *
 * é¢è¯•æ¨èï¼šä¸­å¿ƒæ‰©å±•æ³•
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. ä¸­å¿ƒæ‰©å±•è¦è€ƒè™‘ä¸¤ç§æƒ…å†µï¼š
 *    - å¥‡æ•°é•¿åº¦ï¼šä»¥å•ä¸ªå­—ç¬¦ä¸ºä¸­å¿ƒ
 *    - å¶æ•°é•¿åº¦ï¼šä»¥ä¸¤ä¸ªå­—ç¬¦ä¸ºä¸­å¿ƒ
 *
 * 2. è®¡ç®—èµ·å§‹ä½ç½®ï¼š
 *    - start = i - (len - 1) / 2
 *    - æ³¨æ„æ•´æ•°é™¤æ³•
 *
 * 3. åŠ¨æ€è§„åˆ’çš„éå†é¡ºåºï¼š
 *    - å¿…é¡»æŒ‰é•¿åº¦ä»å°åˆ°å¤§éå†
 *    - å› ä¸º dp[i][j] ä¾èµ– dp[i+1][j-1]
 *
 * 4. è¾¹ç•Œæ¡ä»¶ï¼š
 *    - ç©ºå­—ç¬¦ä¸²è¿”å› ""
 *    - å•å­—ç¬¦è¿”å›è‡ªèº«
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - éªŒè¯å›æ–‡ä¸² â†’ åŒæŒ‡é’ˆ
 * - å›æ–‡å­ä¸²çš„æ•°é‡ â†’ ä¸­å¿ƒæ‰©å±•
 * - æœ€é•¿å›æ–‡å­åºåˆ— â†’ åŠ¨æ€è§„åˆ’
 * - åˆ†å‰²å›æ–‡ä¸² â†’ å›æº¯ + åŠ¨æ€è§„åˆ’
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. æ–‡æœ¬åˆ†æï¼šæ‰¾å‡ºæ–‡æœ¬ä¸­çš„å›æ–‡ç»“æ„
 * 2. æ•°æ®éªŒè¯ï¼šæ£€æµ‹ç‰¹æ®Šæ ¼å¼çš„æ•°æ®
 * 3. æ¸¸æˆè®¾è®¡ï¼šå›æ–‡ç›¸å…³çš„æ–‡å­—æ¸¸æˆ
 * 4. ç¼–ç æ£€æµ‹ï¼šæŸäº›ç¼–ç æ ¼å¼å¯èƒ½åŒ…å«å›æ–‡ç»“æ„
 */

// å¯¼å‡ºä¸»è§£æ³•
export { longestPalindrome_v1, longestPalindrome_v2, longestPalindrome_v3 };
export default longestPalindrome_v1;

