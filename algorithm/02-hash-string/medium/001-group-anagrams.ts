/**
 * ğŸ“ é¢˜ç›®ï¼šå­—æ¯å¼‚ä½è¯åˆ†ç»„
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/group-anagrams/
 * ğŸ·ï¸ éš¾åº¦ï¼šMedium
 * ğŸ·ï¸ æ ‡ç­¾ï¼šæ•°ç»„ã€å“ˆå¸Œè¡¨ã€å­—ç¬¦ä¸²ã€æ’åº
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œè¯·ä½ å°† å­—æ¯å¼‚ä½è¯ ç»„åˆåœ¨ä¸€èµ·ã€‚
 * å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç»“æœåˆ—è¡¨ã€‚
 *
 * å­—æ¯å¼‚ä½è¯æ˜¯ç”±é‡æ–°æ’åˆ—æºå•è¯çš„æ‰€æœ‰å­—æ¯å¾—åˆ°çš„ä¸€ä¸ªæ–°å•è¯ã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šstrs = ["eat","tea","tan","ate","nat","bat"]
 * è¾“å‡ºï¼š[["bat"],["nat","tan"],["ate","eat","tea"]]
 */

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// å…³é”®é—®é¢˜ï¼šå¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªè¯æ˜¯å¼‚ä½è¯ï¼Ÿ
// - æ’åºåç›¸åŒ
// - å­—ç¬¦è®¡æ•°ç›¸åŒ
//
// æ ¸å¿ƒæ€è·¯ï¼šç”¨æ’åºåçš„å­—ç¬¦ä¸²ä½œä¸º keyï¼ŒæŠŠå¼‚ä½è¯åˆ†åˆ°åŒä¸€ç»„
//
// 1. æ’åºæ³•ï¼š
//    - key = å­—ç¬¦ä¸²æ’åºåçš„ç»“æœ
//    - "eat" â†’ "aet"
//    - "tea" â†’ "aet"
//    - åŒä¸€ä¸ª key çš„æ”¾ä¸€ç»„
//
// 2. è®¡æ•°æ³•ï¼š
//    - key = å­—ç¬¦è®¡æ•°çš„è¡¨ç¤º
//    - "eat" â†’ "a1e1t1"
//    - "tea" â†’ "a1e1t1"

// ============================================================
// è§£æ³•ä¸€ï¼šæ’åºæ³•ï¼ˆæ¨èï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n Ã— k log k)ï¼Œn æ˜¯å­—ç¬¦ä¸²æ•°é‡ï¼Œk æ˜¯æœ€é•¿å­—ç¬¦ä¸²é•¿åº¦
// ç©ºé—´å¤æ‚åº¦ï¼šO(n Ã— k)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * strs = ["eat", "tea", "tan", "ate", "nat", "bat"]
 *
 * Step 1: å¯¹æ¯ä¸ªå­—ç¬¦ä¸²æ’åºï¼Œä½œä¸º key
 *
 *   "eat" â†’ "aet"
 *   "tea" â†’ "aet"
 *   "tan" â†’ "ant"
 *   "ate" â†’ "aet"
 *   "nat" â†’ "ant"
 *   "bat" â†’ "abt"
 *
 * Step 2: æŒ‰ key åˆ†ç»„
 *
 *   map = {
 *     "aet": ["eat", "tea", "ate"],
 *     "ant": ["tan", "nat"],
 *     "abt": ["bat"]
 *   }
 *
 * Step 3: è¿”å›æ‰€æœ‰åˆ†ç»„
 *
 *   [["eat", "tea", "ate"], ["tan", "nat"], ["bat"]]
 */
function groupAnagrams_v1(strs: string[]): string[][] {
  const map = new Map<string, string[]>();

  for (const str of strs) {
    // æ’åºåçš„å­—ç¬¦ä¸²ä½œä¸º key
    const key = str.split('').sort().join('');

    if (!map.has(key)) {
      map.set(key, []);
    }
    map.get(key)!.push(str);
  }

  return Array.from(map.values());
}

// ============================================================
// è§£æ³•äºŒï¼šè®¡æ•°æ³•
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n Ã— k)ï¼Œn æ˜¯å­—ç¬¦ä¸²æ•°é‡ï¼Œk æ˜¯æœ€é•¿å­—ç¬¦ä¸²é•¿åº¦
// ç©ºé—´å¤æ‚åº¦ï¼šO(n Ã— k)
// ğŸ“ ç†è®ºä¸Šæ›´å¿«ï¼Œä½†å®é™…ä¸­å¸¸æ•°å› å­è¾ƒå¤§

/**
 * ğŸ“Š è®¡æ•°æ³•å›¾è§£ï¼š
 *
 * "eat" â†’ [1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0]
 *          a               e                       t
 *
 * è½¬æˆå­—ç¬¦ä¸² key: "1#0#0#0#1#0#...#1#0#..."
 *
 * åŒæ ·å­—ç¬¦çš„è¯ä¼šå¾—åˆ°ç›¸åŒçš„ key
 */
function groupAnagrams_v2(strs: string[]): string[][] {
  const map = new Map<string, string[]>();

  for (const str of strs) {
    // ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦çš„å‡ºç°æ¬¡æ•°
    const count = new Array(26).fill(0);
    const aCode = 'a'.charCodeAt(0);

    for (const char of str) {
      count[char.charCodeAt(0) - aCode]++;
    }

    // ç”¨è®¡æ•°æ•°ç»„ç”Ÿæˆ key
    const key = count.join('#');

    if (!map.has(key)) {
      map.set(key, []);
    }
    map.get(key)!.push(str);
  }

  return Array.from(map.values());
}

// ============================================================
// è§£æ³•ä¸‰ï¼šè´¨æ•°ä¹˜ç§¯æ³•ï¼ˆä¸æ¨èï¼Œå¯èƒ½æº¢å‡ºï¼‰
// ============================================================
// ğŸ“ æ¯ä¸ªå­—æ¯å¯¹åº”ä¸€ä¸ªè´¨æ•°ï¼Œå¼‚ä½è¯çš„è´¨æ•°ä¹˜ç§¯ç›¸åŒ
// âš ï¸ é•¿å­—ç¬¦ä¸²å¯èƒ½å¯¼è‡´æº¢å‡º
function groupAnagrams_v3(strs: string[]): string[][] {
  // 26 ä¸ªè´¨æ•°å¯¹åº” 26 ä¸ªå­—æ¯
  const primes = [
    2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71,
    73, 79, 83, 89, 97, 101,
  ];

  const map = new Map<number, string[]>();
  const aCode = 'a'.charCodeAt(0);

  for (const str of strs) {
    let product = 1;
    for (const char of str) {
      product *= primes[char.charCodeAt(0) - aCode];
    }

    if (!map.has(product)) {
      map.set(product, []);
    }
    map.get(product)!.push(str);
  }

  return Array.from(map.values());
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•         | æ—¶é—´           | ç©ºé—´     | ç‰¹ç‚¹                     |
 * |-------------|----------------|----------|-------------------------|
 * | æ’åºæ³•       | O(n Ã— k log k) | O(n Ã— k) | æ¨èï¼Œç®€å•ç›´è§‚            |
 * | è®¡æ•°æ³•       | O(n Ã— k)       | O(n Ã— k) | ç†è®ºæ›´å¿«ï¼Œå¸¸æ•°å› å­å¤§       |
 * | è´¨æ•°ä¹˜ç§¯æ³•   | O(n Ã— k)       | O(n Ã— k) | å¯èƒ½æº¢å‡ºï¼Œä¸æ¨è          |
 *
 * å®é™…é¢è¯•æ¨èæ’åºæ³•ï¼Œä»£ç ç®€æ´ï¼Œä¸æ˜“å‡ºé”™
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. æ’åºçš„å¯¹è±¡ï¼š
 *    - æ’åºçš„æ˜¯å­—ç¬¦æ•°ç»„ï¼Œä¸æ˜¯å­—ç¬¦ä¸²
 *    - str.split('').sort().join('')
 *
 * 2. Map çš„åˆå§‹åŒ–ï¼š
 *    - è®°å¾—æ£€æŸ¥ key æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„
 *
 * 3. è¿”å›å€¼ï¼š
 *    - Array.from(map.values()) æˆ– [...map.values()]
 *
 * 4. ç©ºå­—ç¬¦ä¸²ï¼š
 *    - "" æ’åºåè¿˜æ˜¯ ""
 *    - å¤šä¸ªç©ºå­—ç¬¦ä¸²ä¼šè¢«åˆ†åˆ°åŒä¸€ç»„
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯ â†’ åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯å¼‚ä½è¯
 * - æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯ â†’ æ»‘åŠ¨çª—å£
 * - å­—ç¬¦ä¸²çš„æ’åˆ— â†’ æ»‘åŠ¨çª—å£
 *
 * å…±åŒæ¨¡å¼ï¼šå­—ç¬¦è®¡æ•° / æ’åºæ¯”è¾ƒ
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. æœç´¢èšåˆï¼šæŠŠæ‹¼å†™ç›¸è¿‘çš„æœç´¢è¯èšåˆ
 * 2. æ ‡ç­¾åˆ†ç»„ï¼šæŠŠç›¸ä¼¼æ ‡ç­¾åˆ†åˆ°ä¸€ç»„
 * 3. æ•°æ®åˆ†ç±»ï¼šæŒ‰æŸç§ç‰¹å¾å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„
 * 4. å•†å“èšåˆï¼šæŠŠåŒæ¬¾ä¸åŒé¢œè‰²çš„å•†å“åˆ†åˆ°ä¸€ç»„
 */

// å¯¼å‡ºä¸»è§£æ³•
export { groupAnagrams_v1, groupAnagrams_v2, groupAnagrams_v3 };
export default groupAnagrams_v1;

