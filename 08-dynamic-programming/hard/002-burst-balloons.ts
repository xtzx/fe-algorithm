/**
 * ğŸ“ é¢˜ç›®ï¼šæˆ³æ°”çƒ
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/burst-balloons/
 * ğŸ·ï¸ éš¾åº¦ï¼šHard
 * ğŸ·ï¸ æ ‡ç­¾ï¼šæ•°ç»„ã€åŠ¨æ€è§„åˆ’
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * æœ‰ n ä¸ªæ°”çƒï¼Œç¼–å·ä¸º 0 åˆ° n-1ï¼Œæ¯ä¸ªæ°”çƒä¸Šéƒ½æ ‡æœ‰ä¸€ä¸ªæ•°å­—ï¼Œè¿™äº›æ•°å­—å­˜åœ¨æ•°ç»„ nums ä¸­ã€‚
 *
 * ç°åœ¨è¦æ±‚ä½ æˆ³ç ´æ‰€æœ‰çš„æ°”çƒã€‚æˆ³ç ´ç¬¬ i ä¸ªæ°”çƒï¼Œä½ å¯ä»¥è·å¾— nums[i-1] * nums[i] * nums[i+1] æšç¡¬å¸ã€‚
 * è¿™é‡Œçš„ i-1 å’Œ i+1 ä»£è¡¨å’Œ i ç›¸é‚»çš„ä¸¤ä¸ªæ°”çƒçš„åºå·ã€‚
 * å¦‚æœ i-1 æˆ– i+1 è¶…å‡ºäº†æ•°ç»„çš„è¾¹ç•Œï¼Œé‚£ä¹ˆå°±å½“å®ƒæ˜¯ä¸€ä¸ªæ•°å­—ä¸º 1 çš„æ°”çƒã€‚
 *
 * æ±‚æ‰€èƒ½è·å¾—ç¡¬å¸çš„æœ€å¤§æ•°é‡ã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šnums = [3,1,5,8]
 * è¾“å‡ºï¼š167
 * è§£é‡Šï¼š
 * nums = [3,1,5,8] --> [3,5,8] --> [3,8] --> [8] --> []
 * coins =  3*1*5   +   3*5*8  +  1*3*8 + 1*8*1 = 167
 */

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// éš¾ç‚¹ï¼šæˆ³ç ´ä¸€ä¸ªæ°”çƒåï¼Œç›¸é‚»å…³ç³»ä¼šå˜åŒ–
//
// é€†å‘æ€ç»´ï¼šä¸è€ƒè™‘"å…ˆæˆ³å“ªä¸ª"ï¼Œè€Œæ˜¯è€ƒè™‘"æœ€åæˆ³å“ªä¸ª"
//
// å¦‚æœæ°”çƒ k æ˜¯åŒºé—´ (i, j) ä¸­æœ€åè¢«æˆ³ç ´çš„ï¼š
// - æˆ³ç ´ k æ—¶ï¼Œi å’Œ j ä»ç„¶å­˜åœ¨
// - è·å¾—ç¡¬å¸ï¼šnums[i] * nums[k] * nums[j]
// - åŠ ä¸Šå·¦è¾¹ (i, k) å’Œå³è¾¹ (k, j) çš„æœ€å¤§æ”¶ç›Š
//
// dp[i][j] = æˆ³ç ´å¼€åŒºé—´ (i, j) å†…æ‰€æœ‰æ°”çƒçš„æœ€å¤§ç¡¬å¸æ•°

// ============================================================
// è§£æ³•ï¼šåŒºé—´ DP
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ³) | ç©ºé—´å¤æ‚åº¦ï¼šO(nÂ²)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * nums = [3, 1, 5, 8]
 * æ·»åŠ è¾¹ç•Œåï¼š[1, 3, 1, 5, 8, 1]
 *              0  1  2  3  4  5
 *
 * dp[i][j] = æˆ³ç ´ (i, j) å¼€åŒºé—´å†…æ°”çƒçš„æœ€å¤§æ”¶ç›Š
 *
 * æšä¸¾åŒºé—´é•¿åº¦ len = 2, 3, 4, 5
 *
 * len = 2: åŒºé—´å†…æ²¡æœ‰æ°”çƒ
 * dp[0][2] = 1*3*1 = 3 ï¼ˆæœ€åæˆ³ 1ï¼‰
 * dp[1][3] = 3*1*5 = 15
 * ...
 *
 * len = 3:
 * dp[0][3]: æœ€åæˆ³ 1 æˆ– 2
 *   æˆ³ 1: dp[0][1] + 1*3*5 + dp[1][3] = 0 + 15 + 15 = 30
 *   æˆ³ 2: dp[0][2] + 1*1*5 + dp[2][3] = 3 + 5 + 5 = 13
 *   dp[0][3] = 30
 *
 * æœ€ç»ˆç­”æ¡ˆï¼šdp[0][5] = 167
 */
function maxCoins(nums: number[]): number {
  const n = nums.length;

  // æ·»åŠ è¾¹ç•Œ 1
  const balls = [1, ...nums, 1];
  const m = balls.length;

  // dp[i][j] = æˆ³ç ´å¼€åŒºé—´ (i, j) å†…æ‰€æœ‰æ°”çƒçš„æœ€å¤§ç¡¬å¸
  const dp: number[][] = Array.from({ length: m }, () => Array(m).fill(0));

  // æšä¸¾åŒºé—´é•¿åº¦
  for (let len = 2; len < m; len++) {
    // æšä¸¾å·¦ç«¯ç‚¹
    for (let i = 0; i < m - len; i++) {
      const j = i + len;
      // æšä¸¾æœ€åæˆ³ç ´çš„æ°”çƒ k
      for (let k = i + 1; k < j; k++) {
        const coins = balls[i] * balls[k] * balls[j];
        dp[i][j] = Math.max(dp[i][j], dp[i][k] + coins + dp[k][j]);
      }
    }
  }

  return dp[0][m - 1];
}

// ============================================================
// è§£æ³•äºŒï¼šè®°å¿†åŒ–é€’å½’
// ============================================================
function maxCoins_memo(nums: number[]): number {
  const balls = [1, ...nums, 1];
  const m = balls.length;
  const memo: number[][] = Array.from({ length: m }, () => Array(m).fill(-1));

  function dfs(i: number, j: number): number {
    // å¼€åŒºé—´å†…æ²¡æœ‰æ°”çƒ
    if (i + 1 >= j) return 0;
    if (memo[i][j] !== -1) return memo[i][j];

    let maxVal = 0;
    // æšä¸¾æœ€åæˆ³ç ´çš„æ°”çƒ
    for (let k = i + 1; k < j; k++) {
      const coins = balls[i] * balls[k] * balls[j];
      const left = dfs(i, k);
      const right = dfs(k, j);
      maxVal = Math.max(maxVal, left + coins + right);
    }

    memo[i][j] = maxVal;
    return maxVal;
  }

  return dfs(0, m - 1);
}

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. è¾¹ç•Œå¤„ç†ï¼š
 *    - æ·»åŠ è™šæ‹Ÿè¾¹ç•Œ [1, ...nums, 1]
 *    - è¿™æ ·è¾¹ç•Œæ°”çƒä¹Ÿæœ‰"é‚»å±…"
 *
 * 2. å¼€åŒºé—´ vs é—­åŒºé—´ï¼š
 *    - ä½¿ç”¨å¼€åŒºé—´ (i, j)ï¼Œä¸åŒ…å« i å’Œ j
 *    - æšä¸¾ k åœ¨ (i, j) èŒƒå›´å†…
 *
 * 3. éå†é¡ºåºï¼š
 *    - æŒ‰åŒºé—´é•¿åº¦ä»å°åˆ°å¤§
 *    - ä¿è¯è®¡ç®— dp[i][j] æ—¶ï¼Œdp[i][k] å’Œ dp[k][j] å·²çŸ¥
 *
 * 4. é€†å‘æ€ç»´ï¼š
 *    - ä¸æ˜¯"å…ˆæˆ³å“ªä¸ª"ï¼Œè€Œæ˜¯"æœ€åæˆ³å“ªä¸ª"
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - çŸ©é˜µé“¾ä¹˜æ³• â†’ ç±»ä¼¼çš„åŒºé—´ DP
 * - åˆå¹¶çŸ³å¤´çš„æœ€ä½æˆæœ¬ â†’ åŒºé—´åˆå¹¶
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. ä»»åŠ¡è°ƒåº¦ï¼šæœ€ä¼˜ä»»åŠ¡æ‰§è¡Œé¡ºåº
 * 2. èµ„æºé‡Šæ”¾ï¼šæœ€ä¼˜é‡Šæ”¾é¡ºåº
 */

export { maxCoins, maxCoins_memo };
export default maxCoins;

