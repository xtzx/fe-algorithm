/**
 * ğŸ“ é¢˜ç›®ï¼šå¯¹ç§°äºŒå‰æ ‘
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/symmetric-tree/
 * ğŸ·ï¸ éš¾åº¦ï¼šEasy
 * ğŸ·ï¸ æ ‡ç­¾ï¼šæ ‘ã€æ·±åº¦ä¼˜å…ˆæœç´¢ã€å¹¿åº¦ä¼˜å…ˆæœç´¢ã€äºŒå‰æ ‘
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ ä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ rootï¼Œæ£€æŸ¥å®ƒæ˜¯å¦è½´å¯¹ç§°ã€‚
 *
 * ç¤ºä¾‹ï¼š
 *       1
 *      / \
 *     2   2
 *    / \ / \
 *   3  4 4  3
 *
 * è¾“å…¥ï¼šroot = [1,2,2,3,4,4,3]
 * è¾“å‡ºï¼štrue
 *
 *       1
 *      / \
 *     2   2
 *      \   \
 *       3   3
 *
 * è¾“å…¥ï¼šroot = [1,2,2,null,3,null,3]
 * è¾“å‡ºï¼šfalse
 */

class TreeNode {
  val: number;
  left: TreeNode | null;
  right: TreeNode | null;
  constructor(val?: number, left?: TreeNode | null, right?: TreeNode | null) {
    this.val = val === undefined ? 0 : val;
    this.left = left === undefined ? null : left;
    this.right = right === undefined ? null : right;
  }
}

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// å¯¹ç§° = å·¦å­æ ‘å’Œå³å­æ ‘äº’ä¸ºé•œåƒ
//
// ä¸¤æ£µæ ‘äº’ä¸ºé•œåƒçš„æ¡ä»¶ï¼š
// 1. æ ¹èŠ‚ç‚¹å€¼ç›¸åŒ
// 2. å·¦çš„å·¦ == å³çš„å³
// 3. å·¦çš„å³ == å³çš„å·¦
//
// è½¬åŒ–ä¸ºï¼šæ¯”è¾ƒä¸¤æ£µæ ‘æ˜¯å¦äº’ä¸ºé•œåƒ

// ============================================================
// è§£æ³•ä¸€ï¼šé€’å½’ï¼ˆæ¨èï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(h)

/**
 * ğŸ“Š é•œåƒæ¯”è¾ƒå›¾è§£ï¼š
 *
 *       1
 *      / \
 *     2   2
 *    / \ / \
 *   3  4 4  3
 *
 *   æ¯”è¾ƒå·¦å­æ ‘å’Œå³å­æ ‘æ˜¯å¦é•œåƒï¼š
 *   - å·¦å­æ ‘çš„æ ¹ (2) == å³å­æ ‘çš„æ ¹ (2) âœ“
 *   - å·¦çš„å·¦ (3) == å³çš„å³ (3) âœ“
 *   - å·¦çš„å³ (4) == å³çš„å·¦ (4) âœ“
 *
 *   é€’å½’åˆ¤æ–­æ‰€æœ‰å¯¹åº”ä½ç½®
 */
function isSymmetric_v1(root: TreeNode | null): boolean {
  if (!root) return true;

  return isMirror(root.left, root.right);
}

function isMirror(left: TreeNode | null, right: TreeNode | null): boolean {
  // éƒ½ä¸ºç©ºï¼Œå¯¹ç§°
  if (!left && !right) return true;

  // ä¸€ä¸ªä¸ºç©ºä¸€ä¸ªä¸ä¸ºç©ºï¼Œä¸å¯¹ç§°
  if (!left || !right) return false;

  // å€¼ä¸ç›¸ç­‰ï¼Œä¸å¯¹ç§°
  if (left.val !== right.val) return false;

  // é€’å½’æ¯”è¾ƒï¼šå·¦çš„å·¦å’Œå³çš„å³ï¼Œå·¦çš„å³å’Œå³çš„å·¦
  return isMirror(left.left, right.right) && isMirror(left.right, right.left);
}

// ============================================================
// è§£æ³•äºŒï¼šè¿­ä»£ï¼ˆBFSï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(n)
function isSymmetric_v2(root: TreeNode | null): boolean {
  if (!root) return true;

  const queue: Array<TreeNode | null> = [root.left, root.right];

  while (queue.length > 0) {
    const left = queue.shift();
    const right = queue.shift();

    // éƒ½ä¸ºç©ºï¼Œç»§ç»­
    if (!left && !right) continue;

    // ä¸€ä¸ªä¸ºç©ºæˆ–å€¼ä¸ç›¸ç­‰ï¼Œä¸å¯¹ç§°
    if (!left || !right || left.val !== right.val) {
      return false;
    }

    // æŒ‰é•œåƒé¡ºåºå…¥é˜Ÿ
    queue.push(left.left, right.right);
    queue.push(left.right, right.left);
  }

  return true;
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•     | æ—¶é—´  | ç©ºé—´  | ç‰¹ç‚¹                     |
 * |---------|-------|-------|-------------------------|
 * | é€’å½’    | O(n)  | O(h)  | æ¨èï¼Œä»£ç ç®€æ´            |
 * | è¿­ä»£    | O(n)  | O(n)  | é¿å…é€’å½’æ ˆæº¢å‡º            |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. é•œåƒæ¯”è¾ƒçš„å¯¹åº”å…³ç³»ï¼š
 *    - å·¦çš„å·¦ å¯¹åº” å³çš„å³
 *    - å·¦çš„å³ å¯¹åº” å³çš„å·¦
 *    - ä¸æ˜¯ å·¦çš„å·¦ å¯¹åº” å³çš„å·¦ï¼
 *
 * 2. ç©ºèŠ‚ç‚¹å¤„ç†ï¼š
 *    - ä¸¤ä¸ªéƒ½ç©ºï¼šå¯¹ç§°
 *    - ä¸€ä¸ªç©ºä¸€ä¸ªä¸ç©ºï¼šä¸å¯¹ç§°
 *
 * 3. è¿­ä»£è§£æ³•çš„å…¥é˜Ÿé¡ºåºï¼š
 *    - è¦æŒ‰é•œåƒå¯¹å…¥é˜Ÿ
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - ç›¸åŒçš„æ ‘ â†’ ç›´æ¥æ¯”è¾ƒï¼Œä¸éœ€è¦é•œåƒ
 * - ç¿»è½¬äºŒå‰æ ‘ â†’ ç”Ÿæˆé•œåƒæ ‘
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. å¸ƒå±€éªŒè¯ï¼šæ£€æŸ¥ UI å¸ƒå±€æ˜¯å¦å¯¹ç§°
 * 2. æ•°æ®ç»“æ„éªŒè¯ï¼šéªŒè¯æ ‘å½¢æ•°æ®æ˜¯å¦ç¬¦åˆå¯¹ç§°è§„åˆ™
 */

export { TreeNode, isSymmetric_v1, isSymmetric_v2 };
export default isSymmetric_v1;

