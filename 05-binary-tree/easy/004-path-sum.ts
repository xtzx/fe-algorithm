/**
 * ğŸ“ é¢˜ç›®ï¼šè·¯å¾„æ€»å’Œ
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/path-sum/
 * ğŸ·ï¸ éš¾åº¦ï¼šEasy
 * ğŸ·ï¸ æ ‡ç­¾ï¼šæ ‘ã€æ·±åº¦ä¼˜å…ˆæœç´¢ã€å¹¿åº¦ä¼˜å…ˆæœç´¢ã€äºŒå‰æ ‘
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™ä½ äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root å’Œä¸€ä¸ªè¡¨ç¤ºç›®æ ‡å’Œçš„æ•´æ•° targetSumã€‚
 * åˆ¤æ–­è¯¥æ ‘ä¸­æ˜¯å¦å­˜åœ¨ æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹ çš„è·¯å¾„ï¼Œè¿™æ¡è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹å€¼ç›¸åŠ ç­‰äºç›®æ ‡å’Œ targetSumã€‚
 *
 * å¶å­èŠ‚ç‚¹ æ˜¯æŒ‡æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚
 *
 * ç¤ºä¾‹ï¼š
 *           5
 *          / \
 *         4   8
 *        /   / \
 *       11  13  4
 *      /  \      \
 *     7    2      1
 *
 * è¾“å…¥ï¼šroot = [5,4,8,11,null,13,4,7,2,null,null,null,1], targetSum = 22
 * è¾“å‡ºï¼štrue
 * è§£é‡Šï¼šè·¯å¾„ 5 â†’ 4 â†’ 11 â†’ 2 çš„å’Œç­‰äº 22
 */

class TreeNode {
  val: number;
  left: TreeNode | null;
  right: TreeNode | null;
  constructor(val?: number, left?: TreeNode | null, right?: TreeNode | null) {
    this.val = val === undefined ? 0 : val;
    this.left = left === undefined ? null : left;
    this.right = right === undefined ? null : right;
  }
}

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// é€’å½’æ€è·¯ï¼š
// - åœ¨å½“å‰èŠ‚ç‚¹ï¼Œé—®é¢˜å˜æˆï¼šå­æ ‘ä¸­æ˜¯å¦å­˜åœ¨è·¯å¾„å’Œç­‰äº targetSum - node.val
// - Base Caseï¼šåˆ°è¾¾å¶å­èŠ‚ç‚¹æ—¶ï¼Œæ£€æŸ¥ targetSum æ˜¯å¦ç­‰äºå¶å­èŠ‚ç‚¹çš„å€¼
//
// å…³é”®ç‚¹ï¼š
// - å¿…é¡»åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œä¸èƒ½åœ¨ä¸­é—´èŠ‚ç‚¹åœæ­¢
// - å¶å­èŠ‚ç‚¹ï¼šæ²¡æœ‰å·¦å³å­èŠ‚ç‚¹

// ============================================================
// è§£æ³•ä¸€ï¼šé€’å½’ï¼ˆæ¨èï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(h)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 *           5         targetSum = 22
 *          / \
 *         4   8       åœ¨ 4 èŠ‚ç‚¹ï¼Œtarget = 22 - 5 = 17
 *        /           åœ¨ 11 èŠ‚ç‚¹ï¼Œtarget = 17 - 4 = 13
 *       11           åœ¨ 2 èŠ‚ç‚¹ï¼ˆå¶å­ï¼‰ï¼Œtarget = 13 - 11 = 2
 *      /  \          2 == 2ï¼Œæ‰¾åˆ°è·¯å¾„ï¼
 *     7    2
 */
function hasPathSum_v1(root: TreeNode | null, targetSum: number): boolean {
  // ç©ºæ ‘æ²¡æœ‰è·¯å¾„
  if (!root) return false;

  // åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œæ£€æŸ¥è·¯å¾„å’Œ
  if (!root.left && !root.right) {
    return root.val === targetSum;
  }

  // é€’å½’æ£€æŸ¥å·¦å³å­æ ‘
  const newTarget = targetSum - root.val;
  return (
    hasPathSum_v1(root.left, newTarget) || hasPathSum_v1(root.right, newTarget)
  );
}

// ============================================================
// è§£æ³•äºŒï¼šè¿­ä»£ï¼ˆDFS ç”¨æ ˆï¼‰
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(h)
function hasPathSum_v2(root: TreeNode | null, targetSum: number): boolean {
  if (!root) return false;

  // æ ˆå­˜å‚¨ [èŠ‚ç‚¹, å½“å‰è·¯å¾„å’Œ]
  const stack: Array<[TreeNode, number]> = [[root, root.val]];

  while (stack.length > 0) {
    const [node, sum] = stack.pop()!;

    // åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œæ£€æŸ¥è·¯å¾„å’Œ
    if (!node.left && !node.right && sum === targetSum) {
      return true;
    }

    // å­èŠ‚ç‚¹å…¥æ ˆ
    if (node.right) {
      stack.push([node.right, sum + node.right.val]);
    }
    if (node.left) {
      stack.push([node.left, sum + node.left.val]);
    }
  }

  return false;
}

// ============================================================
// è§£æ³•ä¸‰ï¼šBFS
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) | ç©ºé—´å¤æ‚åº¦ï¼šO(w)
function hasPathSum_v3(root: TreeNode | null, targetSum: number): boolean {
  if (!root) return false;

  const queue: Array<[TreeNode, number]> = [[root, root.val]];

  while (queue.length > 0) {
    const [node, sum] = queue.shift()!;

    if (!node.left && !node.right && sum === targetSum) {
      return true;
    }

    if (node.left) {
      queue.push([node.left, sum + node.left.val]);
    }
    if (node.right) {
      queue.push([node.right, sum + node.right.val]);
    }
  }

  return false;
}

// ============================================================
// ğŸ”„ è§£æ³•å¯¹æ¯”
// ============================================================
/**
 * | è§£æ³•     | æ—¶é—´  | ç©ºé—´  | ç‰¹ç‚¹                     |
 * |---------|-------|-------|-------------------------|
 * | é€’å½’    | O(n)  | O(h)  | æ¨èï¼Œæœ€ç®€æ´              |
 * | æ ˆè¿­ä»£  | O(n)  | O(h)  | DFS è¿­ä»£ç‰ˆ               |
 * | BFS     | O(n)  | O(w)  | å±‚åºéå†                 |
 */

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. å¿…é¡»åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼š
 *    - ä¸èƒ½åœ¨ä¸­é—´èŠ‚ç‚¹å°±è¿”å› true
 *    - å¶å­èŠ‚ç‚¹ï¼š!node.left && !node.right
 *
 * 2. ç©ºæ ‘å¤„ç†ï¼š
 *    - ç©ºæ ‘è¿”å› falseï¼Œä¸æ˜¯ targetSum === 0
 *
 * 3. é€’å½’çš„ target æ›´æ–°ï¼š
 *    - ä¼ é€’ targetSum - node.val
 *    - åœ¨å¶å­èŠ‚ç‚¹æ¯”è¾ƒ node.val === targetSum
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - è·¯å¾„æ€»å’Œ II â†’ æ‰¾å‡ºæ‰€æœ‰è·¯å¾„
 * - è·¯å¾„æ€»å’Œ III â†’ ä¸å¿…ä»æ ¹å¼€å§‹
 * - äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„ â†’ è¾“å‡ºè·¯å¾„å­—ç¬¦ä¸²
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. æƒé™éªŒè¯ï¼šæ£€æŸ¥ä»æ ¹åˆ°å¶å­çš„æƒé™è·¯å¾„
 * 2. ä»·æ ¼è®¡ç®—ï¼šæ£€æŸ¥å•†å“åˆ†ç±»è·¯å¾„çš„æ€»ä»·
 * 3. è·¯ç”±åŒ¹é…ï¼šæ£€æŸ¥åµŒå¥—è·¯ç”±çš„è·¯å¾„
 */

export { TreeNode, hasPathSum_v1, hasPathSum_v2, hasPathSum_v3 };
export default hasPathSum_v1;

