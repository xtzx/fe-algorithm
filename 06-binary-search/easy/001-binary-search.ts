/**
 * ğŸ“ é¢˜ç›®ï¼šäºŒåˆ†æŸ¥æ‰¾
 * ğŸ”— é“¾æ¥ï¼šhttps://leetcode.cn/problems/binary-search/
 * ğŸ·ï¸ éš¾åº¦ï¼šEasy
 * ğŸ·ï¸ æ ‡ç­¾ï¼šæ•°ç»„ã€äºŒåˆ†æŸ¥æ‰¾
 *
 * ğŸ“‹ é¢˜ç›®æè¿°ï¼š
 * ç»™å®šä¸€ä¸ª n ä¸ªå…ƒç´ æœ‰åºçš„ï¼ˆå‡åºï¼‰æ•´å‹æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œ
 * å†™ä¸€ä¸ªå‡½æ•°æœç´¢ nums ä¸­çš„ targetï¼Œå¦‚æœç›®æ ‡å€¼å­˜åœ¨è¿”å›ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å› -1ã€‚
 *
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥: nums = [-1,0,3,5,9,12], target = 9
 * è¾“å‡º: 4
 * è§£é‡Š: 9 å‡ºç°åœ¨ nums ä¸­å¹¶ä¸”ä¸‹æ ‡ä¸º 4
 *
 * è¾“å…¥: nums = [-1,0,3,5,9,12], target = 2
 * è¾“å‡º: -1
 * è§£é‡Š: 2 ä¸å­˜åœ¨ nums ä¸­å› æ­¤è¿”å› -1
 */

// ============================================================
// ğŸ’¡ æ€è·¯åˆ†æï¼šè¿™é“é¢˜çš„è§£æ³•æ˜¯æ€ä¹ˆæƒ³å‡ºæ¥çš„ï¼Ÿ
// ============================================================
//
// äºŒåˆ†æŸ¥æ‰¾çš„æœ€åŸºç¡€é¢˜ï¼
//
// å› ä¸ºæ•°ç»„æœ‰åºï¼Œæ¯æ¬¡å¯ä»¥æ’é™¤ä¸€åŠçš„æœç´¢ç©ºé—´ï¼š
// - å¦‚æœ nums[mid] < targetï¼Œè¯´æ˜ target åœ¨å³åŠè¾¹
// - å¦‚æœ nums[mid] > targetï¼Œè¯´æ˜ target åœ¨å·¦åŠè¾¹
// - å¦‚æœ nums[mid] == targetï¼Œæ‰¾åˆ°äº†ï¼

// ============================================================
// è§£æ³•ï¼šæ ‡å‡†äºŒåˆ†æŸ¥æ‰¾
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(log n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)

/**
 * ğŸ“Š æ‰§è¡Œè¿‡ç¨‹å›¾è§£ï¼š
 *
 * nums = [-1, 0, 3, 5, 9, 12], target = 9
 *          0  1  2  3  4   5
 *
 * åˆå§‹: left=0, right=5
 *
 * Step 1: mid = (0+5)/2 = 2
 *         nums[2] = 3 < 9
 *         target åœ¨å³è¾¹ï¼Œleft = 3
 *
 * Step 2: mid = (3+5)/2 = 4
 *         nums[4] = 9 == 9
 *         æ‰¾åˆ°ï¼è¿”å› 4
 *
 * ğŸ”„ æµç¨‹å›¾ (Mermaid):
 * ```mermaid
 * flowchart TD
 *     A[left=0, right=n-1] --> B{left <= right?}
 *     B -->|Yes| C[mid = left+right /2]
 *     C --> D{nums mid == target?}
 *     D -->|Yes| E[è¿”å› mid]
 *     D -->|No| F{nums mid < target?}
 *     F -->|Yes| G[left = mid + 1]
 *     F -->|No| H[right = mid - 1]
 *     G --> B
 *     H --> B
 *     B -->|No| I[è¿”å› -1]
 * ```
 */
function search(nums: number[], target: number): number {
  let left = 0;
  let right = nums.length - 1;

  while (left <= right) {
    // é˜²æ­¢ left + right æº¢å‡º
    const mid = left + Math.floor((right - left) / 2);

    if (nums[mid] === target) {
      return mid; // æ‰¾åˆ°ç›®æ ‡å€¼
    } else if (nums[mid] < target) {
      left = mid + 1; // ç›®æ ‡åœ¨å³åŠéƒ¨åˆ†
    } else {
      right = mid - 1; // ç›®æ ‡åœ¨å·¦åŠéƒ¨åˆ†
    }
  }

  return -1; // æœªæ‰¾åˆ°
}

// ============================================================
// è§£æ³•äºŒï¼šä½¿ç”¨ä½è¿ç®—
// ============================================================
// â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(log n) | ç©ºé—´å¤æ‚åº¦ï¼šO(1)
function search_v2(nums: number[], target: number): number {
  let left = 0;
  let right = nums.length - 1;

  while (left <= right) {
    // ä½è¿ç®—å³ç§» 1 ä½ç›¸å½“äºé™¤ä»¥ 2ï¼Œæ¯” Math.floor æ›´å¿«
    const mid = left + ((right - left) >> 1);

    if (nums[mid] === target) {
      return mid;
    } else if (nums[mid] < target) {
      left = mid + 1;
    } else {
      right = mid - 1;
    }
  }

  return -1;
}

// ============================================================
// âš ï¸ æ˜“é”™ç‚¹
// ============================================================
/**
 * 1. mid è®¡ç®—æ–¹å¼ï¼š
 *    - ç”¨ left + (right - left) / 2
 *    - ä¸ç”¨ (left + right) / 2ï¼Œä¼šæº¢å‡º
 *
 * 2. å¾ªç¯æ¡ä»¶ï¼š
 *    - left <= rightï¼Œä¸æ˜¯ left < right
 *    - å› ä¸ºå½“ left == right æ—¶ï¼Œè¿˜æœ‰ä¸€ä¸ªå…ƒç´ æ²¡æ£€æŸ¥
 *
 * 3. è¾¹ç•Œæ›´æ–°ï¼š
 *    - left = mid + 1ï¼Œä¸æ˜¯ left = mid
 *    - right = mid - 1ï¼Œä¸æ˜¯ right = mid
 *    - å› ä¸º mid å·²ç»æ£€æŸ¥è¿‡äº†ï¼Œä¸éœ€è¦å†æ£€æŸ¥
 */

// ============================================================
// ğŸ”— ä¸¾ä¸€åä¸‰ï¼šç›¸ä¼¼é¢˜ç›®
// ============================================================
/**
 * - æœç´¢æ’å…¥ä½ç½® â†’ æ‰¾ç¬¬ä¸€ä¸ª >= target çš„ä½ç½®
 * - åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½® â†’ è¾¹ç•ŒäºŒåˆ†
 * - x çš„å¹³æ–¹æ ¹ â†’ ç­”æ¡ˆäºŒåˆ†
 */

// ============================================================
// ğŸ¢ å‰ç«¯ä¸šåŠ¡åœºæ™¯
// ============================================================
/**
 * 1. æœç´¢å»ºè®®ï¼šåœ¨æœ‰åºè¯åº“ä¸­å¿«é€Ÿå®šä½
 * 2. å›¾è¡¨äº¤äº’ï¼šæ‰¾æœ€è¿‘çš„æ•°æ®ç‚¹
 * 3. ç¼“å­˜æŸ¥æ‰¾ï¼šåœ¨æœ‰åºç¼“å­˜ä¸­å¿«é€Ÿå®šä½
 */

export { search, search_v2 };
export default search;

