# ğŸš€ 10 - é¡¹ç›®å®æˆ˜

> åŠ¨æ‰‹å®è·µï¼Œå·©å›ºæ‰€å­¦çŸ¥è¯†

---

## é¡¹ç›®åˆ—è¡¨

| é¡¹ç›® | éš¾åº¦ | æ¶‰åŠçŸ¥è¯† |
|------|------|---------|
| [é¡¹ç›® 0ï¼šHello Python](#é¡¹ç›®-0hello-python) | â­ | Python åŸºç¡€ |
| [é¡¹ç›® Aï¼šCSV æ•°æ®åˆ†æä¸å¯è§†åŒ–](#é¡¹ç›®-a-csv-æ•°æ®åˆ†æä¸å¯è§†åŒ–) | â­â­â­ | Pandas, Matplotlib |
| [é¡¹ç›® Bï¼šå‘é‡ç›¸ä¼¼åº¦æœç´¢](#é¡¹ç›®-b-å‘é‡ç›¸ä¼¼åº¦æœç´¢) | â­â­â­ | NumPy, æ•°å­¦ |

> ğŸ’¡ å»ºè®®æŒ‰é¡ºåºå®Œæˆï¼Œä»ç®€å•åˆ°å¤æ‚

---

## é¡¹ç›® 0ï¼šHello Python

### é¡¹ç›®ç›®æ ‡

ç”¨ Python å®ç°ä¸€ä¸ªç®€å•çš„æˆç»©ç»Ÿè®¡å·¥å…·ï¼Œå·©å›ºåŸºç¡€è¯­æ³•ã€‚

### å®Œæ•´ä»£ç 

```python
"""
é¡¹ç›® 0ï¼šæˆç»©ç»Ÿè®¡å·¥å…·
ç›®æ ‡ï¼šç†Ÿæ‚‰ Python åŸºç¡€è¯­æ³•ï¼ˆå˜é‡ã€åˆ—è¡¨ã€å­—å…¸ã€å‡½æ•°ã€å¾ªç¯ï¼‰
"""

print("=" * 50)
print("ğŸ“Š å­¦ç”Ÿæˆç»©ç»Ÿè®¡å·¥å…·")
print("=" * 50)

# ========== 1. æ•°æ®å‡†å¤‡ ==========
print("\n1. å‡†å¤‡å­¦ç”Ÿæˆç»©æ•°æ®")
print("-" * 30)

# å­¦ç”Ÿæˆç»©æ•°æ®ï¼ˆå­—å…¸åˆ—è¡¨ï¼‰
students = [
    {"name": "å°æ˜", "math": 85, "english": 78, "python": 92},
    {"name": "å°çº¢", "math": 92, "english": 88, "python": 85},
    {"name": "å°å", "math": 76, "english": 82, "python": 88},
    {"name": "å°æ", "math": 88, "english": 95, "python": 79},
    {"name": "å°å¼ ", "math": 95, "english": 72, "python": 96},
]

print(f"å…±æœ‰ {len(students)} åå­¦ç”Ÿ")
for s in students:
    print(f"  {s['name']}: æ•°å­¦={s['math']}, è‹±è¯­={s['english']}, Python={s['python']}")

# ========== 2. è®¡ç®—æ¯ä¸ªå­¦ç”Ÿçš„æ€»åˆ†å’Œå¹³å‡åˆ† ==========
print("\n2. è®¡ç®—æ€»åˆ†å’Œå¹³å‡åˆ†")
print("-" * 30)

def calculate_total_and_avg(student):
    """è®¡ç®—å­¦ç”Ÿçš„æ€»åˆ†å’Œå¹³å‡åˆ†"""
    total = student["math"] + student["english"] + student["python"]
    avg = total / 3
    return total, avg

# ç»™æ¯ä¸ªå­¦ç”Ÿæ·»åŠ æ€»åˆ†å’Œå¹³å‡åˆ†
for s in students:
    total, avg = calculate_total_and_avg(s)
    s["total"] = total
    s["avg"] = round(avg, 2)  # ä¿ç•™ä¸¤ä½å°æ•°

print("å­¦ç”Ÿæˆç»©æ±‡æ€»ï¼š")
print(f"{'å§“å':<6} {'æ•°å­¦':<6} {'è‹±è¯­':<6} {'Python':<8} {'æ€»åˆ†':<6} {'å¹³å‡':<6}")
print("-" * 44)
for s in students:
    print(f"{s['name']:<6} {s['math']:<6} {s['english']:<6} {s['python']:<8} {s['total']:<6} {s['avg']:<6}")

# ========== 3. æ‰¾å‡ºæœ€é«˜åˆ†å’Œæœ€ä½åˆ† ==========
print("\n3. æˆç»©æ’å")
print("-" * 30)

# æŒ‰æ€»åˆ†æ’åºï¼ˆä»é«˜åˆ°ä½ï¼‰
sorted_students = sorted(students, key=lambda x: x["total"], reverse=True)

print("æŒ‰æ€»åˆ†æ’åï¼š")
for rank, s in enumerate(sorted_students, 1):
    print(f"  ç¬¬ {rank} å: {s['name']} - æ€»åˆ† {s['total']}")

# æ‰¾å‡ºå„ç§‘æœ€é«˜åˆ†
print("\nå„ç§‘æœ€é«˜åˆ†ï¼š")
subjects = ["math", "english", "python"]
subject_names = {"math": "æ•°å­¦", "english": "è‹±è¯­", "python": "Python"}

for subject in subjects:
    top_student = max(students, key=lambda x: x[subject])
    print(f"  {subject_names[subject]}: {top_student['name']} ({top_student[subject]}åˆ†)")

# ========== 4. ç»Ÿè®¡åˆ†æ ==========
print("\n4. ç»Ÿè®¡åˆ†æ")
print("-" * 30)

# è®¡ç®—ç­çº§å„ç§‘å¹³å‡åˆ†
def class_average(subject):
    """è®¡ç®—æŸç§‘ç›®çš„ç­çº§å¹³å‡åˆ†"""
    total = sum(s[subject] for s in students)
    return round(total / len(students), 2)

print("ç­çº§å„ç§‘å¹³å‡åˆ†ï¼š")
for subject in subjects:
    avg = class_average(subject)
    print(f"  {subject_names[subject]}: {avg}")

# è®¡ç®—åŠæ ¼ç‡ï¼ˆ60åˆ†åŠæ ¼ï¼‰
def pass_rate(subject, pass_score=60):
    """è®¡ç®—åŠæ ¼ç‡"""
    passed = sum(1 for s in students if s[subject] >= pass_score)
    return round(passed / len(students) * 100, 1)

print("\nå„ç§‘åŠæ ¼ç‡ï¼ˆ60åˆ†åŠæ ¼ï¼‰ï¼š")
for subject in subjects:
    rate = pass_rate(subject)
    print(f"  {subject_names[subject]}: {rate}%")

# ========== 5. æˆç»©ç­‰çº§åˆ’åˆ† ==========
print("\n5. æˆç»©ç­‰çº§åˆ’åˆ†")
print("-" * 30)

def get_grade(score):
    """æ ¹æ®åˆ†æ•°è¿”å›ç­‰çº§"""
    if score >= 90:
        return "A (ä¼˜ç§€)"
    elif score >= 80:
        return "B (è‰¯å¥½)"
    elif score >= 70:
        return "C (ä¸­ç­‰)"
    elif score >= 60:
        return "D (åŠæ ¼)"
    else:
        return "F (ä¸åŠæ ¼)"

print("å„å­¦ç”Ÿç»¼åˆè¯„çº§ï¼ˆæŒ‰å¹³å‡åˆ†ï¼‰ï¼š")
for s in students:
    grade = get_grade(s["avg"])
    print(f"  {s['name']}: {grade}")

# ========== 6. ç®€å•å¯è§†åŒ–ï¼ˆASCIIï¼‰ ==========
print("\n6. æˆç»©å¯è§†åŒ–")
print("-" * 30)

def draw_bar(value, max_value=100, width=20):
    """ç»˜åˆ¶ ASCII è¿›åº¦æ¡"""
    filled = int(value / max_value * width)
    bar = "â–ˆ" * filled + "â–‘" * (width - filled)
    return bar

print("å„å­¦ç”Ÿæ€»åˆ†å¯è§†åŒ–ï¼ˆæ»¡åˆ†300ï¼‰ï¼š")
max_total = 300
for s in students:
    bar = draw_bar(s["total"], max_total, 25)
    print(f"  {s['name']}: {bar} {s['total']}")

print("\n" + "=" * 50)
print("âœ… é¡¹ç›® 0 å®Œæˆï¼")
print("=" * 50)

print("""
ä½ å­¦ä¼šäº†ï¼š
- åˆ—è¡¨å’Œå­—å…¸çš„ä½¿ç”¨
- å‡½æ•°å®šä¹‰å’Œè°ƒç”¨
- å¾ªç¯éå†æ•°æ®
- æ’åºå’Œç­›é€‰
- ç®€å•çš„æ•°æ®ç»Ÿè®¡
""")
```

### è¿è¡Œç»“æœ

```
==================================================
ğŸ“Š å­¦ç”Ÿæˆç»©ç»Ÿè®¡å·¥å…·
==================================================

1. å‡†å¤‡å­¦ç”Ÿæˆç»©æ•°æ®
------------------------------
å…±æœ‰ 5 åå­¦ç”Ÿ
  å°æ˜: æ•°å­¦=85, è‹±è¯­=78, Python=92
  ...

2. è®¡ç®—æ€»åˆ†å’Œå¹³å‡åˆ†
------------------------------
å§“å   æ•°å­¦   è‹±è¯­   Python   æ€»åˆ†   å¹³å‡
--------------------------------------------
å°æ˜   85     78     92       255    85.0
...
```

### å­¦åˆ°çš„æŠ€èƒ½

- âœ… åˆ—è¡¨å’Œå­—å…¸çš„ä½¿ç”¨
- âœ… å‡½æ•°å®šä¹‰å’Œè°ƒç”¨
- âœ… å¾ªç¯éå†å’Œæ¡ä»¶åˆ¤æ–­
- âœ… æ’åºï¼ˆsorted + lambdaï¼‰
- âœ… ç®€å•çš„æ•°æ®ç»Ÿè®¡

---

## é¡¹ç›® Aï¼šCSV æ•°æ®åˆ†æä¸å¯è§†åŒ–

### é¡¹ç›®ç›®æ ‡

ç”¨ Pandas åˆ†æä¸€ä¸ªæ•°æ®é›†ï¼Œè¿›è¡Œæ•°æ®æ¸…æ´—ã€ç»Ÿè®¡åˆ†æå’Œå¯è§†åŒ–ã€‚

### å®Œæ•´ä»£ç 

```python
"""
é¡¹ç›® Aï¼šæ•°æ®åˆ†æä¸å¯è§†åŒ–
ç›®æ ‡ï¼šåˆ†æé”€å”®æ•°æ®ï¼Œå‘ç°ä¸šåŠ¡æ´å¯Ÿ
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# è®¾ç½®æ˜¾ç¤º
pd.set_option('display.max_columns', None)
plt.rcParams['figure.figsize'] = (10, 6)
plt.rcParams['font.size'] = 12

print("=" * 60)
print("1. åˆ›å»ºæ¨¡æ‹Ÿæ•°æ®")
print("=" * 60)

# ç”Ÿæˆæ¨¡æ‹Ÿé”€å”®æ•°æ®
np.random.seed(42)
n_records = 500

# ç”Ÿæˆæ•°æ®
dates = pd.date_range('2023-01-01', periods=365, freq='D')
data = {
    'date': np.random.choice(dates, n_records),
    'product': np.random.choice(['äº§å“A', 'äº§å“B', 'äº§å“C', 'äº§å“D'], n_records),
    'category': np.random.choice(['ç”µå­', 'æœè£…', 'é£Ÿå“'], n_records),
    'region': np.random.choice(['åä¸œ', 'åå—', 'ååŒ—', 'è¥¿éƒ¨'], n_records),
    'sales': np.random.randint(100, 10000, n_records),
    'quantity': np.random.randint(1, 100, n_records),
    'discount': np.random.uniform(0, 0.3, n_records)
}

df = pd.DataFrame(data)

# æ·»åŠ ä¸€äº›ç¼ºå¤±å€¼
df.loc[np.random.choice(df.index, 20), 'sales'] = np.nan
df.loc[np.random.choice(df.index, 10), 'region'] = np.nan

# æ·»åŠ è®¡ç®—åˆ—
df['revenue'] = df['sales'] * df['quantity'] * (1 - df['discount'])
df['month'] = df['date'].dt.month
df['weekday'] = df['date'].dt.dayofweek

print(f"æ•°æ®å½¢çŠ¶: {df.shape}")
print(f"\nå‰5è¡Œæ•°æ®:")
print(df.head())

print("\n" + "=" * 60)
print("2. æ•°æ®æ¢ç´¢")
print("=" * 60)

print("\næ•°æ®ä¿¡æ¯:")
print(df.info())

print("\næ•°å€¼åˆ—ç»Ÿè®¡:")
print(df.describe())

print("\nç¼ºå¤±å€¼ç»Ÿè®¡:")
print(df.isnull().sum())

print("\nå„åˆ—å”¯ä¸€å€¼æ•°é‡:")
print(df.nunique())

print("\n" + "=" * 60)
print("3. æ•°æ®æ¸…æ´—")
print("=" * 60)

# å¤„ç†ç¼ºå¤±å€¼
df_clean = df.copy()

# æ•°å€¼åˆ—ç”¨ä¸­ä½æ•°å¡«å……
df_clean['sales'] = df_clean['sales'].fillna(df_clean['sales'].median())

# ç±»åˆ«åˆ—ç”¨ä¼—æ•°å¡«å……
df_clean['region'] = df_clean['region'].fillna(df_clean['region'].mode()[0])

# é‡æ–°è®¡ç®— revenue
df_clean['revenue'] = df_clean['sales'] * df_clean['quantity'] * (1 - df_clean['discount'])

print(f"æ¸…æ´—åç¼ºå¤±å€¼: {df_clean.isnull().sum().sum()}")

print("\n" + "=" * 60)
print("4. æ•°æ®åˆ†æ")
print("=" * 60)

# 4.1 åŸºæœ¬ç»Ÿè®¡
print("\n=== åŸºæœ¬ç»Ÿè®¡ ===")
print(f"æ€»é”€å”®é¢: Â¥{df_clean['revenue'].sum():,.0f}")
print(f"å¹³å‡è®¢å•é‡‘é¢: Â¥{df_clean['revenue'].mean():,.0f}")
print(f"è®¢å•æ•°é‡: {len(df_clean)}")

# 4.2 æŒ‰äº§å“åˆ†æ
print("\n=== æŒ‰äº§å“åˆ†æ ===")
product_stats = df_clean.groupby('product').agg({
    'revenue': ['sum', 'mean', 'count'],
    'quantity': 'sum'
}).round(2)
product_stats.columns = ['æ€»æ”¶å…¥', 'å¹³å‡æ”¶å…¥', 'è®¢å•æ•°', 'æ€»æ•°é‡']
print(product_stats.sort_values('æ€»æ”¶å…¥', ascending=False))

# 4.3 æŒ‰åœ°åŒºåˆ†æ
print("\n=== æŒ‰åœ°åŒºåˆ†æ ===")
region_stats = df_clean.groupby('region').agg({
    'revenue': ['sum', 'mean'],
    'discount': 'mean'
}).round(2)
region_stats.columns = ['æ€»æ”¶å…¥', 'å¹³å‡æ”¶å…¥', 'å¹³å‡æŠ˜æ‰£']
print(region_stats.sort_values('æ€»æ”¶å…¥', ascending=False))

# 4.4 æŒ‰æœˆä»½åˆ†æ
print("\n=== æŒ‰æœˆä»½åˆ†æ ===")
monthly_revenue = df_clean.groupby('month')['revenue'].sum()
print(monthly_revenue)

print("\n" + "=" * 60)
print("5. æ•°æ®å¯è§†åŒ–")
print("=" * 60)

# åˆ›å»ºå›¾è¡¨
fig, axes = plt.subplots(2, 3, figsize=(18, 12))

# 5.1 æŒ‰äº§å“çš„é”€å”®é¢
product_revenue = df_clean.groupby('product')['revenue'].sum().sort_values(ascending=True)
axes[0, 0].barh(product_revenue.index, product_revenue.values, color='steelblue')
axes[0, 0].set_title('æŒ‰äº§å“é”€å”®é¢')
axes[0, 0].set_xlabel('é”€å”®é¢ (Â¥)')

# 5.2 æŒ‰åœ°åŒºçš„é”€å”®é¢é¥¼å›¾
region_revenue = df_clean.groupby('region')['revenue'].sum()
axes[0, 1].pie(region_revenue, labels=region_revenue.index, autopct='%1.1f%%',
               colors=['#ff9999', '#66b3ff', '#99ff99', '#ffcc99'])
axes[0, 1].set_title('æŒ‰åœ°åŒºé”€å”®é¢å æ¯”')

# 5.3 æœˆåº¦é”€å”®è¶‹åŠ¿
monthly_data = df_clean.groupby('month')['revenue'].sum()
axes[0, 2].plot(monthly_data.index, monthly_data.values, 'o-', linewidth=2, markersize=8)
axes[0, 2].set_title('æœˆåº¦é”€å”®è¶‹åŠ¿')
axes[0, 2].set_xlabel('æœˆä»½')
axes[0, 2].set_ylabel('é”€å”®é¢ (Â¥)')
axes[0, 2].set_xticks(range(1, 13))
axes[0, 2].grid(True, alpha=0.3)

# 5.4 é”€å”®é¢åˆ†å¸ƒ
axes[1, 0].hist(df_clean['revenue'], bins=30, edgecolor='black', alpha=0.7)
axes[1, 0].axvline(df_clean['revenue'].mean(), color='red', linestyle='--', label='å‡å€¼')
axes[1, 0].axvline(df_clean['revenue'].median(), color='green', linestyle='--', label='ä¸­ä½æ•°')
axes[1, 0].set_title('é”€å”®é¢åˆ†å¸ƒ')
axes[1, 0].set_xlabel('é”€å”®é¢ (Â¥)')
axes[1, 0].set_ylabel('é¢‘æ¬¡')
axes[1, 0].legend()

# 5.5 æŒ‰ç±»åˆ«å’Œåœ°åŒºçš„çƒ­åŠ›å›¾
pivot = df_clean.pivot_table(values='revenue', index='category', columns='region', aggfunc='sum')
sns.heatmap(pivot, annot=True, fmt=',.0f', cmap='YlOrRd', ax=axes[1, 1])
axes[1, 1].set_title('ç±»åˆ«-åœ°åŒºé”€å”®çƒ­åŠ›å›¾')

# 5.6 æŠ˜æ‰£ä¸é”€å”®é¢çš„å…³ç³»
axes[1, 2].scatter(df_clean['discount'], df_clean['revenue'], alpha=0.5)
axes[1, 2].set_title('æŠ˜æ‰£ä¸é”€å”®é¢å…³ç³»')
axes[1, 2].set_xlabel('æŠ˜æ‰£ç‡')
axes[1, 2].set_ylabel('é”€å”®é¢ (Â¥)')

plt.tight_layout()
plt.savefig('sales_analysis.png', dpi=150, bbox_inches='tight')
plt.show()

print("\n" + "=" * 60)
print("6. ä¸šåŠ¡æ´å¯Ÿ")
print("=" * 60)

# æ‰¾å‡ºè¡¨ç°æœ€å¥½çš„äº§å“
best_product = df_clean.groupby('product')['revenue'].sum().idxmax()
print(f"\næœ€ç•…é”€äº§å“: {best_product}")

# æ‰¾å‡ºè¡¨ç°æœ€å¥½çš„åœ°åŒº
best_region = df_clean.groupby('region')['revenue'].sum().idxmax()
print(f"æœ€ä½³é”€å”®åœ°åŒº: {best_region}")

# æ‰¾å‡ºæœ€ä½³é”€å”®æœˆä»½
best_month = df_clean.groupby('month')['revenue'].sum().idxmax()
print(f"æœ€ä½³é”€å”®æœˆä»½: {best_month}æœˆ")

# æŠ˜æ‰£æ•ˆæœåˆ†æ
high_discount = df_clean[df_clean['discount'] > 0.2]['revenue'].mean()
low_discount = df_clean[df_clean['discount'] <= 0.2]['revenue'].mean()
print(f"\né«˜æŠ˜æ‰£(>20%)å¹³å‡é”€å”®é¢: Â¥{high_discount:,.0f}")
print(f"ä½æŠ˜æ‰£(â‰¤20%)å¹³å‡é”€å”®é¢: Â¥{low_discount:,.0f}")

print("\né¡¹ç›® A å®Œæˆï¼")
```

---

## é¡¹ç›® Bï¼šå‘é‡ç›¸ä¼¼åº¦æœç´¢

### é¡¹ç›®ç›®æ ‡

ç”¨ NumPy å®ç°å‘é‡ç›¸ä¼¼åº¦è®¡ç®—ï¼Œæ¨¡æ‹Ÿç®€å•çš„è¯­ä¹‰æœç´¢ã€‚

### å®Œæ•´ä»£ç 

```python
"""
é¡¹ç›® Bï¼šå‘é‡ç›¸ä¼¼åº¦æœç´¢
ç›®æ ‡ï¼šå®ç°ç®€å•çš„è¯­ä¹‰æœç´¢ç³»ç»Ÿ
"""

import numpy as np
from typing import List, Tuple

print("=" * 60)
print("å‘é‡ç›¸ä¼¼åº¦æœç´¢")
print("=" * 60)

# ========== 1. å®šä¹‰ç›¸ä¼¼åº¦å‡½æ•° ==========
print("\n1. å®ç°ç›¸ä¼¼åº¦è®¡ç®—å‡½æ•°")
print("-" * 40)

def cosine_similarity(v1: np.ndarray, v2: np.ndarray) -> float:
    """è®¡ç®—ä¸¤ä¸ªå‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦"""
    dot_product = np.dot(v1, v2)
    norm1 = np.linalg.norm(v1)
    norm2 = np.linalg.norm(v2)
    return dot_product / (norm1 * norm2)

def euclidean_distance(v1: np.ndarray, v2: np.ndarray) -> float:
    """è®¡ç®—ä¸¤ä¸ªå‘é‡çš„æ¬§å‡ é‡Œå¾—è·ç¦»"""
    return np.linalg.norm(v1 - v2)

# æµ‹è¯•
v1 = np.array([1, 0, 0])
v2 = np.array([0, 1, 0])
v3 = np.array([1, 1, 0])

print(f"v1 = {v1}")
print(f"v2 = {v2}")
print(f"v3 = {v3}")
print(f"\nä½™å¼¦ç›¸ä¼¼åº¦:")
print(f"  v1 å’Œ v2: {cosine_similarity(v1, v2):.4f} (å‚ç›´)")
print(f"  v1 å’Œ v3: {cosine_similarity(v1, v3):.4f} (45åº¦)")
print(f"  v1 å’Œ v1: {cosine_similarity(v1, v1):.4f} (ç›¸åŒ)")

# ========== 2. æ¨¡æ‹Ÿæ–‡æ¡£å‘é‡ ==========
print("\n2. åˆ›å»ºæ–‡æ¡£å‘é‡æ•°æ®åº“")
print("-" * 40)

# æ¨¡æ‹Ÿä¸€ä¸ªç®€å•çš„è¯åµŒå…¥
# å®é™…ä¸­ä¼šä½¿ç”¨ Word2Vec, GloVe æˆ– BERT ç­‰æ¨¡å‹
documents = [
    "Python æ˜¯ä¸€ç§æµè¡Œçš„ç¼–ç¨‹è¯­è¨€",
    "æœºå™¨å­¦ä¹ éœ€è¦å¤§é‡æ•°æ®",
    "æ·±åº¦å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„é‡è¦åˆ†æ”¯",
    "Python å¹¿æ³›ç”¨äºæ•°æ®ç§‘å­¦",
    "ç¥ç»ç½‘ç»œå¯ä»¥å­¦ä¹ å¤æ‚æ¨¡å¼",
    "æ•°æ®åˆ†æéœ€è¦ Python å’Œ pandas",
    "è‡ªç„¶è¯­è¨€å¤„ç†æ˜¯ AI çš„åº”ç”¨é¢†åŸŸ",
    "TensorFlow å’Œ PyTorch æ˜¯æ·±åº¦å­¦ä¹ æ¡†æ¶",
]

# æ¨¡æ‹Ÿæ–‡æ¡£å‘é‡ï¼ˆå®é™…ä¸­åº”è¯¥ç”¨çœŸå®çš„ embedding æ¨¡å‹ï¼‰
np.random.seed(42)
embedding_dim = 128
document_vectors = np.random.randn(len(documents), embedding_dim)

# è®©ç›¸å…³æ–‡æ¡£çš„å‘é‡æ›´æ¥è¿‘ï¼ˆæ¨¡æ‹Ÿï¼‰
# Python ç›¸å…³ï¼š0, 3, 5
# æ·±åº¦å­¦ä¹ ç›¸å…³ï¼š2, 4, 7
# AI ç›¸å…³ï¼š2, 6
document_vectors[3] = document_vectors[0] + np.random.randn(embedding_dim) * 0.3
document_vectors[5] = document_vectors[0] + np.random.randn(embedding_dim) * 0.4
document_vectors[4] = document_vectors[2] + np.random.randn(embedding_dim) * 0.3
document_vectors[7] = document_vectors[2] + np.random.randn(embedding_dim) * 0.4

print(f"æ–‡æ¡£æ•°é‡: {len(documents)}")
print(f"å‘é‡ç»´åº¦: {embedding_dim}")

# ========== 3. å®ç°æœç´¢å‡½æ•° ==========
print("\n3. å®ç°æœç´¢åŠŸèƒ½")
print("-" * 40)

def search(query_vector: np.ndarray,
           document_vectors: np.ndarray,
           documents: List[str],
           top_k: int = 3) -> List[Tuple[int, str, float]]:
    """
    æœç´¢æœ€ç›¸ä¼¼çš„æ–‡æ¡£

    Args:
        query_vector: æŸ¥è¯¢å‘é‡
        document_vectors: æ–‡æ¡£å‘é‡çŸ©é˜µ
        documents: æ–‡æ¡£åˆ—è¡¨
        top_k: è¿”å›å‰ k ä¸ªç»“æœ

    Returns:
        [(ç´¢å¼•, æ–‡æ¡£, ç›¸ä¼¼åº¦), ...]
    """
    similarities = []
    for i, doc_vec in enumerate(document_vectors):
        sim = cosine_similarity(query_vector, doc_vec)
        similarities.append((i, documents[i], sim))

    # æŒ‰ç›¸ä¼¼åº¦é™åºæ’åº
    similarities.sort(key=lambda x: x[2], reverse=True)

    return similarities[:top_k]

# ========== 4. æµ‹è¯•æœç´¢ ==========
print("\n4. æµ‹è¯•æœç´¢")
print("-" * 40)

# æ¨¡æ‹ŸæŸ¥è¯¢ï¼ˆä½¿ç”¨ç¬¬ä¸€ä¸ªæ–‡æ¡£çš„å‘é‡ä½œä¸ºæŸ¥è¯¢ï¼‰
query_idx = 0
query_vector = document_vectors[query_idx]

print(f"æŸ¥è¯¢: '{documents[query_idx]}'")
print(f"\næœç´¢ç»“æœ:")

results = search(query_vector, document_vectors, documents, top_k=5)
for i, (idx, doc, sim) in enumerate(results, 1):
    print(f"  {i}. [{sim:.4f}] {doc}")

# ========== 5. æ‰¹é‡ç›¸ä¼¼åº¦è®¡ç®— ==========
print("\n5. æ–‡æ¡£ç›¸ä¼¼åº¦çŸ©é˜µ")
print("-" * 40)

# è®¡ç®—æ‰€æœ‰æ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼åº¦
def compute_similarity_matrix(vectors: np.ndarray) -> np.ndarray:
    """è®¡ç®—ç›¸ä¼¼åº¦çŸ©é˜µ"""
    n = len(vectors)
    sim_matrix = np.zeros((n, n))
    for i in range(n):
        for j in range(n):
            sim_matrix[i, j] = cosine_similarity(vectors[i], vectors[j])
    return sim_matrix

# æ›´é«˜æ•ˆçš„å®ç°ï¼ˆä½¿ç”¨çŸ©é˜µè¿ç®—ï¼‰
def compute_similarity_matrix_fast(vectors: np.ndarray) -> np.ndarray:
    """ä½¿ç”¨çŸ©é˜µè¿ç®—è®¡ç®—ç›¸ä¼¼åº¦çŸ©é˜µï¼ˆæ›´é«˜æ•ˆï¼‰"""
    # å½’ä¸€åŒ–
    norms = np.linalg.norm(vectors, axis=1, keepdims=True)
    normalized = vectors / norms
    # çŸ©é˜µä¹˜æ³•å¾—åˆ°ç›¸ä¼¼åº¦
    return normalized @ normalized.T

sim_matrix = compute_similarity_matrix_fast(document_vectors)

# å¯è§†åŒ–
import matplotlib.pyplot as plt

plt.figure(figsize=(10, 8))
plt.imshow(sim_matrix, cmap='YlOrRd')
plt.colorbar(label='Cosine Similarity')
plt.xticks(range(len(documents)), [f'Doc {i}' for i in range(len(documents))], rotation=45)
plt.yticks(range(len(documents)), [f'Doc {i}' for i in range(len(documents))])
plt.title('Document Similarity Matrix')
plt.tight_layout()
plt.savefig('similarity_matrix.png', dpi=150)
plt.show()

# æ‰¾å‡ºæœ€ç›¸ä¼¼çš„æ–‡æ¡£å¯¹
print("\næœ€ç›¸ä¼¼çš„æ–‡æ¡£å¯¹:")
n = len(documents)
pairs = []
for i in range(n):
    for j in range(i + 1, n):
        pairs.append((i, j, sim_matrix[i, j]))

pairs.sort(key=lambda x: x[2], reverse=True)
for i, j, sim in pairs[:5]:
    print(f"  [{sim:.4f}] Doc {i} <-> Doc {j}")
    print(f"    - {documents[i]}")
    print(f"    - {documents[j]}")

# ========== 6. æ‰©å±•ï¼šç®€å•çš„æ¨èç³»ç»Ÿ ==========
print("\n6. åŸºäºç›¸ä¼¼åº¦çš„æ¨è")
print("-" * 40)

def recommend(doc_idx: int,
              sim_matrix: np.ndarray,
              documents: List[str],
              top_k: int = 3) -> List[Tuple[int, str, float]]:
    """åŸºäºæ–‡æ¡£ç›¸ä¼¼åº¦æ¨èç›¸å…³æ–‡æ¡£"""
    similarities = sim_matrix[doc_idx]
    indices = np.argsort(similarities)[::-1]  # é™åº

    results = []
    for idx in indices:
        if idx != doc_idx:  # æ’é™¤è‡ªå·±
            results.append((idx, documents[idx], similarities[idx]))
            if len(results) >= top_k:
                break

    return results

# æµ‹è¯•æ¨è
print(f"å¦‚æœä½ é˜…è¯»äº†: '{documents[0]}'")
print(f"ä½ å¯èƒ½ä¹Ÿä¼šå–œæ¬¢:")
recommendations = recommend(0, sim_matrix, documents, top_k=3)
for idx, doc, sim in recommendations:
    print(f"  - [{sim:.4f}] {doc}")

print("\né¡¹ç›® B å®Œæˆï¼")
```

---

## é¡¹ç›®æ€»ç»“

### é¡¹ç›® 0 å­¦åˆ°çš„æŠ€èƒ½

- Python åŸºç¡€è¯­æ³•
- åˆ—è¡¨å’Œå­—å…¸æ“ä½œ
- å‡½æ•°å®šä¹‰å’Œä½¿ç”¨
- ç®€å•çš„æ•°æ®å¤„ç†

### é¡¹ç›® A å­¦åˆ°çš„æŠ€èƒ½

- Pandas æ•°æ®åŠ è½½å’Œæ¸…æ´—
- æ•°æ®èšåˆå’Œç»Ÿè®¡åˆ†æ
- Matplotlib æ•°æ®å¯è§†åŒ–
- ä¸šåŠ¡æ´å¯Ÿæå–

### é¡¹ç›® B å­¦åˆ°çš„æŠ€èƒ½

- NumPy å‘é‡è¿ç®—
- ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—
- ç®€å•çš„æœç´¢ç®—æ³•
- ç›¸ä¼¼åº¦çŸ©é˜µè®¡ç®—

### ä¸‹ä¸€æ­¥å»ºè®®

1. **æ•°æ®åˆ†æ**ï¼šæ‰¾ä¸€ä¸ªçœŸå®çš„æ•°æ®é›†ï¼ˆKaggle ä¸Šæœ‰å¾ˆå¤šï¼‰ï¼Œè¿›è¡Œå®Œæ•´çš„ EDA
2. **å‘é‡æœç´¢**ï¼šä½¿ç”¨çœŸå®çš„è¯åµŒå…¥æ¨¡å‹ï¼ˆå¦‚ Sentence-BERTï¼‰
3. **å°è¯•æ›´å¤š**ï¼šç»“åˆä¸¤ä¸ªé¡¹ç›®ï¼Œæ¯”å¦‚åˆ†æå‘é‡æœç´¢çš„æ•ˆæœ

---

## â¡ï¸ ä¸‹ä¸€æ­¥

å®Œæˆé¡¹ç›®åï¼Œè¿›å…¥ [11-è‡ªæµ‹æ¸…å•.md](./11-è‡ªæµ‹æ¸…å•.md) æ£€éªŒå­¦ä¹ æˆæœï¼

