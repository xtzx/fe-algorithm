#!/usr/bin/env python3
"""
04_set_demo.py - 集合操作演示
"""

# =============================================================================
# 1. 创建集合
# =============================================================================
print("=== 创建集合 ===")

s1 = {1, 2, 3}
s2 = set([1, 2, 2, 3, 3, 3])  # 自动去重
s3 = set("hello")
s4 = {x**2 for x in range(5)}

print(f"字面量: {s1}")
print(f"去重: {s2}")
print(f"字符串: {s3}")
print(f"推导式: {s4}")

# 空集合
empty = set()  # 不是 {}
print(f"空集合: {empty}, 类型: {type(empty)}")
print(f"{{}} 的类型: {type({})}")  # 是 dict！

# =============================================================================
# 2. 基本操作
# =============================================================================
print("\n=== 基本操作 ===")

s = {1, 2, 3}

s.add(4)
print(f"add(4): {s}")

s.update([5, 6])
print(f"update([5, 6]): {s}")

s.remove(6)
print(f"remove(6): {s}")

s.discard(10)  # 不存在也不报错
print(f"discard(10): {s}")

# =============================================================================
# 3. 集合运算
# =============================================================================
print("\n=== 集合运算 ===")

a = {1, 2, 3, 4}
b = {3, 4, 5, 6}

print(f"a = {a}")
print(f"b = {b}")

# 并集
print(f"并集 a | b: {a | b}")
print(f"并集 a.union(b): {a.union(b)}")

# 交集
print(f"交集 a & b: {a & b}")
print(f"交集 a.intersection(b): {a.intersection(b)}")

# 差集
print(f"差集 a - b: {a - b}")
print(f"差集 b - a: {b - a}")

# 对称差集
print(f"对称差集 a ^ b: {a ^ b}")

# =============================================================================
# 4. 集合关系
# =============================================================================
print("\n=== 集合关系 ===")

a = {1, 2}
b = {1, 2, 3, 4}

print(f"a = {a}")
print(f"b = {b}")

print(f"a 是 b 的子集: {a <= b}")
print(f"a 是 b 的真子集: {a < b}")
print(f"b 是 a 的超集: {b >= a}")
print(f"a 和 {{5, 6}} 不相交: {a.isdisjoint({5, 6})}")

# =============================================================================
# 5. frozenset
# =============================================================================
print("\n=== frozenset ===")

fs = frozenset([1, 2, 3])
print(f"frozenset: {fs}")

try:
    fs.add(4)
except AttributeError as e:
    print(f"不能修改: {e}")

# 可以作为字典键
d = {frozenset({1, 2}): "value"}
print(f"作为字典键: {d}")

# 集合运算
fs1 = frozenset([1, 2, 3])
fs2 = frozenset([3, 4, 5])
print(f"frozenset 并集: {fs1 | fs2}")

# =============================================================================
# 6. 实际应用
# =============================================================================
print("\n=== 实际应用 ===")

# 去重
lst = [1, 2, 2, 3, 3, 3, 4]
unique = list(set(lst))
print(f"去重: {unique}")

# 成员检测（比列表快）
valid_ids = {101, 102, 103, 104, 105}
print(f"102 是否有效: {102 in valid_ids}")

# 找共同元素
users_a = {"alice", "bob", "charlie"}
users_b = {"bob", "david", "eve"}
common = users_a & users_b
print(f"共同用户: {common}")

# 找独有元素
only_a = users_a - users_b
print(f"只在 A 中: {only_a}")

print("\n=== 运行完成 ===")

